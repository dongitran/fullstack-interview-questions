<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>C√¢u H·ªèi Ph·ªèng V·∫•n - Senior Fullstack Developer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --gray: #6b7280;
            --light: #f9fafb;
            --white: #ffffff;
            --border: #e5e7eb;
        }

        html {
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: var(--light);
            padding: 0;
            margin: 0;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.95;
        }

        .stats {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
            background: white;
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .stat-item {
            flex: 1;
            min-width: 80px;
            text-align: center;
            padding: 0.75rem 0.5rem;
            background: var(--light);
            border-radius: 8px;
        }

        .stat-number {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            display: block;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
            cursor: pointer;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
            z-index: 100;
            pointer-events: none;
        }

        .fab.visible {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }

        .fab:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .fab:active {
            transform: scale(0.95);
        }

        .btn {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:active {
            background: var(--primary-dark);
            transform: scale(0.98);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 1px solid var(--border);
        }

        .btn-secondary:active {
            background: var(--border);
        }

        .container {
            max-width: 100%;
            padding: 1rem;
        }

        .category {
            margin-bottom: 2rem;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: white;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .category-icon {
            font-size: 1.5rem;
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
            flex: 1;
        }

        .category-count {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .question-card {
            background: white;
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
        }

        .question-header {
            padding: 1rem;
            cursor: pointer;
            -webkit-tap-highlight-color: rgba(99, 102, 241, 0.1);
            user-select: none;
        }

        .question-header:active {
            background: var(--light);
        }

        .question-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .question-number {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .difficulty {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .difficulty-easy {
            background: #d1fae5;
            color: #065f46;
        }

        .difficulty-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .difficulty-hard {
            background: #fee2e2;
            color: #991b1b;
        }

        .question-text {
            font-size: 1rem;
            font-weight: 600;
            color: var(--dark);
            line-height: 1.5;
        }

        .expand-icon {
            float: right;
            font-size: 1.25rem;
            color: var(--gray);
            transition: transform 0.3s;
        }

        .question-card.active .expand-icon {
            transform: rotate(180deg);
        }

        .answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .question-card.active .answer {
            max-height: 10000px;
        }

        .answer-content {
            padding: 1rem;
            border-top: 1px solid var(--border);
            background: var(--light);
            font-size: 0.95rem;
            line-height: 1.7;
        }

        .answer-content h4 {
            color: var(--primary);
            font-size: 1rem;
            margin: 1rem 0 0.5rem 0;
        }

        .answer-content h4:first-child {
            margin-top: 0;
        }

        .answer-content ul {
            margin: 0.5rem 0 1rem 1.5rem;
        }

        .answer-content li {
            margin-bottom: 0.5rem;
        }

        .answer-content p {
            margin: 0.75rem 0;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .tag {
            display: inline-block;
            background: var(--light);
            color: var(--gray);
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.75rem;
            margin: 0.25rem 0.25rem 0.25rem 0;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
            display: block;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table thead {
            background: var(--light);
        }

        table th,
        table td {
            padding: 0.75rem 0.5rem;
            text-align: left;
            border: 1px solid var(--border);
        }

        table th {
            font-weight: 600;
            color: var(--dark);
        }

        .highlight {
            background: #fef3c7;
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-weight: 600;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid var(--warning);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .info-box {
            background: #dbeafe;
            border-left: 4px solid var(--primary);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .footer {
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 2rem;
        }

        .footer p {
            font-size: 0.9rem;
            margin: 0.5rem 0;
            opacity: 0.9;
        }

        @media (min-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .header p {
                font-size: 1.1rem;
            }

            .container {
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }

            .stats {
                gap: 1rem;
                padding: 1.5rem;
            }

            .stat-item {
                min-width: 100px;
                padding: 1rem;
            }

            .stat-number {
                font-size: 1.75rem;
            }

            .stat-label {
                font-size: 0.85rem;
            }

            .fab {
                bottom: 2.5rem;
                right: 2.5rem;
                width: 64px;
                height: 64px;
                font-size: 1.5rem;
            }

            .category-header {
                padding: 1.5rem;
            }

            .category-title {
                font-size: 1.5rem;
            }

            .question-header {
                padding: 1.5rem;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .answer-content {
                padding: 1.5rem;
                font-size: 1rem;
            }

            .code-block {
                font-size: 0.9rem;
            }
        }

        @media print {
            .header {
                position: relative;
            }
            .controls {
                display: none;
            }
            .question-card {
                break-inside: avoid;
            }
            .answer {
                max-height: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìö C√¢u H·ªèi Ph·ªèng V·∫•n</h1>
        <p>Senior Fullstack Developer - Concepts & Trade-offs</p>
    </div>

    <div class="stats">
        <div class="stat-item">
            <span class="stat-number">60</span>
            <div class="stat-label">C√¢u h·ªèi</div>
        </div>
        <div class="stat-item">
            <span class="stat-number">8</span>
            <div class="stat-label">Ch·ªß ƒë·ªÅ</div>
        </div>
    </div>

    <div class="container">
        <!-- Microservices & Architecture -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üèóÔ∏è</span>
                <h2 class="category-title">Microservices & Architecture</h2>
                <span class="category-count">5</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q1</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Sync vs Async communication - khi n√†o d√πng g√¨? Trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Synchronous (REST/gRPC):</h4>
                        <p><strong>Khi n√†o:</strong> Query operations, c·∫ßn response ngay, services trong c√πng datacenter, low latency critical</p>
                        <p><strong>∆Øu ƒëi·ªÉm:</strong> Simple, immediate consistency, d·ªÖ debug</p>
                        <p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong> Tight coupling, cascading failures, latency t√≠ch l≈©y</p>

                        <h4>Asynchronous (Kafka/Queue):</h4>
                        <p><strong>Khi n√†o:</strong> Long-running tasks, fire-and-forget, event workflows, c·∫ßn retry t·ª± ƒë·ªông</p>
                        <p><strong>∆Øu ƒëi·ªÉm:</strong> Loose coupling, resilient, high throughput</p>
                        <p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong> Eventual consistency, debugging ph·ª©c t·∫°p, message ordering, c·∫ßn idempotency</p>

                        <h4>Decision Framework:</h4>
                        <ul>
                            <li><strong>Authentication/Authorization:</strong> Sync - c·∫ßn verify ngay</li>
                            <li><strong>Payment processing:</strong> Async - long-running, c·∫ßn retry</li>
                            <li><strong>Get user profile:</strong> Sync - simple read</li>
                            <li><strong>Send email:</strong> Async - fire-and-forget</li>
                            <li><strong>Real-time inventory:</strong> Sync - c·∫ßn data ch√≠nh x√°c ngay</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Sai l·∫ßm:</strong> D√πng async cho m·ªçi th·ª©. Sync ho√†n to√†n OK cho simple queries trong c√πng DC.
                        </div>

                        <span class="tag">Circuit Breaker</span>
                        <span class="tag">Event-Driven</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q2</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Service Discovery - client-side vs server-side? Implement th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>üéØ V·∫•n ƒë·ªÅ l√† g√¨?</h4>
                        <p>Khi c√≥ nhi·ªÅu service (user-service, payment-service...), m·ªói service ch·∫°y tr√™n nhi·ªÅu instance (3-5 pods). L√†m sao service A bi·∫øt g·ªçi ƒë·∫øn IP n√†o c·ªßa service B?</p>
                        <p>‚Üí C·∫ßn <strong>Service Discovery</strong> nh∆∞ "danh b·∫° ƒëi·ªán tho·∫°i" cho c√°c services.</p>

                        <h4>1Ô∏è‚É£ Client-Side Discovery</h4>
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li>Service t·ª± ƒëƒÉng k√Ω v√†o <strong>Consul/Eureka</strong> khi kh·ªüi ƒë·ªông</li>
                            <li>Client t·ª± query registry ƒë·ªÉ l·∫•y danh s√°ch IP</li>
                            <li>Client t·ª± ch·ªçn 1 IP ƒë·ªÉ g·ªçi (load balancing)</li>
                        </ul>
                        <div class="code-block">Client ‚Üí Query Consul ‚Üí Get IPs [10.0.1.5, 10.0.1.6] 
  ‚Üí Call 10.0.1.5</div>
                        <p><strong>∆Øu:</strong> Nhanh, kh√¥ng c√≥ trung gian</p>
                        <p><strong>Nh∆∞·ª£c:</strong> Code client ph·ª©c t·∫°p, ph·∫£i c√†i th∆∞ vi·ªán ri√™ng</p>

                        <h4>2Ô∏è‚É£ Server-Side Discovery</h4>
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li>Client ch·ªâ g·ªçi 1 <strong>domain duy nh·∫•t</strong>: <code>payment-service.internal</code></li>
                            <li>Infrastructure (Load Balancer ho·∫∑c K8s) t·ª± ƒë·ªông route ƒë·∫øn 1 healthy instance</li>
                        </ul>
                        <div class="code-block">Client ‚Üí payment-service.internal 
  ‚Üí Load Balancer ‚Üí Pick instance ‚Üí 10.0.1.5</div>
                        <p><strong>∆Øu:</strong> Client ƒë∆°n gi·∫£n (ch·ªâ g·ªçi URL), d·ªÖ qu·∫£n l√Ω</p>
                        <p><strong>Nh∆∞·ª£c:</strong> C√≥ 1 "hop" trung gian (nh∆∞ng latency r·∫•t nh·ªè)</p>

                        <h4>üìä So s√°nh nhanh</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Ti√™u ch√≠</th>
                                    <th>Client-Side</th>
                                    <th>Server-Side</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Client code</td>
                                    <td>Ph·ª©c t·∫°p</td>
                                    <td>ƒê∆°n gi·∫£n</td>
                                </tr>
                                <tr>
                                    <td>T·ªëc ƒë·ªô</td>
                                    <td>Nhanh h∆°n ch√∫t</td>
                                    <td>Nhanh (ƒë·ªß d√πng)</td>
                                </tr>
                                <tr>
                                    <td>Load balancing</td>
                                    <td>Client t·ª± l√†m</td>
                                    <td>H·ªá th·ªëng l√†m</td>
                                </tr>
                                <tr>
                                    <td>Ph√π h·ª£p</td>
                                    <td>VM/EC2 thu·∫ßn</td>
                                    <td>Kubernetes</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>‚úÖ Khi n√†o d√πng g√¨?</h4>
                        <ul>
                            <li><strong>Ch·∫°y Kubernetes:</strong> Server-side (K8s Service) ‚Äî 90% tr∆∞·ªùng h·ª£p</li>
                            <li><strong>Ch·∫°y VM/EC2 thu·∫ßn:</strong> Client-side (Consul) ho·∫∑c Load Balancer</li>
                            <li><strong>C·∫ßn custom load balancing:</strong> Client-side</li>
                            <li><strong>Mu·ªën ƒë∆°n gi·∫£n nh·∫•t:</strong> Server-side</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° T√≥m l·∫°i:</strong> Client-side = client t·ª± t√¨m v√† ch·ªçn server. Server-side = g·ªçi 1 domain, h·ªá th·ªëng t·ª± ch·ªçn server cho client. V·ªõi K8s hi·ªán ƒë·∫°i, d√πng server-side cho ƒë∆°n gi·∫£n.
                        </div>

                        <span class="tag">Service Mesh</span>
                        <span class="tag">Consul</span>
                        <span class="tag">Kubernetes</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q3</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Distributed Tracing - debug payment flow ch·∫≠m qua 5 services th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>T·∫°i sao c·∫ßn Distributed Tracing:</h4>
                        <ul>
                            <li>Request ƒëi qua nhi·ªÅu services ‚Üí logs ri√™ng l·∫ª kh√¥ng ƒë·ªß</li>
                            <li>C·∫ßn xem to√†n b·ªô flow: latency t·ª´ng service, bottleneck ·ªü ƒë√¢u</li>
                            <li>Correlate errors across services</li>
                        </ul>

                        <h4>OpenTelemetry Approach:</h4>
                        <p><strong>Trace Context:</strong> TraceID + SpanID ƒë∆∞·ª£c propagate qua headers (HTTP) ho·∫∑c message headers (Kafka)</p>
                        <p><strong>Spans:</strong> M·ªói operation t·∫°o span v·ªõi start time, end time, attributes</p>
                        <p><strong>Visualization:</strong> Jaeger/Zipkin hi·ªÉn th·ªã waterfall diagram</p>

                        <h4>Debug Example - Payment ch·∫≠m:</h4>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Service</th>
                                    <th>Th·ªù gian</th>
                                    <th>Ghi ch√∫</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>API Gateway</td>
                                    <td>5ms</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>‚îú‚îÄ Auth</td>
                                    <td>50ms</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>‚îú‚îÄ Payment</td>
                                    <td><strong>3500ms</strong></td>
                                    <td>üî¥ BOTTLENECK</td>
                                </tr>
                                <tr>
                                    <td>‚îÇ  ‚îú‚îÄ Validate</td>
                                    <td>5ms</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>‚îÇ  ‚îú‚îÄ Gateway Call</td>
                                    <td><strong>3000ms</strong></td>
                                    <td>üî¥ V·∫•n ƒë·ªÅ ch√≠nh</td>
                                </tr>
                                <tr>
                                    <td>‚îÇ  ‚îî‚îÄ Save DB</td>
                                    <td>450ms</td>
                                    <td>üü° C≈©ng ch·∫≠m</td>
                                </tr>
                                <tr>
                                    <td>‚îî‚îÄ Notification</td>
                                    <td>20ms</td>
                                    <td>-</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <p><strong>T·ªïng: 3575ms</strong></p>
                        
                        <p><strong>üî¥ Ph√°t hi·ªán:</strong> Gateway call chi·∫øm 3000ms (85% th·ªù gian) ‚Üí Connection pool exhausted</p>

                        <p><strong>Investigation:</strong></p>
                        <ul>
                            <li>Gateway call 3s ‚Üí Check: Connection pool exhausted ‚Üí Fix: TƒÉng pool + timeout</li>
                            <li>DB save 450ms ‚Üí Check: Missing index ‚Üí Fix: CREATE INDEX</li>
                            <li>Result: 3500ms ‚Üí 150ms (23x faster)</li>
                        </ul>

                        <h4>Key Metrics:</h4>
                        <ul>
                            <li><strong>Latency:</strong> P50, P95, P99 per service</li>
                            <li><strong>Error rate:</strong> % failed requests</li>
                            <li><strong>Throughput:</strong> Requests/second</li>
                            <li><strong>Dependencies:</strong> Service map</li>
                        </ul>

                        <span class="tag">OpenTelemetry</span>
                        <span class="tag">Jaeger</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q4</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Graceful Shutdown - tr√°nh data loss khi K8s terminate pod?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>The Problem:</h4>
                        <p>K8s sends SIGTERM ‚Üí 30s default grace period ‚Üí SIGKILL. N·∫øu ƒëang x·ª≠ l√Ω Kafka message 5 ph√∫t ho·∫∑c HTTP request 2 ph√∫t ‚Üí b·ªã kill ‚Üí DATA LOSS!</p>

                        <h4>Strategy:</h4>
                        <p><strong>1. Stop accepting new requests:</strong></p>
                        <ul>
                            <li>Health check return 503 ‚Üí K8s/LB stop routing traffic</li>
                            <li>Wait 5-10s ƒë·ªÉ LB update</li>
                        </ul>

                        <p><strong>2. Complete in-flight work:</strong></p>
                        <ul>
                            <li>Track s·ªë requests ƒëang x·ª≠ l√Ω</li>
                            <li>Kafka: pause consumer, wait for messages, commit offsets</li>
                            <li>HTTP: wait for responses</li>
                        </ul>

                        <p><strong>3. Close connections:</strong></p>
                        <ul>
                            <li>Database connections</li>
                            <li>Kafka producers/consumers</li>
                            <li>Redis connections</li>
                        </ul>

                        <p><strong>4. Kubernetes Config:</strong></p>
                        <div class="code-block">terminationGracePeriodSeconds: 60
preStop:
  exec:
    command: ["sh", "-c", "sleep 5"]
readinessProbe:
  httpGet:
    path: /health</div>

                        <h4>Testing:</h4>
                        <p>G·ª≠i long request ‚Üí SIGTERM while processing ‚Üí Request ph·∫£i complete, kh√¥ng 502</p>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Common Issue:</strong> Qu√™n pause Kafka consumer ‚Üí v·∫´n nh·∫≠n messages m·ªõi trong shutdown ‚Üí incomplete processing
                        </div>

                        <span class="tag">Zero Downtime</span>
                        <span class="tag">Kubernetes</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q5</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        API Gateway responsibilities - n√™n l√†m g√¨, kh√¥ng n√™n l√†m g√¨?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>N√™n l√†m:</h4>
                        <ul>
                            <li><strong>Routing:</strong> Map /api/users ‚Üí user-service, /api/payments ‚Üí payment-service</li>
                            <li><strong>Authentication:</strong> JWT validation, API key check</li>
                            <li><strong>Rate Limiting:</strong> Per user/IP throttling</li>
                            <li><strong>Request/Response transformation:</strong> Legacy API ‚Üí new format</li>
                            <li><strong>Aggregation:</strong> Combine multiple service calls into one response</li>
                            <li><strong>CORS, SSL termination</strong></li>
                        </ul>

                        <h4>Kh√¥ng n√™n l√†m:</h4>
                        <ul>
                            <li>‚ùå Business logic - thu·ªôc v·ªÅ services</li>
                            <li>‚ùå Database calls tr·ª±c ti·∫øp</li>
                            <li>‚ùå Heavy computation</li>
                            <li>‚ùå Session storage (stateless gateway t·ªët h∆°n)</li>
                        </ul>

                        <h4>Performance Patterns:</h4>
                        <p><strong>Caching:</strong> Cache GET responses (Redis) - 5-15 ph√∫t TTL</p>
                        <p><strong>Circuit Breaker:</strong> N·∫øu service down ‚Üí fallback/cached value</p>
                        <p><strong>Timeout:</strong> Set aggressive timeout (3-5s), don't wait forever</p>

                        <h4>Tools:</h4>
                        <ul>
                            <li><strong>Kong:</strong> Feature-rich, plugin ecosystem</li>
                            <li><strong>NGINX:</strong> Lightweight, high performance</li>
                            <li><strong>AWS ALB/API Gateway:</strong> Managed, scalable</li>
                        </ul>

                        <span class="tag">Rate Limiting</span>
                        <span class="tag">Circuit Breaker</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment & Transactions -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üí≥</span>
                <h2 class="category-title">Payment & Distributed Transactions</h2>
                <span class="category-count">4</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q6</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Idempotency trong payment - t·∫°i sao c·∫ßn v√† implement concept th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>T·∫°i sao c·∫ßn:</h4>
                        <ul>
                            <li>Network timeout ‚Üí client retry ‚Üí duplicate charge!</li>
                            <li>User double-click "Pay" button</li>
                            <li>Webhook ƒë∆∞·ª£c g·ª≠i l·∫°i nhi·ªÅu l·∫ßn</li>
                        </ul>

                        <h4>Strategy:</h4>
                        <p><strong>1. Idempotency Key:</strong> Client/gateway generate unique key per operation</p>
                        <p><strong>2. Check cache first:</strong> Redis v·ªõi key = idempotencyKey, 24h TTL</p>
                        <p><strong>3. Distributed lock:</strong> Prevent concurrent processing c·ªßa c√πng key</p>
                        <p><strong>4. Database unique constraint:</strong> Last line of defense</p>
                        <p><strong>5. Cache result:</strong> Return same response n·∫øu retry</p>

                        <h4>Levels of Protection:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Level</th>
                                    <th>Protection</th>
                                    <th>Trade-off</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Application</td>
                                    <td>Cache check</td>
                                    <td>Fast, race condition possible</td>
                                </tr>
                                <tr>
                                    <td>Distributed Lock</td>
                                    <td>Redis lock</td>
                                    <td>Slower, prevents races</td>
                                </tr>
                                <tr>
                                    <td>Database</td>
                                    <td>UNIQUE constraint</td>
                                    <td>Absolute safety</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Pitfall:</strong> Idempotency key kh√¥ng ƒë∆∞·ª£c reuse cho different operations. Key = hash(userId + timestamp + operation) l√† kh√¥ng ƒë·ªß!
                        </div>

                        <span class="tag">Idempotency</span>
                        <span class="tag">Distributed Lock</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q7</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        2PC vs Saga Pattern - khi n√†o d√πng g√¨? Trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>üéØ V·∫•n ƒë·ªÅ: Distributed Transaction</h4>
                        <p>Khi 1 operation c·∫ßn thay ƒë·ªïi data ·ªü <strong>nhi·ªÅu database kh√°c nhau</strong> (v√≠ d·ª•: tr·ª´ ti·ªÅn ·ªü bank A + c·ªông ti·ªÅn ·ªü bank B). L√†m sao ƒë·∫£m b·∫£o c·∫£ 2 ƒë·ªÅu th√†nh c√¥ng ho·∫∑c c·∫£ 2 ƒë·ªÅu h·ªßy?</p>

                        <h4>1Ô∏è‚É£ Two-Phase Commit (2PC)</h4>
                        <p><strong>V√≠ d·ª•:</strong> Chuy·ªÉn ti·ªÅn gi·ªØa 2 t√†i kho·∫£n trong c√πng ng√¢n h√†ng</p>
                        
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li><strong>Phase 1 (Prepare):</strong> Coordinator h·ªèi t·∫•t c·∫£ "S·∫µn s√†ng ch∆∞a?"</li>
                            <li><strong>Phase 2 (Commit):</strong> N·∫øu t·∫•t c·∫£ OK ‚Üí commit; N·∫øu 1 b√™n fail ‚Üí rollback t·∫•t c·∫£</li>
                        </ul>

                        <table>
                            <thead>
                                <tr>
                                    <th>∆Øu ƒëi·ªÉm</th>
                                    <th>Nh∆∞·ª£c ƒëi·ªÉm</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>‚úÖ Data lu√¥n consistent</td>
                                    <td>‚ùå Ch·∫≠m (ph·∫£i ƒë·ª£i t·∫•t c·∫£)</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ T·ª± ƒë·ªông rollback</td>
                                    <td>‚ùå D·ªØ li·ªáu b·ªã lock trong qu√° tr√¨nh</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ D·ªÖ hi·ªÉu</td>
                                    <td>‚ùå Coordinator ch·∫øt = h·ªá th·ªëng ƒë·ª©ng</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>2Ô∏è‚É£ Saga Pattern</h4>
                        <p><strong>V√≠ d·ª•:</strong> ƒê·∫∑t h√†ng online (thanh to√°n ‚Üí tr·ª´ kho ‚Üí giao h√†ng)</p>
                        
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li>Chia th√†nh <strong>chu·ªói c√°c b∆∞·ªõc nh·ªè</strong>, m·ªói b∆∞·ªõc l√† 1 transaction ri√™ng</li>
                            <li>N·∫øu b∆∞·ªõc 3 fail ‚Üí ch·∫°y <strong>compensating</strong> ƒë·ªÉ "undo" b∆∞·ªõc 1 v√† 2</li>
                        </ul>

                        <p><strong>Compensating transaction l√† g√¨?</strong></p>
                        <div class="info-box">
                            L√† h√†nh ƒë·ªông "ho√†n t√°c" business operation. V√≠ d·ª•:<br>
                            ‚Ä¢ Thanh to√°n th√†nh c√¥ng ‚Üí Compensate = Refund<br>
                            ‚Ä¢ Tr·ª´ kho th√†nh c√¥ng ‚Üí Compensate = C·ªông l·∫°i kho
                        </div>

                        <table>
                            <thead>
                                <tr>
                                    <th>∆Øu ƒëi·ªÉm</th>
                                    <th>Nh∆∞·ª£c ƒëi·ªÉm</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>‚úÖ Nhanh, kh√¥ng lock data</td>
                                    <td>‚ùå Ph·∫£i vi·∫øt code compensate</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ D·ªÖ scale</td>
                                    <td>‚ùå C√≥ th·ªÉ th·∫•y data "d·ªü dang"</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ Kh√¥ng c·∫ßn coordinator</td>
                                    <td>‚ùå Complex ƒë·ªÉ debug</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>3Ô∏è‚É£ So s√°nh tr·ª±c quan</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Ti√™u ch√≠</th>
                                    <th>2PC</th>
                                    <th>Saga</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>T·ªëc ƒë·ªô</td>
                                    <td>Ch·∫≠m</td>
                                    <td>Nhanh</td>
                                </tr>
                                <tr>
                                    <td>Consistency</td>
                                    <td>Strong (ngay l·∫≠p t·ª©c)</td>
                                    <td>Eventual (cu·ªëi c√πng)</td>
                                </tr>
                                <tr>
                                    <td>Lock data</td>
                                    <td>C√≥</td>
                                    <td>Kh√¥ng</td>
                                </tr>
                                <tr>
                                    <td>Complexity</td>
                                    <td>Th·∫•p</td>
                                    <td>Cao</td>
                                </tr>
                                <tr>
                                    <td>Use case</td>
                                    <td>Financial (bank)</td>
                                    <td>E-commerce, booking</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>4Ô∏è‚É£ Khi n√†o d√πng g√¨?</h4>
                        <ul>
                            <li><strong>2PC:</strong> Banking core, n∆°i <strong>kh√¥ng th·ªÉ ch·∫•p nh·∫≠n</strong> data t·∫°m th·ªù kh√¥ng nh·∫•t qu√°n</li>
                            <li><strong>Saga:</strong> Order flow, booking, n∆°i <strong>ch·∫•p nh·∫≠n</strong> eventual consistency ƒë·ªÉ ƒë·ªïi l·∫•y performance</li>
                            <li><strong>Tr√°nh c·∫£ hai:</strong> Payment processing n√™n design ƒë·ªÉ 1 service x·ª≠ l√Ω (kh√¥ng distributed)</li>
                        </ul>

                        <div class="warning-box">
                            <strong>üí° Reality:</strong> 90% tr∆∞·ªùng h·ª£p kh√¥ng c·∫ßn distributed transaction. H√£y redesign service boundaries tr∆∞·ªõc khi d√πng 2PC ho·∫∑c Saga!
                        </div>

                        <span class="tag">2PC</span>
                        <span class="tag">Saga</span>
                        <span class="tag">Compensating Transactions</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q8</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        PCI DSS compliance - principles ƒë·ªÉ handle card data an to√†n?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Rule #1: DON'T Store Card Data!</h4>
                        <p><strong>Tokenization Flow:</strong></p>
                        <ul>
                            <li>Frontend collect card data ‚Üí send TR·ª∞C TI·∫æP ƒë·∫øn gateway (not your server!)</li>
                            <li>Gateway return token (tok_abc123)</li>
                            <li>Frontend g·ª≠i token ƒë·∫øn backend</li>
                            <li>Backend d√πng token ƒë·ªÉ charge ‚Üí NEVER see actual card data</li>
                        </ul>

                        <h4>What Can Store:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Can Store?</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Full card number</td>
                                    <td>‚ùå NO</td>
                                </tr>
                                <tr>
                                    <td>CVV/CVC</td>
                                    <td>‚ùå NEVER</td>
                                </tr>
                                <tr>
                                    <td>Last 4 digits</td>
                                    <td>‚úÖ Yes</td>
                                </tr>
                                <tr>
                                    <td>Expiry date</td>
                                    <td>‚úÖ Yes</td>
                                </tr>
                                <tr>
                                    <td>Gateway token</td>
                                    <td>‚úÖ Yes</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Security Requirements:</h4>
                        <ul>
                            <li><strong>Network:</strong> TLS 1.2+, strong ciphers</li>
                            <li><strong>Access:</strong> Least privilege, MFA for admin</li>
                            <li><strong>Data:</strong> Encryption at rest, secure backups</li>
                            <li><strong>Logging:</strong> NEVER log card data - sanitize before log</li>
                            <li><strong>Audit:</strong> All payment operations logged</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Logging Danger:</strong> Check logs kh√¥ng ch·ª©a sensitive data. M·ªôt d√≤ng log c√≥ card number = PCI violation!
                        </div>

                        <span class="tag">PCI DSS</span>
                        <span class="tag">Tokenization</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q9</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Payment reconciliation - ƒë·ªëi chi·∫øu v·ªõi gateway nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>T·∫°i sao c·∫ßn:</h4>
                        <ul>
                            <li>Webhook c√≥ th·ªÉ miss ‚Üí payment successful nh∆∞ng DB kh√¥ng update</li>
                            <li>Network issue ‚Üí gateway charge nh∆∞ng ta kh√¥ng bi·∫øt</li>
                            <li>Data integrity - ƒë·∫£m b·∫£o money match</li>
                        </ul>

                        <h4>Daily Reconciliation Process:</h4>
                        <p><strong>1. Fetch data (2 AM daily):</strong></p>
                        <ul>
                            <li>Our payments (yesterday): t·ª´ DB</li>
                            <li>Gateway transactions: t·ª´ API</li>
                        </ul>

                        <p><strong>2. Compare:</strong></p>
                        <ul>
                            <li>Match by gateway reference ID</li>
                            <li>Check amount, status, timestamp</li>
                        </ul>

                        <p><strong>3. Discrepancy Types:</strong></p>
                        <table>
                            <thead>
                                <tr>
                                    <th>Issue</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Missing in gateway</td>
                                    <td>Query status API, webhook missed?</td>
                                </tr>
                                <tr>
                                    <td>Extra in gateway</td>
                                    <td>Create missing record, investigate</td>
                                </tr>
                                <tr>
                                    <td>Amount mismatch</td>
                                    <td>Manual review, alert finance team</td>
                                </tr>
                                <tr>
                                    <td>Status mismatch</td>
                                    <td>Update status, check reason</td>
                                </tr>
                            </tbody>
                        </table>

                        <p><strong>4. Generate report:</strong> Email to finance team with summary + discrepancies</p>

                        <h4>Real-time Validation:</h4>
                        <p>Khi query payment status ‚Üí so s√°nh v·ªõi gateway lu√¥n ‚Üí auto-fix simple mismatches</p>

                        <span class="tag">Reconciliation</span>
                        <span class="tag">Data Integrity</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Database & Performance -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üóÑÔ∏è</span>
                <h2 class="category-title">Database & Performance</h2>
                <span class="category-count">35</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q10</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        N+1 Query Problem - nh·∫≠n bi·∫øt v√† gi·∫£i quy·∫øt th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>The Problem:</h4>
                        <p>1 query ƒë·ªÉ l·∫•y users + N queries ƒë·ªÉ l·∫•y orders c·ªßa t·ª´ng user = 1 + N queries (N c√≥ th·ªÉ l√† 1000+)</p>

                        <h4>Solutions:</h4>
                        <p><strong>1. Eager Loading (JOIN):</strong></p>
                        <ul>
                            <li>Single query v·ªõi LEFT JOIN</li>
                            <li>TypeORM: relations: ['orders'] ho·∫∑c leftJoinAndSelect</li>
                            <li>Cons: C√≥ th·ªÉ fetch qu√° nhi·ªÅu data kh√¥ng c·∫ßn</li>
                        </ul>

                        <p><strong>2. Batch Loading:</strong></p>
                        <ul>
                            <li>Query users ‚Üí extract userIds ‚Üí IN (userIds) ƒë·ªÉ l·∫•y orders</li>
                            <li>2 queries thay v√¨ N+1</li>
                            <li>GraphQL: DataLoader pattern</li>
                        </ul>

                        <p><strong>3. Pagination + Limit:</strong></p>
                        <ul>
                            <li>Kh√¥ng load all users m·ªôt l√∫c</li>
                            <li>Take 20 users at a time</li>
                        </ul>

                        <h4>Detection:</h4>
                        <ul>
                            <li>Enable query logging (maxQueryExecutionTime)</li>
                            <li>Count queries per request (n·∫øu >10 l√† warning)</li>
                            <li>APM tools (New Relic, DataDog) highlight N+1</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° Rule of thumb:</strong> N·∫øu loop qua array v√† query trong loop = N+1 problem
                        </div>

                        <span class="tag">Query Optimization</span>
                        <span class="tag">TypeORM</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q11</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Database Indexing - khi n√†o c·∫ßn composite index? Strategy?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Khi n√†o c·∫ßn Composite Index:</h4>
                        <ul>
                            <li><strong>Multi-column WHERE:</strong> WHERE userId = ? AND createdAt > ?</li>
                            <li><strong>ORDER BY multiple columns:</strong> ORDER BY userId, createdAt DESC</li>
                            <li><strong>Covering Index:</strong> Index ch·ª©a t·∫•t c·∫£ columns trong SELECT</li>
                        </ul>

                        <h4>Column Order quan tr·ªçng:</h4>
                        <p>Index (userId, createdAt) ‚â† Index (createdAt, userId)</p>
                        <p><strong>Rule:</strong> Column c√≥ selectivity cao nh·∫•t first (√≠t duplicates)</p>

                        <h4>Index Strategy:</h4>
                        <ul>
                            <li><strong>Single column:</strong> Foreign keys, status, email (frequently queried)</li>
                            <li><strong>Composite:</strong> Frequent WHERE clauses v·ªõi 2+ columns</li>
                            <li><strong>Partial:</strong> WHERE status = 'pending' (ch·ªâ index subset)</li>
                        </ul>

                        <h4>Don't Over-Index:</h4>
                        <ul>
                            <li>M·ªói index l√†m ch·∫≠m INSERT/UPDATE/DELETE</li>
                            <li>Index t·ªën disk space</li>
                            <li>Monitor unused indexes: pg_stat_user_indexes</li>
                        </ul>

                        <h4>Example:</h4>
                        <div class="code-block">-- Good: High selectivity first
CREATE INDEX idx_user_date ON payments(user_id, created_at);

-- Supports:
WHERE user_id = 123 AND created_at > '2024-01-01'
WHERE user_id = 123  (partial match OK)

-- Does NOT support:
WHERE created_at > '2024-01-01'  (need separate index)</div>

                        <span class="tag">Database Indexing</span>
                        <span class="tag">PostgreSQL</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q12</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Sharding vs Replication - khi n√†o d√πng g√¨? Trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Replication (Primary-Replica):</h4>
                        <p><strong>How:</strong> Copy to√†n b·ªô data sang multiple servers</p>
                        <p><strong>Use case:</strong> Read-heavy workload, high availability</p>
                        <p><strong>Pros:</strong> Simple, automatic failover, scale reads</p>
                        <p><strong>Cons:</strong> Kh√¥ng scale writes, m·ªói server ph·∫£i ch·ª©a full dataset</p>

                        <h4>Sharding (Horizontal Partitioning):</h4>
                        <p><strong>How:</strong> Split data across multiple databases (shard by userId, region, etc)</p>
                        <p><strong>Use case:</strong> Data qu√° l·ªõn cho 1 server, write-heavy</p>
                        <p><strong>Pros:</strong> Scale both reads & writes, m·ªói shard nh·ªè h∆°n</p>
                        <p><strong>Cons:</strong> Complex queries (cross-shard JOIN), rebalancing kh√≥</p>

                        <h4>Sharding Strategy:</h4>
                        <p><strong>Hash-based:</strong> hash(userId) % shardCount ‚Üí even distribution</p>
                        <p><strong>Range-based:</strong> userId 1-1M ‚Üí shard1, 1M-2M ‚Üí shard2 ‚Üí easy rebalance nh∆∞ng uneven</p>
                        <p><strong>Geo-based:</strong> VN users ‚Üí Asia shard, US users ‚Üí US shard ‚Üí lower latency</p>

                        <h4>Real Decision:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Scale Need</th>
                                    <th>Solution</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Read scaling</td>
                                    <td>Replication (read replicas)</td>
                                </tr>
                                <tr>
                                    <td>Write scaling</td>
                                    <td>Sharding</td>
                                </tr>
                                <tr>
                                    <td>High availability</td>
                                    <td>Replication</td>
                                </tr>
                                <tr>
                                    <td>Data > 1 server capacity</td>
                                    <td>Sharding</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Avoid premature sharding:</strong> Start with replication. Only shard when single DB cannot handle (usually at millions of rows, high writes).
                        </div>

                        <span class="tag">Sharding</span>
                        <span class="tag">Replication</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q13</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Connection Pool sizing - l√†m sao t√≠nh ƒë√∫ng?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Formula:</h4>
                        <p><strong>connections = ((cores √ó 2) + effective_spindle_count)</strong></p>
                        <p>4-core CPU + 1 disk = (4 √ó 2) + 1 = 9 ‚Üí round to 10</p>

                        <h4>Why kh√¥ng ph·∫£i c√†ng nhi·ªÅu c√†ng t·ªët:</h4>
                        <ul>
                            <li>M·ªói connection = memory overhead (~10MB)</li>
                            <li>Context switching n·∫øu qu√° nhi·ªÅu</li>
                            <li>Database c√≥ max_connections limit</li>
                        </ul>

                        <h4>Multiple Instances:</h4>
                        <p>5 app instances √ó 10 connections = 50 total ‚Üí check DB max_connections (default PostgreSQL = 100)</p>

                        <h4>Settings:</h4>
                        <ul>
                            <li><strong>min:</strong> 5 (always ready)</li>
                            <li><strong>max:</strong> 10-20 per instance</li>
                            <li><strong>idleTimeout:</strong> 30s (close idle)</li>
                            <li><strong>connectionTimeout:</strong> 2s (fail fast)</li>
                        </ul>

                        <h4>Monitoring:</h4>
                        <div class="code-block">-- Check active connections
SELECT count(*) FROM pg_stat_activity;

-- Check connection pool exhaustion
-- If waiting > 100ms = need more connections</div>

                        <h4>Alternative: PgBouncer</h4>
                        <p>Connection pooler between app and DB ‚Üí hundreds of app connections ‚Üí reuse few DB connections</p>

                        <span class="tag">Connection Pool</span>
                        <span class="tag">PgBouncer</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q14</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        PostgreSQL vs MongoDB - khi n√†o d√πng g√¨?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>PostgreSQL (Relational):</h4>
                        <p><strong>Khi n√†o:</strong></p>
                        <ul>
                            <li>Structured data v·ªõi relationships (users ‚Üí orders ‚Üí payments)</li>
                            <li>ACID transactions critical (financial data)</li>
                            <li>Complex queries, JOINs, aggregations</li>
                            <li>Strong consistency required</li>
                        </ul>
                        <p><strong>Examples:</strong> Payments, user accounts, inventory, audit logs</p>

                        <h4>MongoDB (Document):</h4>
                        <p><strong>Khi n√†o:</strong></p>
                        <ul>
                            <li>Flexible schema (product catalog v·ªõi nhi·ªÅu variants)</li>
                            <li>High write throughput (logs, events, analytics)</li>
                            <li>Denormalized data OK (duplicate ƒë·ªÉ fast reads)</li>
                            <li>Horizontal scaling c·∫ßn thi·∫øt</li>
                        </ul>
                        <p><strong>Examples:</strong> Logs, sessions, product catalog, CMS content</p>

                        <h4>Hybrid Approach:</h4>
                        <p>D√πng c·∫£ hai! PostgreSQL cho transactional data, MongoDB cho analytics/logs</p>

                        <h4>Decision Criteria:</h4>
                        <ul>
                            <li><strong>Data structure:</strong> Fixed schema ‚Üí Postgres | Flexible ‚Üí Mongo</li>
                            <li><strong>Consistency:</strong> ACID ‚Üí Postgres | Eventual OK ‚Üí Mongo</li>
                            <li><strong>Queries:</strong> Complex JOINs ‚Üí Postgres | Simple lookups ‚Üí Mongo</li>
                            <li><strong>Scale:</strong> Vertical ‚Üí Postgres | Horizontal ‚Üí Mongo</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° T·∫°i UrBox:</strong> Payments/Users/Loyalty = PostgreSQL. Logs/Sessions/Product variants = MongoDB.
                        </div>

                        <span class="tag">PostgreSQL</span>
                        <span class="tag">MongoDB</span>
                    </div>
                </div>
            </div>
        </div>

            <!-- Advanced Database Questions Q31-Q60 -->

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q31</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Query Execution Plan - ƒë·ªçc v√† optimize th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>üéØ V·∫•n ƒë·ªÅ</h4>
                        <p>PostgreSQL th·ª±c thi query nh∆∞ th·∫ø n√†o? L√†m sao bi·∫øt query ch·∫≠m do ƒë√¢u?</p>

                        <h4>ƒê·ªçc Execution Plan</h4>
                        <p>D√πng <code>EXPLAIN (ANALYZE, BUFFERS)</code> ƒë·ªÉ xem chi ti·∫øt:</p>
                        <ul>
                            <li><strong>Seq Scan:</strong> ƒê·ªçc to√†n b·ªô b·∫£ng (ch·∫≠m v·ªõi b·∫£ng l·ªõn)</li>
                            <li><strong>Index Scan:</strong> D√πng index (nhanh)</li>
                            <li><strong>Bitmap Index Scan:</strong> K·∫øt h·ª£p nhi·ªÅu index</li>
                            <li><strong>Nested Loop:</strong> JOIN nh·ªè, O(n√óm)</li>
                            <li><strong>Hash Join:</strong> JOIN l·ªõn, build hash table</li>
                            <li><strong>Merge Join:</strong> JOIN khi c·∫£ 2 b·∫£ng ƒë√£ sorted</li>
                        </ul>

                        <h4>Red Flags üö©</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>V·∫•n ƒë·ªÅ</th>
                                    <th>Gi·∫£i ph√°p</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Seq Scan tr√™n b·∫£ng l·ªõn</td>
                                    <td>Th√™m index</td>
                                </tr>
                                <tr>
                                    <td>Rows Removed by Filter cao</td>
                                    <td>Index kh√¥ng hi·ªáu qu·∫£, th·ª≠ index kh√°c</td>
                                </tr>
                                <tr>
                                    <td>High Buffers (disk read)</td>
                                    <td>TƒÉng shared_buffers, th√™m index</td>
                                </tr>
                                <tr>
                                    <td>High cost</td>
                                    <td>Rewrite query, th√™m index</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="info-box">
                            <strong>üí° Tip:</strong> D√πng EXPLAIN (ANALYZE, BUFFERS, FORMAT JSON) ƒë·ªÉ xem chi ti·∫øt nh·∫•t
                        </div>

                        <span class="tag">Query Optimization</span>
                        <span class="tag">PostgreSQL</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q32</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Transaction Isolation Levels - 4 levels v√† phenomena?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>3 Phenomena c·∫ßn tr√°nh</h4>
                        <ul>
                            <li><strong>Dirty Read:</strong> ƒê·ªçc data ch∆∞a commit (transaction kh√°c ƒëang s·ª≠a)</li>
                            <li><strong>Non-repeatable Read:</strong> ƒê·ªçc l·∫°i ‚Üí data ƒë√£ ƒë·ªïi (do transaction kh√°c commit)</li>
                            <li><strong>Phantom Read:</strong> Query l·∫°i ‚Üí c√≥ th√™m/x√≥a rows (do transaction kh√°c insert/delete)</li>
                        </ul>

                        <h4>4 Isolation Levels</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Level</th>
                                    <th>Dirty Read</th>
                                    <th>Non-repeatable</th>
                                    <th>Phantom</th>
                                    <th>Performance</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Read Uncommitted</td>
                                    <td>‚ùå C√≥ th·ªÉ</td>
                                    <td>‚ùå C√≥ th·ªÉ</td>
                                    <td>‚ùå C√≥ th·ªÉ</td>
                                    <td>Nhanh nh·∫•t</td>
                                </tr>
                                <tr>
                                    <td>Read Committed ‚≠ê</td>
                                    <td>‚úÖ Kh√¥ng</td>
                                    <td>‚ùå C√≥ th·ªÉ</td>
                                    <td>‚ùå C√≥ th·ªÉ</td>
                                    <td>Nhanh</td>
                                </tr>
                                <tr>
                                    <td>Repeatable Read</td>
                                    <td>‚úÖ Kh√¥ng</td>
                                    <td>‚úÖ Kh√¥ng</td>
                                    <td>‚ùå C√≥ th·ªÉ*</td>
                                    <td>Ch·∫≠m h∆°n</td>
                                </tr>
                                <tr>
                                    <td>Serializable</td>
                                    <td>‚úÖ Kh√¥ng</td>
                                    <td>‚úÖ Kh√¥ng</td>
                                    <td>‚úÖ Kh√¥ng</td>
                                    <td>Ch·∫≠m nh·∫•t</td>
                                </tr>
                            </tbody>
                        </table>
                        <p><em>*PostgreSQL: Repeatable Read ngƒÉn c·∫£ Phantom Read</em></p>

                        <h4>Khi n√†o d√πng g√¨?</h4>
                        <ul>
                            <li><strong>Read Committed (default):</strong> 90% tr∆∞·ªùng h·ª£p, c√¢n b·∫±ng consistency/performance</li>
                            <li><strong>Repeatable Read:</strong> Financial reports, c·∫ßn ƒë·ªçc snapshot nh·∫•t qu√°n</li>
                            <li><strong>Serializable:</strong> Bank transfer, inventory deduction (strict consistency)</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è PostgreSQL kh√°c MySQL:</strong> PostgreSQL default l√† Read Committed (an to√†n), MySQL default l√† Repeatable Read
                        </div>

                        <span class="tag">ACID</span>
                        <span class="tag">Transactions</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q33</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Deadlock detection v√† resolution?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Deadlock l√† g√¨?</h4>
                        <p>Transaction A ƒëang gi·ªØ lock X, c·∫ßn lock Y. Transaction B ƒëang gi·ªØ lock Y, c·∫ßn lock X. C·∫£ 2 ƒë·ªÅu ch·ªù nhau ‚Üí Deadlock!</p>

                        <h4>V√≠ d·ª• th·ª±c t·∫ø</h4>
                        <div class="code-block">T1: BEGIN; UPDATE accounts WHERE id=1; UPDATE accounts WHERE id=2; COMMIT;
T2: BEGIN; UPDATE accounts WHERE id=2; UPDATE accounts WHERE id=1; COMMIT;

‚Üí DEADLOCK!</div>

                        <h4>C√°ch PostgreSQL x·ª≠ l√Ω</h4>
                        <ul>
                            <li><strong>Detection:</strong> T·ª± ƒë·ªông ph√°t hi·ªán deadlock (graph cycle detection)</li>
                            <li><strong>Resolution:</strong> Kill 1 transaction (th∆∞·ªùng l√† c√°i "√≠t t·ªïn th·∫•t" h∆°n)</li>
                            <li><strong>Error:</strong> Transaction b·ªã kill nh·∫≠n l·ªói <code>deadlock_detected</code></li>
                        </ul>

                        <h4>Prevention Strategies</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Strategy</th>
                                    <th>C√°ch l√†m</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Consistent Ordering</td>
                                    <td>Lu√¥n UPDATE theo th·ª© t·ª± ID (1, 2, 3...)</td>
                                </tr>
                                <tr>
                                    <td>Short Transactions</td>
                                    <td>Commit s·ªõm, ƒë·ª´ng gi·ªØ lock l√¢u</td>
                                </tr>
                                <tr>
                                    <td>Use NOWAIT</td>
                                    <td>SELECT FOR UPDATE NOWAIT ‚Üí fail fast</td>
                                </tr>
                                <tr>
                                    <td>Retry Logic</td>
                                    <td>App t·ª± retry khi g·∫∑p deadlock error</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="info-box">
                            <strong>üí° Monitoring:</strong> Check pg_stat_database.deadlocks ƒë·ªÉ bi·∫øt t·∫ßn su·∫•t deadlock
                        </div>

                        <span class="tag">Locking</span>
                        <span class="tag">Deadlock</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q34</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        B-Tree Index internals - t·∫°i sao nhanh?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Array vs B-Tree</h4>
                        <ul>
                            <li><strong>Array:</strong> T√¨m ph·∫ßn t·ª≠ ph·∫£i duy·ªát tu·∫ßn t·ª± O(n)</li>
                            <li><strong>B-Tree:</strong> C·∫•u tr√∫c c√¢y, t√¨m ki·∫øm O(log n)</li>
                        </ul>

                        <h4>C·∫•u tr√∫c B-Tree</h4>
                        <ul>
                            <li><strong>Root node:</strong> Node g·ªëc, ch·ª©a key pointers</li>
                            <li><strong>Internal nodes:</strong> Nodes trung gian, ƒëi·ªÅu h∆∞·ªõng</li>
                            <li><strong>Leaf nodes:</strong> Ch·ª©a actual data ho·∫∑c pointers</li>
                            <li><strong>Balanced:</strong> M·ªçi path t·ª´ root ƒë·∫øn leaf c√≥ c√πng ƒë·ªô d√†i</li>
                        </ul>

                        <h4>V√≠ d·ª•: T√¨m user_id = 42</h4>
                        <div class="code-block">Root: [10, 50, 100]
      ‚Üì
Internal: [30, 40, 45]
      ‚Üì
Leaf: [41, 42, 43, 44] ‚Üê Found!

Ch·ªâ c·∫ßn 3 disk reads thay v√¨ scan 1000+ rows</div>

                        <h4>T·∫°i sao B-Tree ph√π h·ª£p cho Database?</h4>
                        <ul>
                            <li>‚úÖ Range queries hi·ªáu qu·∫£ (>,<, BETWEEN)</li>
                            <li>‚úÖ Insert/delete v·∫´n gi·ªØ c√¢n b·∫±ng</li>
                            <li>‚úÖ Sequential access t·ªët (leaf nodes linked)</li>
                            <li>‚úÖ Disk-friendly (m·ªói node = 1 disk page)</li>
                        </ul>

                        <h4>Khi n√†o KH√îNG d√πng B-Tree?</h4>
                        <ul>
                            <li>Equality-only v·ªõi low cardinality ‚Üí Hash index</li>
                            <li>Full-text search ‚Üí GIN/GiST index</li>
                            <li>Geospatial ‚Üí GiST/SP-GiST</li>
                        </ul>

                        <span class="tag">B-Tree</span>
                        <span class="tag">Index Internals</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q35</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        VACUUM v√† ANALYZE - t·∫°i sao c·∫ßn?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>MVCC v√† Dead Tuples</h4>
                        <p>PostgreSQL d√πng MVCC (Multi-Version Concurrency Control):</p>
                        <ul>
                            <li>UPDATE = INSERT row m·ªõi + ƒë√°nh d·∫•u row c≈© l√† "dead"</li>
                            <li>DELETE = ƒë√°nh d·∫•u row l√† "dead"</li>
                            <li>Row "dead" v·∫´n chi·∫øm disk space!</li>
                        </ul>

                        <h4>VACUUM - D·ªçn r√°c</h4>
                        <p><strong>C√¥ng d·ª•ng:</strong></p>
                        <ul>
                            <li>X√≥a dead tuples (rows ƒë√£ update/delete)</li>
                            <li>Gi·∫£i ph√≥ng disk space (trong table, kh√¥ng tr·∫£ v·ªÅ OS)</li>
                            <li>Update visibility map (cho index-only scans)</li>
                            <li>Prevent transaction ID wraparound</li>
                        </ul>

                        <h4>VACUUM FULL vs VACUUM</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>VACUUM</th>
                                    <th>VACUUM FULL</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Non-blocking</td>
                                    <td>Blocking (table lock)</td>
                                </tr>
                                <tr>
                                    <td>Space gi·∫£i ph√≥ng t√°i s·ª≠ d·ª•ng</td>
                                    <td>Tr·∫£ space v·ªÅ OS</td>
                                </tr>
                                <tr>
                                    <td>Ch·∫°y th∆∞·ªùng xuy√™n</td>
                                    <td>Ch·ªâ khi c·∫ßn thi·∫øt</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>ANALYZE - C·∫≠p nh·∫≠t Statistics</h4>
                        <p>PostgreSQL c·∫ßn bi·∫øt:</p>
                        <ul>
                            <li>B·∫£ng c√≥ bao nhi√™u rows?</li>
                            <li>Data ph√¢n b·ªë th·∫ø n√†o?</li>
                            <li>Most common values l√† g√¨?</li>
                        </ul>
                        <p>‚Üí T·ª´ ƒë√≥ query planner ch·ªçn execution plan t·ªëi ∆∞u</p>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è VACUUM kh√¥ng t·ª± ch·∫°y ƒë·ªß:</strong> N·∫øu autovacuum kh√¥ng k·ªãp, table s·∫Ω ph√¨nh to. Monitor pg_stat_user_tables.n_dead_tup
                        </div>

                        <span class="tag">PostgreSQL</span>
                        <span class="tag">Maintenance</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q36</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Table Partitioning - khi n√†o c·∫ßn v√† chi·∫øn l∆∞·ª£c?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Khi n√†o c·∫ßn Partitioning?</h4>
                        <ul>
                            <li>Table > 100GB (query ch·∫≠m, maintenance kh√≥)</li>
                            <li>Query th∆∞·ªùng ch·ªâ access subset data (time range, region)</li>
                            <li>C·∫ßn archive/delete old data th∆∞·ªùng xuy√™n</li>
                            <li>Index kh√¥ng v·ª´a RAM</li>
                        </ul>

                        <h4>Partitioning Strategies</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Strategy</th>
                                    <th>Ph√π h·ª£p khi</th>
                                    <th>V√≠ d·ª•</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Range</td>
                                    <td>Time-series data</td>
                                    <td>orders_2024_01, orders_2024_02</td>
                                </tr>
                                <tr>
                                    <td>List</td>
                                    <td>Discrete categories</td>
                                    <td>region_vn, region_us, region_eu</td>
                                </tr>
                                <tr>
                                    <td>Hash</td>
                                    <td>Even distribution</td>
                                    <td>user_id % 10</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Benefits</h4>
                        <ul>
                            <li>‚úÖ Query ch·ªâ scan partition li√™n quan (partition pruning)</li>
                            <li>‚úÖ Maintenance d·ªÖ h∆°n (VACUUM, REINDEX t·ª´ng partition)</li>
                            <li>‚úÖ Archive old data b·∫±ng c√°ch detach partition</li>
                            <li>‚úÖ Parallel processing tr√™n nhi·ªÅu partitions</li>
                        </ul>

                        <h4>Trade-offs</h4>
                        <ul>
                            <li>‚ùå Query kh√¥ng c√≥ partition key ‚Üí scan all partitions</li>
                            <li>‚ùå Unique constraints ph·∫£i include partition key</li>
                            <li>‚ùå Complexity tƒÉng</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° PostgreSQL 10+:</strong> Declarative partitioning (CREATE TABLE ... PARTITION BY) d·ªÖ d√πng h∆°n manual inheritance
                        </div>

                        <span class="tag">Partitioning</span>
                        <span class="tag">Performance</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q37</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Replication lag - nguy√™n nh√¢n v√† gi·∫£i ph√°p?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Replication l√† g√¨?</h4>
                        <p>Primary (write) ‚Üí g·ª≠i WAL (Write-Ahead Log) ‚Üí Standby (read) √°p d·ª•ng</p>

                        <h4>Lag l√† g√¨?</h4>
                        <p>Data ƒë√£ commit tr√™n Primary nh∆∞ng Standby ch∆∞a nh·∫≠n/apply</p>

                        <h4>Nguy√™n nh√¢n lag</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Nguy√™n nh√¢n</th>
                                    <th>Gi·∫£i ph√°p</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Network ch·∫≠m</td>
                                    <td>Th√™m bandwidth, d√πng compression</td>
                                </tr>
                                <tr>
                                    <td>Standby y·∫øu</td>
                                    <td>Scale up standby (CPU/disk)</td>
                                </tr>
                                <tr>
                                    <td>Query n·∫∑ng tr√™n standby</td>
                                    <td>max_standby_streaming_delay, hot_standby_feedback</td>
                                </tr>
                                <tr>
                                    <td>Too many writes</td>
                                    <td>max_wal_size, checkpoint tuning</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Gi·∫£i ph√°p cho Read Replica</h4>
                        <ul>
                            <li><strong>Routing logic:</strong> ƒê·ªçc t·ª´ Primary n·∫øu lag > threshold (v√≠ d·ª•: 1 gi√¢y)</li>
                            <li><strong>Sticky sessions:</strong> User v·ª´a write ‚Üí ƒë·ªçc t·ª´ Primary trong X gi√¢y</li>
                            <li><strong>Eventual consistency UI:</strong> Hi·ªÉn th·ªã "ƒëang ƒë·ªìng b·ªô" n·∫øu data c≈©</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Critical:</strong> Payment status query ‚Üí lu√¥n ƒë·ªçc t·ª´ Primary (lag unacceptable)
                        </div>

                        <span class="tag">Replication</span>
                        <span class="tag">High Availability</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q38</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        JSONB trong PostgreSQL - khi n√†o d√πng?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>JSON vs JSONB</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>JSON</th>
                                    <th>JSONB ‚≠ê</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Store as text</td>
                                    <td>Store as binary (parsed)</td>
                                </tr>
                                <tr>
                                    <td>Slow query</td>
                                    <td>Fast query</td>
                                </tr>
                                <tr>
                                    <td>Gi·ªØ nguy√™n whitespace</td>
                                    <td>Optimized storage</td>
                                </tr>
                                <tr>
                                    <td>Kh√¥ng support indexing</td>
                                    <td>Support GIN index</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Khi n√†o d√πng JSONB?</h4>
                        <ul>
                            <li><strong>Schema linh ho·∫°t:</strong> Product variants, c·∫•u h√¨nh</li>
                            <li><strong>Nested data:</strong> API response cache</li>
                            <li><strong>Rarely queried:</strong> Audit logs, event data</li>
                            <li><strong>Prototype nhanh:</strong> Ch∆∞a c·∫ßn normalize</li>
                        </ul>

                        <h4>Khi n√†o KH√îNG d√πng?</h4>
                        <ul>
                            <li>‚ùå C·∫ßn JOIN, aggregation ph·ª©c t·∫°p</li>
                            <li>‚ùå C·∫ßn foreign key constraints</li>
                            <li>‚ùå C·∫ßn unique constraints</li>
                            <li>‚ùå Data structure ·ªïn ƒë·ªãnh</li>
                        </ul>

                        <h4>Query JSONB</h4>
                        <div class="code-block">-- Get value
SELECT data->>'name' FROM users;

-- Check exists
SELECT * FROM products WHERE metadata @> '{"color": "red"}';

-- Index
CREATE INDEX idx_data ON products USING GIN (metadata);</div>

                        <span class="tag">JSONB</span>
                        <span class="tag">PostgreSQL</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q39</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Event Sourcing pattern - kh√°i ni·ªám v√† use cases?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Traditional vs Event Sourcing</h4>
                        <p><strong>Traditional:</strong> L∆∞u state hi·ªán t·∫°i (balance = $100)</p>
                        <p><strong>Event Sourcing:</strong> L∆∞u chu·ªói events (Deposited $50, Deposited $100, Withdrew $50)</p>

                        <h4>Components</h4>
                        <ul>
                            <li><strong>Event Store:</strong> Append-only log c·ªßa events</li>
                            <li><strong>Aggregate:</strong> Replay events ƒë·ªÉ t√≠nh state</li>
                            <li><strong>Projection:</strong> Read model ƒë∆∞·ª£c build t·ª´ events</li>
                            <li><strong>Snapshot:</strong> Cache state ƒë·ªÉ kh√¥ng replay t·ª´ ƒë·∫ßu</li>
                        </ul>

                        <h4>Benefits</h4>
                        <ul>
                            <li>‚úÖ Audit trail ho√†n ch·ªânh (bi·∫øt data ƒë·ªïi t·ª´ khi n√†o)</li>
                            <li>‚úÖ Time travel (xem state ·ªü b·∫•t k·ª≥ th·ªù ƒëi·ªÉm)</li>
                            <li>‚úÖ Rebuild read models t·ª´ events</li>
                            <li>‚úÖ Event-driven architecture t·ª± nhi√™n</li>
                        </ul>

                        <h4>Trade-offs</h4>
                        <ul>
                            <li>‚ùå Complexity cao</li>
                            <li>‚ùå Event schema evolution kh√≥</li>
                            <li>‚ùå Query ph·ª©c t·∫°p (ph·∫£i qua projection)</li>
                            <li>‚ùå Storage tƒÉng (l∆∞u t·∫•t c·∫£ events)</li>
                        </ul>

                        <h4>Use Cases</h4>
                        <ul>
                            <li>Financial ledger (banking, accounting)</li>
                            <li>Inventory systems</li>
                            <li>Audit-heavy applications</li>
                        </ul>

                        <span class="tag">Event Sourcing</span>
                        <span class="tag">CQRS</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q40</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Connection Pool v·ªõi PgBouncer - t·∫°i sao c·∫ßn?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Too many connections</h4>
                        <ul>
                            <li>App c√≥ 100 instances</li>
                            <li>M·ªói instance 10 connections = 1000 total</li>
                            <li>PostgreSQL max_connections = 100 (default)</li>
                            <li>‚Üí Connection exhausted!</li>
                        </ul>

                        <h4>PgBouncer l√† g√¨?</h4>
                        <p>Connection pooler ƒë·ª©ng gi·ªØa app v√† PostgreSQL:</p>
                        <div class="code-block">App (1000 connections) 
    ‚Üì
PgBouncer (gi·ªØ 100 connections th·∫≠t, reuse cho 1000 app)
    ‚Üì
PostgreSQL (ch·ªâ th·∫•y 100 connections)</div>

                        <h4>Pool Modes</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Mode</th>
                                    <th>C√°ch ho·∫°t ƒë·ªông</th>
                                    <th>Use case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Session</td>
                                    <td>Connection g√°n cho c·∫£ session</td>
                                    <td>Prepared statements, temp tables</td>
                                </tr>
                                <tr>
                                    <td>Transaction ‚≠ê</td>
                                    <td>Connection g√°n cho t·ª´ng transaction</td>
                                    <td>REST API (stateless)</td>
                                </tr>
                                <tr>
                                    <td>Statement</td>
                                    <td>Connection g√°n cho t·ª´ng query</td>
                                    <td>Autocommit mode only</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="info-box">
                            <strong>üí° Recommendation:</strong> D√πng Transaction mode cho 90% use cases (REST APIs)
                        </div>

                        <span class="tag">PgBouncer</span>
                        <span class="tag">Connection Pool</span>
                    </div>
                </div>
            </div>

                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q41</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Window Functions - ROW_NUMBER, RANK, LAG/LEAD?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Aggregation nh∆∞ng gi·ªØ chi ti·∫øt</h4>
                        <p>Mu·ªën so s√°nh salary v·ªõi average c·ªßa department, nh∆∞ng kh√¥ng mu·ªën GROUP BY m·∫•t chi ti·∫øt t·ª´ng employee.</p>

                        <h4>Window Functions gi·∫£i quy·∫øt</h4>
                        <p>Calculate aggregate (MAX, AVG, SUM...) <strong>OVER</strong> a window of rows, gi·ªØ nguy√™n t·ª´ng row.</p>

                        <h4>Common Functions</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Function</th>
                                    <th>M√¥ t·∫£</th>
                                    <th>V√≠ d·ª•</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ROW_NUMBER()</td>
                                    <td>Number t·ª´ 1, unique</td>
                                    <td>Top 3 m·ªói category</td>
                                </tr>
                                <tr>
                                    <td>RANK()</td>
                                    <td>Rank, c√≥ gaps (1, 2, 2, 4)</td>
                                    <td>Leaderboard</td>
                                </tr>
                                <tr>
                                    <td>DENSE_RANK()</td>
                                    <td>Rank, kh√¥ng gaps (1, 2, 2, 3)</td>
                                    <td>Tier ranking</td>
                                </tr>
                                <tr>
                                    <td>LAG(col)</td>
                                    <td>Gi√° tr·ªã row tr∆∞·ªõc</td>
                                    <td>So s√°nh th√°ng tr∆∞·ªõc</td>
                                </tr>
                                <tr>
                                    <td>LEAD(col)</td>
                                    <td>Gi√° tr·ªã row sau</td>
                                    <td>D·ª± b√°o</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>V√≠ d·ª• th·ª±c t·∫ø</h4>
                        <div class="code-block">-- Top 3 highest paid employees per department
SELECT *
FROM (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY dept ORDER BY salary DESC) as rank
    FROM employees
) sub
WHERE rank <= 3;

-- Salary vs department average
SELECT name, salary,
       AVG(salary) OVER (PARTITION BY dept) as dept_avg
FROM employees;</div>

                        <span class="tag">Window Functions</span>
                        <span class="tag">PostgreSQL</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q42</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Full-Text Search trong PostgreSQL?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Search kh√¥ng ch√≠nh x√°c</h4>
                        <p><code>LIKE '%keyword%'</code> ch·∫≠m (full table scan) v√† kh√¥ng t√¨m ƒë∆∞·ª£c "running" khi search "run".</p>

                        <h4>PostgreSQL Full-Text Search</h4>
                        <ul>
                            <li>Chuy·ªÉn text th√†nh <strong>tsvector</strong> (normalized tokens)</li>
                            <li>Chuy·ªÉn query th√†nh <strong>tsquery</strong></li>
                            <li>Match d√πng <strong>@@</strong> operator</li>
                        </ul>

                        <h4>Basic Usage</h4>
                        <div class="code-block">-- Simple search
SELECT * FROM articles 
WHERE to_tsvector('english', content) @@ to_tsquery('english', 'postgresql');

-- With ranking
SELECT *, ts_rank(to_tsvector(content), query) as rank
FROM articles, plainto_tsquery('english', 'search terms') query
WHERE to_tsvector(content) @@ query
ORDER BY rank DESC;</div>

                        <h4>Performance Optimization</h4>
                        <ul>
                            <li><strong>GIN Index:</strong> CREATE INDEX idx_fts ON articles USING GIN (to_tsvector('english', content));</li>
                            <li><strong>Precomputed column:</strong> Th√™m tsvector column, update trigger</li>
                            <li><strong>Weights:</strong> Title quan tr·ªçng h∆°n content (setweight)</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° ElasticSearch vs PostgreSQL FTS:</strong> ElasticSearch m·∫°nh h∆°n (fuzzy search, suggestions), nh∆∞ng PostgreSQL FTS ƒë·ªß cho 90% use cases v√† ƒë∆°n gi·∫£n h∆°n
                        </div>

                        <span class="tag">Full-Text Search</span>
                        <span class="tag">GIN Index</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q43</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Write-Ahead Logging (WAL) - t·∫°i sao c·∫ßn?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Data durability</h4>
                        <p>N·∫øu server crash gi·ªØa ch·ª´ng UPDATE, data c√≥ b·ªã h·ªèng kh√¥ng? L√†m sao recover?</p>

                        <h4>WAL gi·∫£i quy·∫øt</h4>
                        <p><strong>Tr∆∞·ªõc khi ghi data page:</strong> Ghi log v√†o WAL tr∆∞·ªõc (append-only, sequential)</p>
                        <p><strong>Sau khi WAL fsync:</strong> M·ªõi ghi v√†o data files</p>

                        <h4>L·ª£i √≠ch</h4>
                        <ul>
                            <li>‚úÖ <strong>Durability:</strong> WAL fsync = data an to√†n, d√π ch∆∞a ghi v√†o data file</li>
                            <li>‚úÖ <strong>Crash recovery:</strong> Replay WAL ƒë·ªÉ restore sau crash</li>
                            <li>‚úÖ <strong>Replication:</strong> Standby apply WAL ƒë·ªÉ replicate</li>
                            <li>‚úÖ <strong>Random ‚Üí Sequential:</strong> WAL write sequential (nhanh), data write batch sau</li>
                        </ul>

                        <h4>Performance Tuning</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Setting</th>
                                    <th>Gi√° tr·ªã</th>
                                    <th>√ù nghƒ©a</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>synchronous_commit</td>
                                    <td>on/off</td>
                                    <td>on = wait WAL fsync (safe), off = faster (risky)</td>
                                </tr>
                                <tr>
                                    <td>wal_buffers</td>
                                    <td>16MB</td>
                                    <td>WAL buffer size</td>
                                </tr>
                                <tr>
                                    <td>checkpoint_timeout</td>
                                    <td>5min</td>
                                    <td>Bao l√¢u force WAL ‚Üí data files</td>
                                </tr>
                            </tbody>
                        </table>

                        <span class="tag">WAL</span>
                        <span class="tag">Internals</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q44</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Hot Standby vs Warm Standby?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Warm Standby</h4>
                        <ul>
                            <li>Standby ch·ªâ nh·∫≠n WAL, kh√¥ng cho read</li>
                            <li>D√πng cho disaster recovery</li>
                            <li>Switchover m·ªõi c√≥ th·ªÉ read</li>
                        </ul>

                        <h4>Hot Standby ‚≠ê</h4>
                        <ul>
                            <li>Standby nh·∫≠n WAL V√Ä cho read queries</li>
                            <li>Read replica pattern</li>
                            <li>Scale reads</li>
                        </ul>

                        <h4>So s√°nh</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>Warm</th>
                                    <th>Hot</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Read queries</td>
                                    <td>‚ùå Kh√¥ng</td>
                                    <td>‚úÖ C√≥</td>
                                </tr>
                                <tr>
                                    <td>Replication lag</td>
                                    <td>√çt quan tr·ªçng</td>
                                    <td>C·∫ßn monitor</td>
                                </tr>
                                <tr>
                                    <td>Conflict</td>
                                    <td>Kh√¥ng c√≥</td>
                                    <td>Hot standby feedback</td>
                                </tr>
                                <tr>
                                    <td>Use case</td>
                                    <td>DR only</td>
                                    <td>DR + Read scaling</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="info-box">
                            <strong>üí° PostgreSQL 9.0+:</strong> Hot standby built-in, ch·ªâ c·∫ßn hot_standby = on trong postgresql.conf
                        </div>

                        <span class="tag">Replication</span>
                        <span class="tag">High Availability</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q45</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Covering Index - khi n√†o v√† t·∫°i sao nhanh?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Index + Table lookup</h4>
                        <p>Th√¥ng th∆∞·ªùng: T√¨m trong index ‚Üí l·∫•y pointer ‚Üí ƒë·ªçc t·ª´ table ‚Üí <strong>2 disk reads</strong></p>

                        <h4>Covering Index gi·∫£i quy·∫øt</h4>
                        <p>Index ch·ª©a <strong>t·∫•t c·∫£ columns</strong> c·∫ßn cho query (INCLUDE columns)</p>
                        <p>‚Üí Ch·ªâ c·∫ßn ƒë·ªçc index, kh√¥ng c·∫ßn ƒë·ªçc table ‚Üí <strong>Index-Only Scan</strong></p>

                        <h4>V√≠ d·ª•</h4>
                        <div class="code-block">-- Query th∆∞·ªùng xuy√™n
SELECT user_id, created_at FROM orders 
WHERE status = 'completed';

-- Covering Index (status trong index, user_id + created_at trong INCLUDE)
CREATE INDEX idx_covering ON orders(status) 
INCLUDE (user_id, created_at);

-- PostgreSQL ch·ªâ c·∫ßn ƒë·ªçc index, kh√¥ng c·∫ßn table lookup</div>

                        <h4>Trade-offs</h4>
                        <ul>
                            <li>‚úÖ Query nhanh h∆°n (1 read vs 2 reads)</li>
                            <li>‚ùå Index l·ªõn h∆°n (chi·∫øm disk space)</li>
                            <li>‚ùå Insert/update ch·∫≠m h∆°n (nhi·ªÅu column c·∫ßn update)</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è PostgreSQL c·∫ßn Visibility Map:</strong> Index-only scan ch·ªâ ho·∫°t ƒë·ªông khi PostgreSQL bi·∫øt t·∫•t c·∫£ tuples trong page ƒë·ªÅu visible (ƒë√£ VACUUM)
                        </div>

                        <span class="tag">Indexing</span>
                        <span class="tag">Query Optimization</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q46</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Time-Series Database - khi n√†o d√πng TimescaleDB?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Time-Series Data l√† g√¨?</h4>
                        <p>Data ƒë∆∞·ª£c ghi theo th·ªù gian: metrics, sensor data, stock prices, logs</p>
                        <p><strong>Pattern:</strong> Write-heavy, read recent data, aggregate by time range</p>

                        <h4>V·∫•n ƒë·ªÅ v·ªõi PostgreSQL th∆∞·ªùng</h4>
                        <ul>
                            <li>Table l·ªõn ‚Üí query ch·∫≠m</li>
                            <li>Delete old data expensive</li>
                            <li>Time-based aggregation kh√¥ng optimize</li>
                        </ul>

                        <h4>TimescaleDB (PostgreSQL extension)</h4>
                        <p>Gi·ªØ nguy√™n SQL, th√™m optimizations cho time-series:</p>
                        <ul>
                            <li><strong>Hypertables:</strong> Auto-partition theo time</li>
                            <li><strong>Chunking:</strong> M·ªói partition = 1 time range (1 ng√†y, 1 tu·∫ßn)</li>
                            <li><strong>Time-based indexing:</strong> Optimize cho time range queries</li>
                            <li><strong>Compression:</strong> N√©n old data (10x reduction)</li>
                            <li><strong>Continuous aggregates:</strong> Pre-computed rollups</li>
                        </ul>

                        <h4>Khi n√†o d√πng?</h4>
                        <ul>
                            <li>‚úÖ IoT sensor data</li>
                            <li>‚úÖ Application metrics</li>
                            <li>‚úÖ Financial tick data</li>
                            <li>‚úÖ Logs (n·∫øu query nhi·ªÅu)</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° TimescaleDB vs InfluxDB:</strong> TimescaleDB = PostgreSQL (ecosystem quen thu·ªôc), InfluxDB = purpose-built (hi·ªáu nƒÉng cao h∆°n cho pure time-series)
                        </div>

                        <span class="tag">Time-Series</span>
                        <span class="tag">TimescaleDB</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q47</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        CQRS Pattern - Command Query Responsibility Segregation?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Traditional CRUD</h4>
                        <p>C√πng 1 model cho c·∫£ read v√† write. ƒê∆°n gi·∫£n nh∆∞ng kh√¥ng optimize cho t·ª´ng use case.</p>

                        <h4>CQRS t√°ch bi·ªát</h4>
                        <ul>
                            <li><strong>Command Model:</strong> Optimized cho writes (normalized, constraints)</li>
                            <li><strong>Query Model:</strong> Optimized cho reads (denormalized, specific views)</li>
                            <li><strong>Sync:</strong> Command model ‚Üí events ‚Üí update query models</li>
                        </ul>

                        <h4>V√≠ d·ª•: E-commerce</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Command</th>
                                    <th>Query</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>orders table (normalized)</td>
                                    <td>order_summary_view (denormalized)</td>
                                </tr>
                                <tr>
                                    <td>Insert order</td>
                                    <td>Get order v·ªõi user info, products</td>
                                </tr>
                                <tr>
                                    <td>ACID constraints</td>
                                    <td>No joins, fast read</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Benefits</h4>
                        <ul>
                            <li>‚úÖ Optimize ri√™ng cho read v√† write</li>
                            <li>‚úÖ Scale read replicas independently</li>
                            <li>‚úÖ Different database technologies (Postgres + ElasticSearch)</li>
                        </ul>

                        <h4>Trade-offs</h4>
                        <ul>
                            <li>‚ùå Complexity tƒÉng</li>
                            <li>‚ùå Eventual consistency (lag gi·ªØa command v√† query)</li>
                            <li>‚ùå Sync logic c·∫ßn maintain</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Don't use CQRS everywhere:</strong> Ch·ªâ d√πng khi read/write patterns kh√°c bi·ªát l·ªõn, ho·∫∑c c·∫ßn scale reads independently
                        </div>

                        <span class="tag">CQRS</span>
                        <span class="tag">Architecture</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q48</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Backup Strategies - Full, Incremental, Point-in-Time?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>1. Full Backup</h4>
                        <ul>
                            <li>Copy to√†n b·ªô database</li>
                            <li>Restore nhanh nh·∫•t (ch·ªâ 1 file)</li>
                            <li>Backup l√¢u, t·ªën storage</li>
                            <li>Th∆∞·ªùng: Weekly</li>
                        </ul>

                        <h4>2. Incremental Backup</h4>
                        <ul>
                            <li>Ch·ªâ backup thay ƒë·ªïi t·ª´ l·∫ßn backup tr∆∞·ªõc</li>
                            <li>Nhanh h∆°n, √≠t space h∆°n</li>
                            <li>Restore ch·∫≠m (ph·∫£i apply nhi·ªÅu files)</li>
                            <li>Th∆∞·ªùng: Daily</li>
                        </ul>

                        <h4>3. Point-in-Time Recovery (PITR)</h4>
                        <ul>
                            <li>Full backup + WAL (Write-Ahead Log) li√™n t·ª•c</li>
                            <li>Restore ƒë·∫øn b·∫•t k·ª≥ th·ªù ƒëi·ªÉm n√†o</li>
                            <li>Ph·ª•c h·ªìi sau accidental DELETE</li>
                            <li>Th∆∞·ªùng: WAL archive li√™n t·ª•c</li>
                        </ul>

                        <h4>PostgreSQL Tools</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Tool</th>
                                    <th>Lo·∫°i</th>
                                    <th>Use case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>pg_dump</td>
                                    <td>Logical (SQL)</td>
                                    <td>Migration, partial backup</td>
                                </tr>
                                <tr>
                                    <td>pg_basebackup</td>
                                    <td>Physical</td>
                                    <td>Full backup, replication</td>
                                </tr>
                                <tr>
                                    <td>WAL archiving</td>
                                    <td>PITR</td>
                                    <td>Point-in-time recovery</td>
                                </tr>
                                <tr>
                                    <td>pgBackRest</td>
                                    <td>All-in-one</td>
                                    <td>Enterprise backup</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è 3-2-1 Rule:</strong> 3 copies, 2 different media, 1 offsite
                        </div>

                        <span class="tag">Backup</span>
                        <span class="tag">Disaster Recovery</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q49</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Materialized Views - khi n√†o d√πng v√† refresh th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>View vs Materialized View</h4>
                        <p><strong>View:</strong> Virtual table, query ch·∫°y m·ªói l·∫ßn access</p>
                        <p><strong>Materialized View:</strong> L∆∞u k·∫øt qu·∫£ physically, query t·ª´ stored data</p>

                        <h4>Khi n√†o d√πng?</h4>
                        <ul>
                            <li>Query ph·ª©c t·∫°p, ch·∫°y l√¢u (nhi·ªÅu JOIN, aggregation)</li>
                            <li>Data kh√¥ng c·∫ßn real-time</li>
                            <li>Read-heavy, write-rare</li>
                            <li>V√≠ d·ª•: Daily reports, dashboard data</li>
                        </ul>

                        <h4>Refresh Strategies</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Method</th>
                                    <th>C√°ch l√†m</th>
                                    <th>Trade-off</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>REFRESH MATERIALIZED VIEW</td>
                                    <td>Manual trigger</td>
                                    <td>Full rebuild, block reads</td>
                                </tr>
                                <tr>
                                    <td>REFRESH CONCURRENTLY</td>
                                    <td>Non-blocking refresh</td>
                                    <td>Ch·∫≠m h∆°n, c·∫ßn unique index</td>
                                </tr>
                                <tr>
                                    <td>Cron job</td>
                                    <td>Schedule refresh</td>
                                    <td>Periodic updates</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="info-box">
                            <strong>üí° PostgreSQL 9.4+:</strong> REFRESH CONCURRENTLY cho ph√©p refresh kh√¥ng block read queries
                        </div>

                        <span class="tag">Materialized Views</span>
                        <span class="tag">Performance</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q50</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Database Failover - automatic v√† manual?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Failover l√† g√¨?</h4>
                        <p>Khi Primary database down, chuy·ªÉn sang Standby l√†m Primary m·ªõi.</p>

                        <h4>Manual Failover</h4>
                        <ul>
                            <li>Admin quy·∫øt ƒë·ªãnh v√† th·ª±c hi·ªán promote standby</li>
                            <li>Control t·ªët h∆°n, tr√°nh false positives</li>
                            <li>Ch·∫≠m h∆°n (c·∫ßn ng∆∞·ªùi can thi·ªáp)</li>
                        </ul>

                        <h4>Automatic Failover</h4>
                        <ul>
                            <li>Tools: Patroni, repmgr, Stolon</li>
                            <li>Monitor detects failure ‚Üí t·ª± ƒë·ªông promote</li>
                            <li>Nhanh h∆°n (gi√¢y), nh∆∞ng risk split-brain</li>
                        </ul>

                        <h4>Split-Brain Problem</h4>
                        <p><strong>V·∫•n ƒë·ªÅ:</strong> C·∫£ 2 node ƒë·ªÅu nghƒ© m√¨nh l√† Primary ‚Üí data divergence</p>
                        <p><strong>Gi·∫£i ph√°p:</strong></p>
                        <ul>
                            <li>Quorum-based (Patroni + etcd/ZooKeeper)</li>
                            <li>STONITH (Shoot The Other Node In The Head)</li>
                            <li>Manual intervention khi unsure</li>
                        </ul>

                        <h4>Failover Checklist</h4>
                        <ol>
                            <li>X√°c ƒë·ªãnh Primary th·∫≠t s·ª± down (kh√¥ng ph·∫£i network partition)</li>
                            <li>Promote Standby l√™n Primary</li>
                            <li>Update connection strings (DNS, service discovery)</li>
                            <li>Verify replication sau failover</li>
                            <li>Investigate v√† fix old Primary</li>
                        </ol>

                        <span class="tag">Failover</span>
                        <span class="tag">High Availability</span>
                    </div>
                </div>
            </div>

                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q51</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        SELECT FOR UPDATE - khi n√†o d√πng v√† c·∫©n th·∫≠n g√¨?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Race condition</h4>
                        <p>2 transactions c√πng ƒë·ªçc balance = 100, c√πng update ‚Üí m·∫•t m·∫•t 1 update!</p>

                        <h4>SELECT FOR UPDATE gi·∫£i quy·∫øt</h4>
                        <p>Lock rows ngay khi SELECT, kh√¥ng cho transaction kh√°c s·ª≠a.</p>

                        <div class="code-block">BEGIN;
-- Lock row cho ƒë·∫øn khi COMMIT
SELECT balance FROM accounts WHERE id = 1 FOR UPDATE;
-- Transaction kh√°c mu·ªën SELECT FOR UPDATE ph·∫£i ƒë·ª£i
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
COMMIT;</div>

                        <h4>C√°c lo·∫°i row lock</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Lock</th>
                                    <th>M√¥ t·∫£</th>
                                    <th>Use case</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>FOR UPDATE</td>
                                    <td>Block read/write</td>
                                    <td>Update/delete s·∫Øp t·ªõi</td>
                                </tr>
                                <tr>
                                    <td>FOR SHARE</td>
                                    <td>Block write, cho read</td>
                                    <td>Prevent modification</td>
                                </tr>
                                <tr>
                                    <td>FOR NO KEY UPDATE</td>
                                    <td>Block kh√¥ng ph·∫£i key update</td>
                                    <td>Update non-key columns</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>C·∫©n th·∫≠n</h4>
                        <ul>
                            <li>‚ùå Lock l√¢u = block app kh√°c ‚Üí ng·∫Øn g·ªçn transaction</li>
                            <li>‚ùå Kh√¥ng c√≥ index = table lock ‚Üí ƒë·∫£m b·∫£o WHERE d√πng index</li>
                            <li>‚úÖ NOWAIT: Fail fast n·∫øu kh√¥ng lock ƒë∆∞·ª£c</li>
                        </ul>

                        <span class="tag">Locking</span>
                        <span class="tag">Concurrency</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q52</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Recursive CTE - x·ª≠ l√Ω hierarchical data?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Hierarchical Data</h4>
                        <p>Org chart, category tree, comment threads (parent-child relationships)</p>

                        <h4>V√≠ d·ª•: Category Tree</h4>
                        <div class="code-block">categories:
id | name      | parent_id
1  | Electronics | NULL
2  | Phones      | 1
3  | Laptops     | 1
4  | iPhone      | 2
5  | Samsung     | 2</div>

                        <h4>Recursive CTE</h4>
                        <div class="code-block">WITH RECURSIVE category_tree AS (
    -- Base case: root categories
    SELECT id, name, parent_id, 0 as depth
    FROM categories
    WHERE parent_id IS NULL
    
    UNION ALL
    
    -- Recursive: children
    SELECT c.id, c.name, c.parent_id, ct.depth + 1
    FROM categories c
    JOIN category_tree ct ON c.parent_id = ct.id
)
SELECT * FROM category_tree;</div>

                        <h4>K·∫øt qu·∫£</h4>
                        <div class="code-block">1, Electronics, NULL, 0
2, Phones, 1, 1
3, Laptops, 1, 1
4, iPhone, 2, 2
5, Samsung, 2, 2</div>

                        <div class="info-box">
                            <strong>üí° C·∫©n th·∫≠n:</strong> Recursive CTE c√≥ th·ªÉ infinite loop n·∫øu data c√≥ cycle. Th√™m MAXRECURSION ho·∫∑c cycle detection.
                        </div>

                        <span class="tag">CTE</span>
                        <span class="tag">Recursive</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q53</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Database Migration - zero-downtime strategy?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Expansion-Contrction Pattern</h4>
                        <p>Kh√¥ng l√†m breaking change 1 l√∫c, chia th√†nh nhi·ªÅu deploy.</p>

                        <h4>V√≠ d·ª•: Rename column</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Deploy</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1. Expand</td>
                                    <td>Th√™m new_column, write c·∫£ 2 columns</td>
                                </tr>
                                <tr>
                                    <td>2. Migrate</td>
                                    <td>Copy data c≈© ‚Üí m·ªõi (background)</td>
                                </tr>
                                <tr>
                                    <td>3. Switch</td>
                                    <td>Read t·ª´ new_column, write c·∫£ 2</td>
                                </tr>
                                <tr>
                                    <td>4. Contract</td>
                                    <td>X√≥a old_column</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Add Column v·ªõi Default</h4>
                        <ul>
                            <li>PostgreSQL 11+: ADD COLUMN DEFAULT kh√¥ng lock table</li>
                            <li>PostgreSQL < 11: ADD COLUMN (nullable) ‚Üí UPDATE (batch) ‚Üí ADD DEFAULT</li>
                        </ul>

                        <h4>Tools</h4>
                        <ul>
                            <li><strong>pt-online-schema-change:</strong> Percona toolkit cho MySQL</li>
                            <li><strong>pg-online-schema-change:</strong> T∆∞∆°ng t·ª± cho PostgreSQL</li>
                            <li><strong>Reshape:</strong> Schema migration tool</li>
                        </ul>

                        <span class="tag">Migration</span>
                        <span class="tag">Zero Downtime</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q54</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        TOAST - PostgreSQL x·ª≠ l√Ω large objects th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Row size limit</h4>
                        <p>PostgreSQL row t·ªëi ƒëa 8KB (1 page). L√†m sao l∆∞u TEXT l·ªõn, JSON l·ªõn?</p>

                        <h4>TOAST (The Oversized-Attribute Storage Technique)</h4>
                        <p>T·ª± ƒë·ªông compress v√† split large values:</p>
                        <ul>
                            <li>Data > 2KB ‚Üí Compress th·ª≠</li>
                            <li>V·∫´n > 2KB ‚Üí Split th√†nh chunks, l∆∞u ·ªü TOAST table</li>
                            <li>Main table ch·ªâ l∆∞u pointer (TOAST pointer)</li>
                        </ul>

                        <h4>Storage Strategies</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Strategy</th>
                                    <th>M√¥ t·∫£</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>EXTENDED (default)</td>
                                    <td>Compress + TOAST</td>
                                </tr>
                                <tr>
                                    <td>EXTERNAL</td>
                                    <td>TOAST nh∆∞ng kh√¥ng compress</td>
                                </tr>
                                <tr>
                                    <td>MAIN</td>
                                    <td>Compress nh∆∞ng c·ªë g·∫Øng kh√¥ng TOAST</td>
                                </tr>
                                <tr>
                                    <td>PLAIN</td>
                                    <td>Kh√¥ng TOAST, inline only</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Performance:</strong> Access TOASTed data ch·∫≠m h∆°n (extra lookup). C·ªôt th∆∞·ªùng access c√πng nhau n√™n ƒë·ªÉ c√πng storage strategy.
                        </div>

                        <span class="tag">TOAST</span>
                        <span class="tag">Internals</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q55</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Prepared Statements - l·ª£i √≠ch v√† khi n√†o d√πng?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Prepared Statement l√† g√¨?</h4>
                        <p>Parse + Plan query 1 l·∫ßn, execute nhi·ªÅu l·∫ßn v·ªõi different parameters.</p>

                        <div class="code-block">-- Prepare
PREPARE get_user (INT) AS
    SELECT * FROM users WHERE id = $1;

-- Execute nhi·ªÅu l·∫ßn
EXECUTE get_user(1);
EXECUTE get_user(2);
EXECUTE get_user(3);</div>

                        <h4>L·ª£i √≠ch</h4>
                        <ul>
                            <li>‚úÖ Tr√°nh parse overhead (query gi·ªëng nhau, params kh√°c)</li>
                            <li>‚úÖ Plan reuse (nh∆∞ng PostgreSQL c√≥ th·ªÉ replan)</li>
                            <li>‚úÖ Security: Ph√≤ng SQL injection (params separate)</li>
                        </ul>

                        <h4>Trade-offs</h4>
                        <ul>
                            <li>‚ùå Generic plan c√≥ th·ªÉ kh√¥ng t·ªëi ∆∞u (kh√¥ng bi·∫øt params)</li>
                            <li>‚ùå Memory usage (caching plans)</li>
                            <li>‚ùå Kh√¥ng d√πng ƒë∆∞·ª£c v·ªõi PgBouncer transaction pooling</li>
                        </ul>

                        <h4>Best Practice</h4>
                        <p>D√πng khi: Same query ch·∫°y > 5 l·∫ßn v·ªõi different params</p>

                        <span class="tag">Performance</span>
                        <span class="tag">Query Optimization</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q56</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Advisory Locks - lock t√πy ch·ªânh trong PostgreSQL?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>V·∫•n ƒë·ªÅ: Row lock kh√¥ng ƒë·ªß</h4>
                        <p>Mu·ªën lock logic (v√≠ d·ª•: "kh√¥ng cho x·ª≠ l√Ω payment cho user n√†y"), kh√¥ng li√™n quan ƒë·∫øn row c·ª• th·ªÉ.</p>

                        <h4>Advisory Locks</h4>
                        <p>Lock tr√™n application-level key (s·ªë ho·∫∑c string), kh√¥ng li√™n quan ƒë·∫øn table.</p>

                        <div class="code-block">-- Lock (blocking)
SELECT pg_advisory_lock(user_id);

-- Try lock (non-blocking)
SELECT pg_try_advisory_lock(user_id);

-- Unlock
SELECT pg_advisory_unlock(user_id);</div>

                        <h4>Use Cases</h4>
                        <ul>
                            <li><strong>Idempotency:</strong> ƒê·∫£m b·∫£o 1 operation ch·∫°y 1 l·∫ßn cho user</li>
                            <li><strong>Rate limiting:</strong> Gi·ªõi h·∫°n concurrent operations</li>
                            <li><strong>Background jobs:</strong> ƒê·∫£m b·∫£o job kh√¥ng ch·∫°y duplicate</li>
                        </ul>

                        <h4>So s√°nh v·ªõi Redis Lock</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>PostgreSQL Advisory</th>
                                    <th>Redis Redlock</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ƒê∆°n gi·∫£n (1 command)</td>
                                    <td>Complex implementation</td>
                                </tr>
                                <tr>
                                    <td>Transaction-scoped</td>
                                    <td>TTL-based</td>
                                </tr>
                                <tr>
                                    <td>Ch·ªâ d√πng khi c√≥ DB connection</td>
                                    <td>Independent service</td>
                                </tr>
                            </tbody>
                        </table>

                        <span class="tag">Advisory Locks</span>
                        <span class="tag">Concurrency</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q57</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        BRIN Index - khi n√†o t·ªët h∆°n B-Tree?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>BRIN (Block Range INdex)</h4>
                        <p>L∆∞u summary c·ªßa 1 block pages (min/max values), kh√¥ng l∆∞u t·ª´ng row.</p>

                        <h4>So s√°nh v·ªõi B-Tree</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>B-Tree</th>
                                    <th>BRIN</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Size</td>
                                    <td>L·ªõn (1 row = 1 entry)</td>
                                    <td>Nh·ªè (1 block = 1 entry)</td>
                                </tr>
                                <tr>
                                    <td>Accuracy</td>
                                    <td>Ch√≠nh x√°c</td>
                                    <td>X·∫•p x·ªâ (lossy)</td>
                                </tr>
                                <tr>
                                    <td>Query speed</td>
                                    <td>Nhanh</td>
                                    <td>Ch·∫≠m h∆°n (scan nhi·ªÅu blocks)</td>
                                </tr>
                                <tr>
                                    <td>Insert speed</td>
                                    <td>Ch·∫≠m h∆°n</td>
                                    <td>Nhanh (√≠t maintenance)</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Khi n√†o d√πng BRIN?</h4>
                        <ul>
                            <li>‚úÖ Very large table (h√†ng t·ª∑ rows)</li>
                            <li>‚úÖ Data c√≥ correlation v·ªõi physical order (time-series)</li>
                            <li>‚úÖ Range queries tr√™n timestamp</li>
                            <li>‚úÖ Storage space quan tr·ªçng</li>
                        </ul>

                        <h4>V√≠ d·ª•</h4>
                        <div class="code-block">-- Time-series data, 10B rows
CREATE INDEX idx_logs_time ON logs USING BRIN (created_at);

-- Index size: B-Tree = 20GB, BRIN = 10MB</div>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Y√™u c·∫ßu:</strong> Data ph·∫£i clustered theo BRIN column. N·∫øu kh√¥ng, BRIN kh√¥ng hi·ªáu qu·∫£.
                        </div>

                        <span class="tag">BRIN</span>
                        <span class="tag">Indexing</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q58</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Parallel Query Execution - khi n√†o PostgreSQL parallelize?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Parallel Query l√† g√¨?</h4>
                        <p>Chia query th√†nh nhi·ªÅu workers ch·∫°y song song, t·∫≠n d·ª•ng multi-core.</p>

                        <h4>Khi n√†o parallelize?</h4>
                        <ul>
                            <li>Sequential scan tr√™n large table</li>
                            <li>Bitmap heap scan</li>
                            <li>Nested loop joins</li>
                            <li>Hash joins (build hash table song song)</li>
                            <li>Aggregation (GROUP BY)</li>
                        </ul>

                        <h4>Settings</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Setting</th>
                                    <th>Default</th>
                                    <th>√ù nghƒ©a</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>max_parallel_workers_per_gather</td>
                                    <td>2</td>
                                    <td>Workers cho 1 query</td>
                                </tr>
                                <tr>
                                    <td>max_parallel_workers</td>
                                    <td>8</td>
                                    <td>Workers t·ªïng</td>
                                </tr>
                                <tr>
                                    <td>min_parallel_table_scan_size</td>
                                    <td>8MB</td>
                                    <td>Table l·ªõn h∆°n m·ªõi parallel</td>
                                </tr>
                                <tr>
                                    <td>parallel_tuple_cost</td>
                                    <td>0.1</td>
                                    <td>Chi ph√≠ transfer gi·ªØa workers</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Gi·ªõi h·∫°n</h4>
                        <ul>
                            <li>‚ùå Cursors kh√¥ng parallel</li>
                            <li>‚ùå Subqueries trong WHERE kh√¥ng parallel</li>
                            <li>‚ùå CTE kh√¥ng materialized kh√¥ng parallel</li>
                            <li>‚ùå Locking queries kh√¥ng parallel</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° PostgreSQL 9.6+:</strong> Parallel query support, improved in 10, 11, 12
                        </div>

                        <span class="tag">Parallel Query</span>
                        <span class="tag">Performance</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q59</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Synchronous vs Asynchronous Replication?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Asynchronous Replication (default)</h4>
                        <ul>
                            <li>Primary commit ‚Üí tr·∫£ v·ªÅ client ngay</li>
                            <li>WAL g·ª≠i sang standby sau</li>
                            <li>Nhanh h∆°n nh∆∞ng c√≥ lag</li>
                        </ul>

                        <h4>Synchronous Replication</h4>
                        <ul>
                            <li>Primary commit ‚Üí ƒë·ª£i standby confirm ‚Üí tr·∫£ v·ªÅ client</li>
                            <li>Kh√¥ng lag, nh∆∞ng ch·∫≠m h∆°n (network round-trip)</li>
                            <li>C√≥ th·ªÉ config s·ªë standby c·∫ßn confirm (synchronous_standby_names)</li>
                        </ul>

                        <h4>So s√°nh</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>Async</th>
                                    <th>Sync</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Write latency</td>
                                    <td>Th·∫•p</td>
                                    <td>Cao (+ network RTT)</td>
                                </tr>
                                <tr>
                                    <td>Data loss risk</td>
                                    <td>C√≥ (lag window)</td>
                                    <td>Kh√¥ng (0 RPO)</td>
                                </tr>
                                <tr>
                                    <td>Failover</td>
                                    <td>C√≥ th·ªÉ m·∫•t data</td>
                                    <td>Zero data loss</td>
                                </tr>
                                <tr>
                                    <td>Use case</td>
                                    <td>Read replicas</td>
                                    <td>Critical data</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Hybrid Approach</h4>
                        <p>synchronous_commit = 'remote_apply' ch·ªâ cho critical transactions:</p>
                        <div class="code-block">SET synchronous_commit = 'remote_apply';
BEGIN;
-- Critical payment transaction
COMMIT;
SET synchronous_commit = 'local'; -- Back to async</div>

                        <span class="tag">Replication</span>
                        <span class="tag">High Availability</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q60</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Database Capacity Planning - l√†m sao estimate?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>3 Dimensions</h4>
                        <ul>
                            <li><strong>Storage:</strong> Data size growth (MB/day)</li>
                            <li><strong>Compute:</strong> CPU, Memory (queries, connections)</li>
                            <li><strong>Throughput:</strong> IOPS, bandwidth (reads/writes per second)</li>
                        </ul>

                        <h4>Estimation Process</h4>
                        <ol>
                            <li><strong>Current metrics:</strong> Collect baseline (data size, QPS, latency)</li>
                            <li><strong>Growth rate:</strong> Historical growth (month over month)</li>
                            <li><strong>Project:</strong> Extrapolate 6-12 months</li>
                            <li><strong>Headroom:</strong> Add 50% buffer for spikes</li>
                        </ol>

                        <h4>Example Calculation</h4>
                        <div class="code-block">Current: 100GB, 1000 QPS
Growth: 10GB/month, +10% QPS/month

6 months projection:
- Storage: 100 + (10 √ó 6) = 160GB √ó 1.5 = 240GB
- QPS: 1000 √ó 1.1^6 = 1771 √ó 1.5 = 2656 QPS</div>

                        <h4>Scaling Triggers</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Metric</th>
                                    <th>Warning</th>
                                    <th>Critical</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Storage</td>
                                    <td>70%</td>
                                    <td>85%</td>
                                </tr>
                                <tr>
                                    <td>CPU</td>
                                    <td>70%</td>
                                    <td>85%</td>
                                </tr>
                                <tr>
                                    <td>Memory</td>
                                    <td>80%</td>
                                    <td>95%</td>
                                </tr>
                                <tr>
                                    <td>IOPS</td>
                                    <td>70%</td>
                                    <td>90%</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Planning Checklist</h4>
                        <ul>
                            <li>‚úÖ Hardware upgrade timeline (weeks/months)</li>
                            <li>‚úÖ Scaling strategy (vertical vs horizontal)</li>
                            <li>‚úÖ Cost estimation</li>
                            <li>‚úÖ Testing environment</li>
                            <li>‚úÖ Rollback plan</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° Rule of thumb:</strong> Plan cho 3x current capacity trong 12-18 th√°ng
                        </div>

                        <span class="tag">Capacity Planning</span>
                        <span class="tag">Scaling</span>
                    </div>
                </div>
            </div>

            <!-- End of Advanced Database Questions -->



        <!-- Kafka & Messaging -->

        <div class="category">
            <div class="category-header">
                <span class="category-icon">üì®</span>
                <h2 class="category-title">Kafka & Message Queue</h2>
                <span class="category-count">4</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q15</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Kafka Consumer Group - rebalancing issues v√† c√°ch fix?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Consumer Group Concept:</h4>
                        <p>Multiple consumers c√πng group ‚Üí m·ªói partition ch·ªâ assigned cho 1 consumer ‚Üí parallel processing</p>

                        <h4>Rebalancing Hell Problem:</h4>
                        <p><strong>Symptom:</strong> Consumer li√™n t·ª•c rebalance ‚Üí kh√¥ng process ƒë∆∞·ª£c messages</p>
                        <p><strong>Cause:</strong> Processing time > session.timeout ‚Üí broker thinks consumer dead ‚Üí rebalance</p>
                        <p><strong>Fix:</strong></p>
                        <ul>
                            <li>TƒÉng session.timeout (default 10s ‚Üí 5 ph√∫t)</li>
                            <li>TƒÉng max.poll.interval (default 5 ph√∫t ‚Üí 10 ph√∫t)</li>
                            <li>Gi·∫£m processing time (batch nh·ªè h∆°n, optimize logic)</li>
                        </ul>

                        <h4>Duplicate Processing:</h4>
                        <p><strong>Cause:</strong> Consumer process message nh∆∞ng ch∆∞a commit offset ‚Üí crash ‚Üí reprocess</p>
                        <p><strong>Solution:</strong> Idempotent consumer (check messageId before process)</p>

                        <h4>Consumer Lag:</h4>
                        <p><strong>Monitor:</strong> Offset lag = latest offset - consumer offset</p>
                        <p><strong>Fix lag:</strong></p>
                        <ul>
                            <li>Add more consumers (max = s·ªë partitions)</li>
                            <li>Optimize processing time</li>
                            <li>Increase partition count (n·∫øu c·∫ßn scale h∆°n n·ªØa)</li>
                        </ul>

                        <h4>Best Practices:</h4>
                        <ul>
                            <li>Consumers ‚â§ partitions (th·ª´a consumer = idle)</li>
                            <li>Enable auto-commit = false ‚Üí manual commit sau khi process xong</li>
                            <li>Handle exceptions gracefully (DLQ cho poison messages)</li>
                        </ul>

                        <span class="tag">Consumer Groups</span>
                        <span class="tag">Rebalancing</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q16</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Partition Strategy - ƒë·∫£m b·∫£o message ordering?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Ordering Guarantee:</h4>
                        <p><strong>‚úÖ Per partition:</strong> Messages trong c√πng partition ordered</p>
                        <p><strong>‚ùå Cross partition:</strong> Kh√¥ng c√≥ ordering guarantee</p>

                        <h4>Partition Key Strategy:</h4>
                        <p><strong>Use case:</strong> C·∫ßn order per userId ‚Üí partition key = userId</p>
                        <p>Same userId ‚Üí same partition ‚Üí ordered messages</p>

                        <h4>Partition Count Decision:</h4>
                        <p><strong>Formula:</strong> max(expected_consumers, throughput_target / consumer_throughput)</p>
                        <p><strong>Example:</strong></p>
                        <ul>
                            <li>Target: 10,000 msg/sec</li>
                            <li>Consumer speed: 1,000 msg/sec</li>
                            <li>Partitions needed: 10</li>
                        </ul>

                        <h4>Trade-offs:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Partitions</th>
                                    <th>Pros</th>
                                    <th>Cons</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Too few (1-5)</td>
                                    <td>Simple, strong ordering</td>
                                    <td>Limited parallelism, bottleneck</td>
                                </tr>
                                <tr>
                                    <td>Right amount</td>
                                    <td>Good parallelism, manageable</td>
                                    <td>Need to calculate properly</td>
                                </tr>
                                <tr>
                                    <td>Too many (100+)</td>
                                    <td>Max parallelism</td>
                                    <td>Rebalancing slow, overhead</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="info-box">
                            <strong>üí° Tip:</strong> Start with 10-20 partitions. Monitor lag. Scale n·∫øu c·∫ßn.
                        </div>

                        <span class="tag">Partitioning</span>
                        <span class="tag">Message Ordering</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q17</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Exactly-Once Semantics - c√≥ th·∫≠t s·ª± ƒë·∫°t ƒë∆∞·ª£c kh√¥ng?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>üéØ V·∫•n ƒë·ªÅ th·ª±c t·∫ø</h4>
                        <p>Khi g·ª≠i message qua network (Kafka, API call), c√≥ 3 kh·∫£ nƒÉng x·∫£y ra:</p>
                        <ul>
                            <li>Message b·ªã m·∫•t (kh√¥ng ƒë·∫øn n∆°i)</li>
                            <li>Message ƒë·∫øn 1 l·∫ßn (perfect!)</li>
                            <li>Message ƒë·∫øn 2+ l·∫ßn (duplicate)</li>
                        </ul>

                        <h4>üìä 3 M·ª©c ƒë·ªô b·∫£o ƒë·∫£m</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>M·ª©c ƒë·ªô</th>
                                    <th>Nghƒ©a l√†</th>
                                    <th>V√≠ d·ª• th·ª±c t·∫ø</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>At-most-once</strong></td>
                                    <td>C√≥ th·ªÉ m·∫•t, nh∆∞ng kh√¥ng duplicate</td>
                                    <td>G·ª≠i 1 l·∫ßn, kh√¥ng retry. N·∫øu fail = th√¥i</td>
                                </tr>
                                <tr>
                                    <td><strong>At-least-once</strong> ‚≠ê</td>
                                    <td>Kh√¥ng m·∫•t, nh∆∞ng c√≥ th·ªÉ duplicate</td>
                                    <td>Retry n·∫øu timeout. C√≥ th·ªÉ x·ª≠ l√Ω 2 l·∫ßn</td>
                                </tr>
                                <tr>
                                    <td><strong>Exactly-once</strong></td>
                                    <td>Kh√¥ng m·∫•t, kh√¥ng duplicate</td>
                                    <td>L√Ω t∆∞·ªüng nh∆∞ng <strong>kh√≥ ƒë·∫°t ƒë∆∞·ª£c!</strong></td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>üí≥ V√≠ d·ª•: Thanh to√°n</h4>
                        <div class="info-box">
                            <strong>At-most-once:</strong> User b·∫•m Pay ‚Üí ti·ªÅn kh√¥ng b·ªã tr·ª´ ‚Üí Kh√°ch h√†ng b·ª±c m√¨nh<br><br>
                            <strong>At-least-once:</strong> User b·∫•m Pay ‚Üí ti·ªÅn b·ªã tr·ª´ 2 l·∫ßn ‚Üí Kh√°ch h√†ng ki·ªán!<br><br>
                            <strong>Exactly-once:</strong> User b·∫•m Pay ‚Üí ti·ªÅn b·ªã tr·ª´ ƒë√∫ng 1 l·∫ßn ‚Üí Perfect!
                        </div>

                        <h4>ü§î C√≥ th·∫≠t s·ª± ƒë·∫°t ƒë∆∞·ª£c Exactly-Once kh√¥ng?</h4>
                        <p><strong>Tr·∫£ l·ªùri ng·∫Øn g·ªçn:</strong> Trong l√Ω thuy·∫øt <strong>KH√îNG</strong>, trong th·ª±c t·∫ø <strong>T∆Ø∆†NG ƒê·ªêI ƒê∆Ø·ª¢C</strong></p>

                        <p><strong>T·∫°i sao kh√¥ng 100%?</strong></p>
                        <ul>
                            <li>Network c√≥ th·ªÉ fail b·∫•t c·ª© l√∫c n√†o</li>
                            <li>Kh√¥ng bi·∫øt message ƒë√£ ƒë·∫øn ch∆∞a (timeout ambiguity)</li>
                            <li>End-to-end: Kafka ‚Üí DB ‚Üí External API = qu√° nhi·ªÅu ch·ªó fail</li>
                        </ul>

                        <h4>‚úÖ Gi·∫£i ph√°p th·ª±c t·∫ø: Idempotent Consumer</h4>
                        <p>Thay v√¨ c·ªë g·∫Øng ƒë·∫£m b·∫£o "exactly-once", h√£y l√†m cho operation <strong>idempotent</strong>:</p>
                        <p><em>"X·ª≠ l√Ω 1 l·∫ßn hay 2 l·∫ßn c≈©ng cho k·∫øt qu·∫£ nh∆∞ nhau"</em></p>

                        <p><strong>C√°ch l√†m:</strong></p>
                        <ul>
                            <li><strong>Step 1:</strong> L∆∞u messageId v√†o DB v·ªõi unique constraint</li>
                            <li><strong>Step 2:</strong> N·∫øu messageId ƒë√£ t·ªìn t·∫°i ‚Üí b·ªè qua (ƒë√£ x·ª≠ l√Ω r·ªìi)</li>
                            <li><strong>Step 3:</strong> N·∫øu ch∆∞a t·ªìn t·∫°i ‚Üí x·ª≠ l√Ω business logic</li>
                        </ul>

                        <h4>üîí C√°c l·ªõp b·∫£o v·ªá (Defense in Depth)</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>L·ªõp</th>
                                    <th>C√°ch l√†m</th>
                                    <th>Hi·ªáu qu·∫£</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1. Kafka Producer</td>
                                    <td>enable.idempotence = true</td>
                                    <td>Tr√°nh duplicate do retry</td>
                                </tr>
                                <tr>
                                    <td>2. Consumer Check</td>
                                    <td>Redis cache messageId 24h</td>
                                    <td>Nhanh, nh∆∞ng cache c√≥ th·ªÉ miss</td>
                                </tr>
                                <tr>
                                    <td>3. Database</td>
                                    <td>UNIQUE constraint messageId</td>
                                    <td>Ch·∫Øc ch·∫Øn nh·∫•t (last line of defense)</td>
                                </tr>
                                <tr>
                                    <td>4. Gateway</td>
                                    <td>Idempotency key khi g·ªçi external API</td>
                                    <td>Tr√°nh duplicate ·ªü b√™n ngo√†i</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>üí° T√≥m l·∫°i:</strong><br>
                            ‚Ä¢ ƒê·ª´ng c·ªë ƒë·∫°t "exactly-once" ho√†n h·∫£o (impossible)<br>
                            ‚Ä¢ H√£y l√†m cho operations <strong>idempotent</strong> (x·ª≠ l√Ω N l·∫ßn c≈©ng OK)<br>
                            ‚Ä¢ D√πng nhi·ªÅu l·ªõp b·∫£o v·ªá (Defense in Depth)
                        </div>

                        <span class="tag">Exactly-Once</span>
                        <span class="tag">Idempotency</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q18</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Dead Letter Queue pattern - khi n√†o c·∫ßn?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Khi n√†o c·∫ßn DLQ:</h4>
                        <ul>
                            <li>Message processing fail sau max retries</li>
                            <li>Poison messages (malformed data)</li>
                            <li>Business validation failures</li>
                            <li>Kh√¥ng mu·ªën block queue v√¨ bad messages</li>
                        </ul>

                        <h4>Pattern:</h4>
                        <p><strong>1. Process message</strong></p>
                        <p><strong>2. If fail:</strong> Retry v·ªõi backoff (3 l·∫ßn)</p>
                        <p><strong>3. Still fail:</strong> Send to DLQ topic</p>
                        <p><strong>4. Alert team</strong></p>
                        <p><strong>5. Manual review & retry</strong></p>

                        <h4>DLQ Message Format:</h4>
                        <div class="code-block">{
  originalMessage: {...},
  error: {
    message: "...",
    stack: "..."
  },
  metadata: {
    topic: "payment.process",
    partition: 5,
    offset: 12345,
    retryCount: 3
  },
  timestamp: "2024-01-15T10:30:00Z"
}</div>

                        <h4>DLQ Operations:</h4>
                        <ul>
                            <li><strong>Monitor:</strong> Alert n·∫øu DLQ > threshold</li>
                            <li><strong>Review:</strong> Admin dashboard ƒë·ªÉ xem DLQ messages</li>
                            <li><strong>Retry:</strong> Fix issue ‚Üí replay message t·ª´ DLQ</li>
                            <li><strong>Discard:</strong> N·∫øu message truly invalid</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° Best Practice:</strong> C√≥ separate DLQ per topic (payment.dlq, notification.dlq) ƒë·ªÉ d·ªÖ manage
                        </div>

                        <span class="tag">DLQ</span>
                        <span class="tag">Error Handling</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Design -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üéØ</span>
                <h2 class="category-title">System Design</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q19</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Scale ƒë·∫øn 10,000 TPS - approach nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Requirements Breakdown:</h4>
                        <ul>
                            <li><strong>Throughput:</strong> 10,000 TPS = 600,000 requests/ph√∫t</li>
                            <li><strong>Latency:</strong> P99 < 500ms</li>
                            <li><strong>Availability:</strong> 99.99% (52 ph√∫t downtime/nƒÉm)</li>
                        </ul>

                        <h4>Horizontal Scaling:</h4>
                        <p><strong>Application Layer:</strong></p>
                        <ul>
                            <li>M·ªói pod handle ~300-500 RPS</li>
                            <li>10,000 / 350 = ~30 pods minimum</li>
                            <li>Add 20% buffer = 35-40 pods</li>
                            <li>Auto-scaling based on CPU (70%) & RPS metrics</li>
                        </ul>

                        <h4>Database Layer:</h4>
                        <ul>
                            <li><strong>Reads:</strong> Primary + 3-5 read replicas</li>
                            <li><strong>Writes:</strong> Shard n·∫øu single primary kh√¥ng handle (th∆∞·ªùng ·ªïn ƒë·∫øn 5K TPS)</li>
                            <li><strong>Connection pool:</strong> PgBouncer ƒë·ªÉ reuse connections</li>
                        </ul>

                        <h4>Caching Strategy:</h4>
                        <ul>
                            <li><strong>Redis Cluster:</strong> User sessions, frequent queries</li>
                            <li><strong>Cache hit ratio:</strong> Target 80%+ ‚Üí gi·∫£m DB load significantly</li>
                            <li><strong>TTL:</strong> 5-15 ph√∫t cho dynamic data</li>
                        </ul>

                        <h4>Async Processing:</h4>
                        <ul>
                            <li><strong>Kafka:</strong> Offload long tasks (20+ partitions)</li>
                            <li><strong>Workers:</strong> Separate t·ª´ API pods</li>
                            <li><strong>Priority queues:</strong> Critical vs normal tasks</li>
                        </ul>

                        <h4>Monitoring:</h4>
                        <ul>
                            <li>Metrics: Latency (P50/P95/P99), error rate, saturation</li>
                            <li>Alerts: P99 > 500ms, error rate > 1%, CPU > 80%</li>
                            <li>Distributed tracing: Identify bottlenecks</li>
                        </ul>

                        <span class="tag">Horizontal Scaling</span>
                        <span class="tag">High Availability</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q20</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        CAP Theorem - real examples v√† trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>CAP Basics:</h4>
                        <ul>
                            <li><strong>C (Consistency):</strong> M·ªçi read th·∫•y latest write</li>
                            <li><strong>A (Availability):</strong> M·ªçi request nh·∫≠n response</li>
                            <li><strong>P (Partition Tolerance):</strong> Ho·∫°t ƒë·ªông khi network b·ªã chia c·∫Øt</li>
                        </ul>
                        <p><strong>Reality:</strong> Ch·ªâ ch·ªçn ƒë∆∞·ª£c 2/3. Trong distributed system, P l√† b·∫Øt bu·ªôc ‚Üí ch·ªçn CP ho·∫∑c AP</p>

                        <h4>CP Systems (Consistency + Partition Tolerance):</h4>
                        <p><strong>Behavior:</strong> Reject writes khi partition ƒë·ªÉ maintain consistency</p>
                        <p><strong>Examples:</strong> MongoDB (default), HBase, etcd, ZooKeeper</p>
                        <p><strong>Use when:</strong> Financial transactions, inventory management (kh√¥ng th·ªÉ oversell)</p>

                        <h4>AP Systems (Availability + Partition Tolerance):</h4>
                        <p><strong>Behavior:</strong> Accept writes tr√™n c·∫£ 2 sides c·ªßa partition ‚Üí resolve conflicts sau</p>
                        <p><strong>Examples:</strong> Cassandra, DynamoDB, Riak</p>
                        <p><strong>Use when:</strong> Social features, analytics, logs (eventual consistency OK)</p>

                        <h4>Real Scenarios:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Use Case</th>
                                    <th>Choice</th>
                                    <th>Why</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Payment processing</td>
                                    <td>CP</td>
                                    <td>Cannot charge twice!</td>
                                </tr>
                                <tr>
                                    <td>Loyalty points</td>
                                    <td>AP</td>
                                    <td>Temporary inconsistency OK</td>
                                </tr>
                                <tr>
                                    <td>Inventory</td>
                                    <td>CP</td>
                                    <td>Prevent overselling</td>
                                </tr>
                                <tr>
                                    <td>User preferences</td>
                                    <td>AP</td>
                                    <td>Availability > exact sync</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Reality:</strong> CAP l√† simplified model. Real systems c√≥ gradations (tunable consistency levels).
                        </div>

                        <span class="tag">CAP Theorem</span>
                        <span class="tag">Distributed Systems</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q21</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Caching strategies - when v√† how?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Cache Patterns:</h4>
                        
                        <p><strong>1. Cache-Aside (Lazy Loading):</strong></p>
                        <ul>
                            <li>Check cache ‚Üí hit: return | miss: query DB ‚Üí cache it ‚Üí return</li>
                            <li>Pros: Only cache what's needed</li>
                            <li>Cons: Cache miss penalty, stale data</li>
                        </ul>

                        <p><strong>2. Write-Through:</strong></p>
                        <ul>
                            <li>Write DB + cache simultaneously</li>
                            <li>Pros: Cache always fresh</li>
                            <li>Cons: Write latency higher, unnecessary caching</li>
                        </ul>

                        <p><strong>3. Write-Behind:</strong></p>
                        <ul>
                            <li>Write cache ‚Üí async flush to DB</li>
                            <li>Pros: Fast writes</li>
                            <li>Cons: Data loss risk if cache crashes</li>
                        </ul>

                        <h4>What to Cache:</h4>
                        <ul>
                            <li><strong>User sessions:</strong> Redis, TTL = session length</li>
                            <li><strong>API responses:</strong> Frequent queries, TTL = 5-15 min</li>
                            <li><strong>Database queries:</strong> Expensive joins, TTL = 5-60 min</li>
                            <li><strong>Static content:</strong> CDN, long TTL</li>
                        </ul>

                        <h4>Cache Invalidation:</h4>
                        <p><strong>Hardest problem in CS!</strong></p>
                        <ul>
                            <li><strong>TTL-based:</strong> Simple, c√≥ th·ªÉ serve stale data</li>
                            <li><strong>Event-based:</strong> Invalidate khi data change (complex)</li>
                            <li><strong>Version-based:</strong> Key includes version (cache:user:123:v5)</li>
                        </ul>

                        <h4>Anti-patterns:</h4>
                        <ul>
                            <li>‚ùå Cache everything ‚Üí memory waste</li>
                            <li>‚ùå No TTL ‚Üí stale forever</li>
                            <li>‚ùå Cache frequently changing data</li>
                            <li>‚ùå No cache size limit ‚Üí OOM</li>
                        </ul>

                        <span class="tag">Redis</span>
                        <span class="tag">Caching</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- DevOps -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üöÄ</span>
                <h2 class="category-title">DevOps & Deployment</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q22</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        GitHub Actions optimization - 3+ ph√∫t xu·ªëng <1 ph√∫t?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Optimization Strategies:</h4>
                        
                        <p><strong>1. Parallel Jobs:</strong></p>
                        <p>Lint, test, build ch·∫°y parallel thay v√¨ sequential ‚Üí save 50%+ time</p>

                        <p><strong>2. Dependency Caching:</strong></p>
                        <ul>
                            <li>Cache node_modules (key: package-lock.json hash)</li>
                            <li>Save 30-40s m·ªói run</li>
                            <li>Hit rate >90% n·∫øu dependencies √≠t thay ƒë·ªïi</li>
                        </ul>

                        <p><strong>3. Docker Layer Caching:</strong></p>
                        <ul>
                            <li>BuildKit cache (cache-from/cache-to type=gha)</li>
                            <li>Optimize Dockerfile layer order (dependencies tr∆∞·ªõc source)</li>
                            <li>Save 1-2 ph√∫t build time</li>
                        </ul>

                        <p><strong>4. Selective Testing:</strong></p>
                        <ul>
                            <li>Only run tests for changed files</li>
                            <li>Skip E2E n·∫øu ch·ªâ update README</li>
                        </ul>

                        <p><strong>5. Matrix Strategy:</strong></p>
                        <p>Build multiple services simultaneously trong monorepo</p>

                        <h4>Results:</h4>
                        <ul>
                            <li>npm install: 2 min ‚Üí 20s (caching)</li>
                            <li>Tests: 1 min ‚Üí 15s (parallel + selective)</li>
                            <li>Docker build: 1.5 min ‚Üí 30s (layer caching)</li>
                            <li><strong>Total: 3+ min ‚Üí ~50s</strong></li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° Measure first:</strong> Enable timing logs ƒë·ªÉ bi·∫øt bottleneck ·ªü ƒë√¢u tr∆∞·ªõc khi optimize
                        </div>

                        <span class="tag">CI/CD</span>
                        <span class="tag">GitHub Actions</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q23</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        K8s deployment strategies - Blue-Green vs Rolling vs Canary?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Rolling Update (Default):</h4>
                        <p><strong>How:</strong> Gradually replace old pods with new (maxSurge=1, maxUnavailable=1)</p>
                        <p><strong>Pros:</strong> Zero downtime, simple, auto rollback</p>
                        <p><strong>Cons:</strong> C·∫£ 2 versions ch·∫°y ƒë·ªìng th·ªùi, rollback ch·∫≠m</p>
                        <p><strong>Use:</strong> Most deployments</p>

                        <h4>Blue-Green:</h4>
                        <p><strong>How:</strong> Deploy full new version (green) ‚Üí test ‚Üí switch traffic ‚Üí kill old (blue)</p>
                        <p><strong>Pros:</strong> Instant rollback (switch back), full testing tr∆∞·ªõc khi switch</p>
                        <p><strong>Cons:</strong> 2x resources, to√†n b·ªô traffic chuy·ªÉn m·ªôt l√∫c</p>
                        <p><strong>Use:</strong> Critical updates, database migrations</p>

                        <h4>Canary:</h4>
                        <p><strong>How:</strong> 10% traffic ‚Üí new version ‚Üí monitor ‚Üí 50% ‚Üí 100%</p>
                        <p><strong>Pros:</strong> Test v·ªõi real traffic nh·ªè, ph√°t hi·ªán issues s·ªõm, gradual rollout</p>
                        <p><strong>Cons:</strong> Complex setup (Istio/Flagger), longer deploy time</p>
                        <p><strong>Use:</strong> High-risk changes, user-facing features</p>

                        <h4>Comparison:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Strategy</th>
                                    <th>Downtime</th>
                                    <th>Resources</th>
                                    <th>Rollback Speed</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Rolling</td>
                                    <td>Zero</td>
                                    <td>+1 pod</td>
                                    <td>Minutes</td>
                                </tr>
                                <tr>
                                    <td>Blue-Green</td>
                                    <td>Zero</td>
                                    <td>2x</td>
                                    <td>Instant</td>
                                </tr>
                                <tr>
                                    <td>Canary</td>
                                    <td>Zero</td>
                                    <td>~1.2x</td>
                                    <td>Fast</td>
                                </tr>
                            </tbody>
                        </table>

                        <span class="tag">Kubernetes</span>
                        <span class="tag">Deployment</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q24</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Zero-downtime deployment - ƒë·∫£m b·∫£o nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Key Requirements:</h4>
                        
                        <p><strong>1. Health Checks:</strong></p>
                        <ul>
                            <li>Readiness probe: K8s ch·ªâ route khi pod ready</li>
                            <li>Liveness probe: Kill pod n·∫øu unhealthy</li>
                            <li>Startup probe: Give time to start (DB connections, cache warming)</li>
                        </ul>

                        <p><strong>2. Graceful Shutdown:</strong></p>
                        <ul>
                            <li>Stop health check ‚Üí wait 5-10s ‚Üí stop accepting requests ‚Üí finish in-flight ‚Üí shutdown</li>
                            <li>terminationGracePeriodSeconds: 60s minimum</li>
                        </ul>

                        <p><strong>3. Rolling Update Settings:</strong></p>
                        <ul>
                            <li>maxSurge: 1 (c√≥ th·ªÉ tƒÉng n·∫øu resources cho ph√©p)</li>
                            <li>maxUnavailable: 0 (never below desired replicas)</li>
                        </ul>

                        <p><strong>4. Database Migrations:</strong></p>
                        <ul>
                            <li>Backward compatible migrations (add column v·ªõi default)</li>
                            <li>Run migration tr∆∞·ªõc deploy (separate job)</li>
                            <li>Two-phase deploy n·∫øu breaking change</li>
                        </ul>

                        <h4>Testing:</h4>
                        <ul>
                            <li>Load test during deploy ‚Üí no 502s, no dropped requests</li>
                            <li>Monitor error rate spike</li>
                            <li>Chaos engineering (kill random pods)</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Common Issue:</strong> Kh√¥ng wait cho load balancer update ‚Üí new pod nh·∫≠n traffic tr∆∞·ªõc khi ready
                        </div>

                        <span class="tag">Zero Downtime</span>
                        <span class="tag">Health Checks</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Observability & Troubleshooting -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üî≠</span>
                <h2 class="category-title">Observability & Troubleshooting</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q25</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        API ch·∫≠m ƒë·ªôt ng·ªôt - debug approach nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Systematic Approach:</h4>
                        
                        <p><strong>1. Define "ch·∫≠m":</strong></p>
                        <ul>
                            <li>Normal: P99 = 200ms ‚Üí Now: P99 = 3000ms</li>
                            <li>When started: T·ª´ 10 AM h√¥m nay</li>
                            <li>Affected endpoints: All ho·∫∑c specific?</li>
                        </ul>

                        <p><strong>2. Check Recent Changes:</strong></p>
                        <ul>
                            <li>Deploy m·ªõi? (git log, CI/CD history)</li>
                            <li>Config change? (feature flags, environment variables)</li>
                            <li>Traffic spike? (monitoring dashboard)</li>
                        </ul>

                        <p><strong>3. Layer-by-Layer:</strong></p>
                        <p><strong>Application:</strong></p>
                        <ul>
                            <li>Check logs: Exceptions? Warnings?</li>
                            <li>APM traces: Which function slow?</li>
                            <li>CPU/Memory: Maxed out?</li>
                        </ul>

                        <p><strong>Database:</strong></p>
                        <ul>
                            <li>Slow query log: Missing indexes?</li>
                            <li>Connection pool: Exhausted?</li>
                            <li>Lock contention: pg_stat_activity</li>
                        </ul>

                        <p><strong>External Services:</strong></p>
                        <ul>
                            <li>Gateway timeout? Check circuit breaker</li>
                            <li>Rate limited? Check API quotas</li>
                        </ul>

                        <p><strong>Infrastructure:</strong></p>
                        <ul>
                            <li>Network latency spike?</li>
                            <li>Disk I/O bottleneck?</li>
                        </ul>

                        <h4>Common Culprits:</h4>
                        <ul>
                            <li>Missing database index (query plan changed)</li>
                            <li>Connection pool exhausted</li>
                            <li>Memory leak ‚Üí GC thrashing</li>
                            <li>External service degradation</li>
                            <li>N+1 query introduced</li>
                        </ul>

                        <span class="tag">Debugging</span>
                        <span class="tag">Performance</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q26</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Distributed system debugging - trace request qua nhi·ªÅu services?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Challenges:</h4>
                        <ul>
                            <li>Request touch 5-10 services</li>
                            <li>Logs scattered across services</li>
                            <li>No single source of truth</li>
                            <li>Async processing (Kafka)</li>
                        </ul>

                        <h4>Solution Stack:</h4>
                        <p><strong>1. Correlation ID:</strong></p>
                        <ul>
                            <li>Generate UUID at API Gateway</li>
                            <li>Pass via X-Correlation-ID header (HTTP) ho·∫∑c message header (Kafka)</li>
                            <li>Log m·ªçi operation v·ªõi correlationId</li>
                            <li>Search logs: grep correlationId ‚Üí see full flow</li>
                        </ul>

                        <p><strong>2. Distributed Tracing:</strong></p>
                        <ul>
                            <li>OpenTelemetry auto-instrumentation</li>
                            <li>Visualize v·ªõi Jaeger/Zipkin</li>
                            <li>See latency per service, dependencies</li>
                        </ul>

                        <p><strong>3. Centralized Logging:</strong></p>
                        <ul>
                            <li>ELK stack (Elasticsearch, Logstash, Kibana)</li>
                            <li>Query all services at once</li>
                            <li>Filter by correlationId, userId, error level</li>
                        </ul>

                        <h4>Debug Flow Example:</h4>
                        <p><strong>Issue:</strong> Payment failed, user says "charged but no confirmation"</p>
                        <ul>
                            <li>Get correlationId t·ª´ user request</li>
                            <li>Search Jaeger: API ‚Üí Payment ‚Üí Gateway ‚Üí DB</li>
                            <li>See: Gateway returned 200, DB save failed</li>
                            <li>Check logs: Unique constraint violation</li>
                            <li>Root cause: Duplicate request, idempotency check missed</li>
                        </ul>

                        <span class="tag">Distributed Tracing</span>
                        <span class="tag">Correlation ID</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q27</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Production monitoring - metrics quan tr·ªçng c·∫ßn track?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Golden Signals (Google SRE):</h4>
                        
                        <p><strong>1. Latency:</strong></p>
                        <ul>
                            <li>P50, P95, P99 response time</li>
                            <li>Alert: P99 > 500ms</li>
                        </ul>

                        <p><strong>2. Traffic:</strong></p>
                        <ul>
                            <li>Requests per second</li>
                            <li>Alert: 50% drop ho·∫∑c sudden spike</li>
                        </ul>

                        <p><strong>3. Errors:</strong></p>
                        <ul>
                            <li>Error rate (%)</li>
                            <li>Alert: > 1% error rate</li>
                        </ul>

                        <p><strong>4. Saturation:</strong></p>
                        <ul>
                            <li>CPU, memory, disk, connection pool</li>
                            <li>Alert: > 80% usage</li>
                        </ul>

                        <h4>Application Metrics:</h4>
                        <ul>
                            <li><strong>Business metrics:</strong> Payments/hour, conversion rate</li>
                            <li><strong>Database:</strong> Query time, connection pool usage, deadlocks</li>
                            <li><strong>Cache:</strong> Hit ratio, eviction rate</li>
                            <li><strong>Queue:</strong> Message lag, processing time, DLQ size</li>
                        </ul>

                        <h4>Alerting Strategy:</h4>
                        <ul>
                            <li><strong>P0 (wake up):</strong> Complete outage, payment processing down</li>
                            <li><strong>P1 (urgent):</strong> Degraded performance, error rate spike</li>
                            <li><strong>P2 (business hours):</strong> High lag, cache misses</li>
                        </ul>

                        <h4>Dashboard Essentials:</h4>
                        <ul>
                            <li>Real-time: RPS, latency, errors</li>
                            <li>Resources: CPU, memory per service</li>
                            <li>Dependencies: External API status</li>
                            <li>Business: Revenue/hour, active users</li>
                        </ul>

                        <span class="tag">Monitoring</span>
                        <span class="tag">Metrics</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Behavioral -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üí¨</span>
                <h2 class="category-title">Behavioral Questions</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q28</span>
                        <span class="difficulty difficulty-easy">Easy</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Challenging technical problem - STAR method
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Situation:</h4>
                        <p>Kafka consumer group conflicts causing duplicate payment processing. Kh√°ch h√†ng b·ªã charge 2 l·∫ßn.</p>

                        <h4>Task:</h4>
                        <p>Fix duplicate processing, ensure message delivery guarantees, maintain performance d∆∞·ªõi high load.</p>

                        <h4>Action:</h4>
                        <ul>
                            <li>Analyzed logs ‚Üí discovered rebalancing causing partition re-assignment</li>
                            <li>Implemented idempotency keys v·ªõi Redis distributed locks</li>
                            <li>Added DB unique constraint tr√™n (idempotency_key)</li>
                            <li>Fixed Kafka settings (session.timeout, heartbeat.interval)</li>
                            <li>Graceful shutdown hooks ƒë·ªÉ commit offsets properly</li>
                            <li>Monitoring & alerts cho duplicate attempts</li>
                        </ul>

                        <h4>Result:</h4>
                        <ul>
                            <li>Zero duplicate payments (3+ months)</li>
                            <li>Reliability: 99.5% ‚Üí 99.95%</li>
                            <li>Customer complaints gi·∫£m 80%</li>
                            <li>Documentation cho team v·ªÅ best practices</li>
                        </ul>

                        <span class="tag">STAR Method</span>
                        <span class="tag">Problem Solving</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q29</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Speed vs Quality trade-off - example?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Situation:</h4>
                        <p>Banking integration c√≥ tight deadline - 2 tu·∫ßn cho marketing campaign. Testing ƒë·∫ßy ƒë·ªß c·∫ßn 3+ tu·∫ßn.</p>

                        <h4>Decision:</h4>
                        <p><strong>Phase 1 (Week 1-2):</strong></p>
                        <ul>
                            <li>Core payment flow v·ªõi thorough testing</li>
                            <li>Basic monitoring & error handling</li>
                            <li>Feature flags cho quick disable</li>
                            <li>Beta launch v·ªõi 100 users</li>
                        </ul>

                        <p><strong>Deferred to v2:</strong></p>
                        <ul>
                            <li>Advanced loyalty features</li>
                            <li>Performance optimizations</li>
                            <li>Edge case handling</li>
                        </ul>

                        <h4>Risk Mitigation:</h4>
                        <ul>
                            <li>Comprehensive monitoring t·ª´ day 1</li>
                            <li>Manual approval cho transactions > 10M</li>
                            <li>24/7 on-call rotation</li>
                            <li>Rollback plan ready (feature flag)</li>
                        </ul>

                        <h4>Outcome:</h4>
                        <ul>
                            <li>Met deadline, campaign launched th√†nh c√¥ng</li>
                            <li>Zero critical issues trong beta</li>
                            <li>Gradual rollout ƒë·∫øn 100% users (2 weeks)</li>
                            <li>v2 delivered sau 1 th√°ng</li>
                        </ul>

                        <h4>Lesson:</h4>
                        <p>Speed vs Quality kh√¥ng ph·∫£i all-or-nothing. V·ªõi proper risk management, feature flags, monitoring ‚Üí ship faster while maintaining acceptable quality. Key l√† bi·∫øt corners n√†o cut ƒë∆∞·ª£c (nice-to-have) vs kh√¥ng ƒë∆∞·ª£c (security, data integrity).</p>

                        <span class="tag">Trade-offs</span>
                        <span class="tag">Risk Management</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q30</span>
                        <span class="difficulty difficulty-easy">Easy</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        How do you stay updated v·ªõi tech trends?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Daily Learning:</h4>
                        <ul>
                            <li><strong>Reading:</strong> Dev.to, Medium, Hacker News</li>
                            <li><strong>Documentation:</strong> NestJS, PostgreSQL, Kafka official docs</li>
                            <li><strong>Tech Twitter:</strong> Follow industry leaders</li>
                        </ul>

                        <h4>Hands-on Experimentation:</h4>
                        <ul>
                            <li>Tested AI tools (GitHub Copilot, Claude, Cursor)</li>
                            <li>Researched Playwright Test Agents cho automated testing</li>
                            <li>Explored MCP servers cho AI integration</li>
                            <li>Evaluated PostgreSQL 17 upgrade benefits</li>
                        </ul>

                        <h4>Knowledge Sharing:</h4>
                        <ul>
                            <li>Internal wiki documentation</li>
                            <li>Tech talks v·ªõi team</li>
                            <li>Mentor junior developers</li>
                            <li>Detailed Jira tasks v·ªõi context</li>
                        </ul>

                        <h4>Recent Focus:</h4>
                        <ul>
                            <li>AI-powered development tools</li>
                            <li>Platform engineering trends</li>
                            <li>DevSecOps practices</li>
                            <li>Database optimization techniques</li>
                        </ul>

                        <span class="tag">Continuous Learning</span>
                        <span class="tag">Knowledge Sharing</span>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="footer">
        <p>üíº Ch√∫c b·∫°n ph·ªèng v·∫•n th√†nh c√¥ng!</p>
        <p>üìß dongtranthienio@gmail.com | üì± +84 767 692 595</p>
        <p style="margin-top: 1rem; opacity: 0.8; font-size: 0.85rem;">
            Focus on concepts, trade-offs, and real-world decision making!
        </p>
    </div>

    <button class="fab" id="closeAllFab" onclick="toggleAll(false)" title="ƒê√≥ng t·∫•t c·∫£">
        ‚úï
    </button>

    <script>
        function toggleCard(card) {
            card.classList.toggle('active');
            updateFabVisibility();
        }

        function toggleAll(show) {
            const cards = document.querySelectorAll('.question-card');
            cards.forEach(card => {
                if (show) {
                    card.classList.add('active');
                } else {
                    card.classList.remove('active');
                }
            });
            updateFabVisibility();
        }

        function updateFabVisibility() {
            const fab = document.getElementById('closeAllFab');
            const openCards = document.querySelectorAll('.question-card.active');
            if (openCards.length > 0) {
                fab.classList.add('visible');
            } else {
                fab.classList.remove('visible');
            }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'o' && (e.ctrlKey || e.metaKey)) {
                e.preventDefault();
                toggleAll(true);
            }
            if (e.key === 'c' && (e.ctrlKey || e.metaKey)) {
                e.preventDefault();
                toggleAll(false);
            }
        });

        // Initialize FAB state
        updateFabVisibility();
    </script>
</body>
</html>