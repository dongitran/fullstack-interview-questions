<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>C√¢u H·ªèi Ph·ªèng V·∫•n - Senior Fullstack Developer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --gray: #6b7280;
            --light: #f9fafb;
            --white: #ffffff;
            --border: #e5e7eb;
        }

        html {
            scroll-behavior: smooth;
            -webkit-text-size-adjust: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: var(--light);
            padding: 0;
            margin: 0;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.95;
        }

        .stats {
            display: flex;
            gap: 0.5rem;
            padding: 1rem;
            background: white;
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .stat-item {
            flex: 1;
            min-width: 80px;
            text-align: center;
            padding: 0.75rem 0.5rem;
            background: var(--light);
            border-radius: 8px;
        }

        .stat-number {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
            display: block;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        .controls {
            position: sticky;
            top: 100px;
            background: white;
            padding: 1rem;
            border-bottom: 2px solid var(--border);
            z-index: 99;
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            flex: 1;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:active {
            background: var(--primary-dark);
            transform: scale(0.98);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 1px solid var(--border);
        }

        .btn-secondary:active {
            background: var(--border);
        }

        .container {
            max-width: 100%;
            padding: 1rem;
        }

        .category {
            margin-bottom: 2rem;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: white;
            border-radius: 12px;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .category-icon {
            font-size: 1.5rem;
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
            flex: 1;
        }

        .category-count {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .question-card {
            background: white;
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
        }

        .question-header {
            padding: 1rem;
            cursor: pointer;
            -webkit-tap-highlight-color: rgba(99, 102, 241, 0.1);
            user-select: none;
        }

        .question-header:active {
            background: var(--light);
        }

        .question-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .question-number {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .difficulty {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .difficulty-easy {
            background: #d1fae5;
            color: #065f46;
        }

        .difficulty-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .difficulty-hard {
            background: #fee2e2;
            color: #991b1b;
        }

        .question-text {
            font-size: 1rem;
            font-weight: 600;
            color: var(--dark);
            line-height: 1.5;
        }

        .expand-icon {
            float: right;
            font-size: 1.25rem;
            color: var(--gray);
            transition: transform 0.3s;
        }

        .question-card.active .expand-icon {
            transform: rotate(180deg);
        }

        .answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .question-card.active .answer {
            max-height: 10000px;
        }

        .answer-content {
            padding: 1rem;
            border-top: 1px solid var(--border);
            background: var(--light);
            font-size: 0.95rem;
            line-height: 1.7;
        }

        .answer-content h4 {
            color: var(--primary);
            font-size: 1rem;
            margin: 1rem 0 0.5rem 0;
        }

        .answer-content h4:first-child {
            margin-top: 0;
        }

        .answer-content ul {
            margin: 0.5rem 0 1rem 1.5rem;
        }

        .answer-content li {
            margin-bottom: 0.5rem;
        }

        .answer-content p {
            margin: 0.75rem 0;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
        }

        .tag {
            display: inline-block;
            background: var(--light);
            color: var(--gray);
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.75rem;
            margin: 0.25rem 0.25rem 0.25rem 0;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.9rem;
            display: block;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table thead {
            background: var(--light);
        }

        table th,
        table td {
            padding: 0.75rem 0.5rem;
            text-align: left;
            border: 1px solid var(--border);
        }

        table th {
            font-weight: 600;
            color: var(--dark);
        }

        .highlight {
            background: #fef3c7;
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-weight: 600;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid var(--warning);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .info-box {
            background: #dbeafe;
            border-left: 4px solid var(--primary);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .footer {
            background: var(--dark);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 2rem;
        }

        .footer p {
            font-size: 0.9rem;
            margin: 0.5rem 0;
            opacity: 0.9;
        }

        @media (min-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .header p {
                font-size: 1.1rem;
            }

            .container {
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem;
            }

            .stats {
                gap: 1rem;
                padding: 1.5rem;
            }

            .stat-item {
                min-width: 100px;
                padding: 1rem;
            }

            .stat-number {
                font-size: 1.75rem;
            }

            .stat-label {
                font-size: 0.85rem;
            }

            .controls {
                top: 120px;
                padding: 1.5rem;
                gap: 1rem;
            }

            .btn {
                flex: none;
                padding: 0.875rem 2rem;
            }

            .category-header {
                padding: 1.5rem;
            }

            .category-title {
                font-size: 1.5rem;
            }

            .question-header {
                padding: 1.5rem;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .answer-content {
                padding: 1.5rem;
                font-size: 1rem;
            }

            .code-block {
                font-size: 0.9rem;
            }
        }

        @media print {
            .header {
                position: relative;
            }
            .controls {
                display: none;
            }
            .question-card {
                break-inside: avoid;
            }
            .answer {
                max-height: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìö C√¢u H·ªèi Ph·ªèng V·∫•n</h1>
        <p>Senior Fullstack Developer - Concepts & Trade-offs</p>
    </div>

    <div class="stats">
        <div class="stat-item">
            <span class="stat-number">30</span>
            <div class="stat-label">C√¢u h·ªèi</div>
        </div>
        <div class="stat-item">
            <span class="stat-number">8</span>
            <div class="stat-label">Ch·ªß ƒë·ªÅ</div>
        </div>
    </div>

    <div class="controls">
        <button class="btn btn-primary" onclick="toggleAll(true)">M·ªü t·∫•t c·∫£</button>
        <button class="btn btn-secondary" onclick="toggleAll(false)">ƒê√≥ng t·∫•t c·∫£</button>
    </div>

    <div class="container">
        <!-- Microservices & Architecture -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üèóÔ∏è</span>
                <h2 class="category-title">Microservices & Architecture</h2>
                <span class="category-count">5</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q1</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Sync vs Async communication - khi n√†o d√πng g√¨? Trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Synchronous (REST/gRPC):</h4>
                        <p><strong>Khi n√†o:</strong> Query operations, c·∫ßn response ngay, services trong c√πng datacenter, low latency critical</p>
                        <p><strong>∆Øu ƒëi·ªÉm:</strong> Simple, immediate consistency, d·ªÖ debug</p>
                        <p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong> Tight coupling, cascading failures, latency t√≠ch l≈©y</p>

                        <h4>Asynchronous (Kafka/Queue):</h4>
                        <p><strong>Khi n√†o:</strong> Long-running tasks, fire-and-forget, event workflows, c·∫ßn retry t·ª± ƒë·ªông</p>
                        <p><strong>∆Øu ƒëi·ªÉm:</strong> Loose coupling, resilient, high throughput</p>
                        <p><strong>Nh∆∞·ª£c ƒëi·ªÉm:</strong> Eventual consistency, debugging ph·ª©c t·∫°p, message ordering, c·∫ßn idempotency</p>

                        <h4>Decision Framework:</h4>
                        <ul>
                            <li><strong>Authentication/Authorization:</strong> Sync - c·∫ßn verify ngay</li>
                            <li><strong>Payment processing:</strong> Async - long-running, c·∫ßn retry</li>
                            <li><strong>Get user profile:</strong> Sync - simple read</li>
                            <li><strong>Send email:</strong> Async - fire-and-forget</li>
                            <li><strong>Real-time inventory:</strong> Sync - c·∫ßn data ch√≠nh x√°c ngay</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Sai l·∫ßm:</strong> D√πng async cho m·ªçi th·ª©. Sync ho√†n to√†n OK cho simple queries trong c√πng DC.
                        </div>

                        <span class="tag">Circuit Breaker</span>
                        <span class="tag">Event-Driven</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q2</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Service Discovery - client-side vs server-side? Implement th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>üéØ V·∫•n ƒë·ªÅ l√† g√¨?</h4>
                        <p>Khi c√≥ nhi·ªÅu service (user-service, payment-service...), m·ªói service ch·∫°y tr√™n nhi·ªÅu instance (3-5 pods). L√†m sao service A bi·∫øt g·ªçi ƒë·∫øn IP n√†o c·ªßa service B?</p>
                        <p>‚Üí C·∫ßn <strong>Service Discovery</strong> nh∆∞ "danh b·∫° ƒëi·ªán tho·∫°i" cho c√°c services.</p>

                        <h4>1Ô∏è‚É£ Client-Side Discovery</h4>
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li>Service t·ª± ƒëƒÉng k√Ω v√†o <strong>Consul/Eureka</strong> khi kh·ªüi ƒë·ªông</li>
                            <li>Client t·ª± query registry ƒë·ªÉ l·∫•y danh s√°ch IP</li>
                            <li>Client t·ª± ch·ªçn 1 IP ƒë·ªÉ g·ªçi (load balancing)</li>
                        </ul>
                        <div class="code-block">Client ‚Üí Query Consul ‚Üí Get IPs [10.0.1.5, 10.0.1.6] 
  ‚Üí Call 10.0.1.5</div>
                        <p><strong>∆Øu:</strong> Nhanh, kh√¥ng c√≥ trung gian</p>
                        <p><strong>Nh∆∞·ª£c:</strong> Code client ph·ª©c t·∫°p, ph·∫£i c√†i th∆∞ vi·ªán ri√™ng</p>

                        <h4>2Ô∏è‚É£ Server-Side Discovery</h4>
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li>Client ch·ªâ g·ªçi 1 <strong>domain duy nh·∫•t</strong>: <code>payment-service.internal</code></li>
                            <li>Infrastructure (Load Balancer ho·∫∑c K8s) t·ª± ƒë·ªông route ƒë·∫øn 1 healthy instance</li>
                        </ul>
                        <div class="code-block">Client ‚Üí payment-service.internal 
  ‚Üí Load Balancer ‚Üí Pick instance ‚Üí 10.0.1.5</div>
                        <p><strong>∆Øu:</strong> Client ƒë∆°n gi·∫£n (ch·ªâ g·ªçi URL), d·ªÖ qu·∫£n l√Ω</p>
                        <p><strong>Nh∆∞·ª£c:</strong> C√≥ 1 "hop" trung gian (nh∆∞ng latency r·∫•t nh·ªè)</p>

                        <h4>üìä So s√°nh nhanh</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Ti√™u ch√≠</th>
                                    <th>Client-Side</th>
                                    <th>Server-Side</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Client code</td>
                                    <td>Ph·ª©c t·∫°p</td>
                                    <td>ƒê∆°n gi·∫£n</td>
                                </tr>
                                <tr>
                                    <td>T·ªëc ƒë·ªô</td>
                                    <td>Nhanh h∆°n ch√∫t</td>
                                    <td>Nhanh (ƒë·ªß d√πng)</td>
                                </tr>
                                <tr>
                                    <td>Load balancing</td>
                                    <td>Client t·ª± l√†m</td>
                                    <td>H·ªá th·ªëng l√†m</td>
                                </tr>
                                <tr>
                                    <td>Ph√π h·ª£p</td>
                                    <td>VM/EC2 thu·∫ßn</td>
                                    <td>Kubernetes</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>‚úÖ Khi n√†o d√πng g√¨?</h4>
                        <ul>
                            <li><strong>Ch·∫°y Kubernetes:</strong> Server-side (K8s Service) ‚Äî 90% tr∆∞·ªùng h·ª£p</li>
                            <li><strong>Ch·∫°y VM/EC2 thu·∫ßn:</strong> Client-side (Consul) ho·∫∑c Load Balancer</li>
                            <li><strong>C·∫ßn custom load balancing:</strong> Client-side</li>
                            <li><strong>Mu·ªën ƒë∆°n gi·∫£n nh·∫•t:</strong> Server-side</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° T√≥m l·∫°i:</strong> Client-side = client t·ª± t√¨m v√† ch·ªçn server. Server-side = g·ªçi 1 domain, h·ªá th·ªëng t·ª± ch·ªçn server cho client. V·ªõi K8s hi·ªán ƒë·∫°i, d√πng server-side cho ƒë∆°n gi·∫£n.
                        </div>

                        <span class="tag">Service Mesh</span>
                        <span class="tag">Consul</span>
                        <span class="tag">Kubernetes</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q3</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Distributed Tracing - debug payment flow ch·∫≠m qua 5 services th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>T·∫°i sao c·∫ßn Distributed Tracing:</h4>
                        <ul>
                            <li>Request ƒëi qua nhi·ªÅu services ‚Üí logs ri√™ng l·∫ª kh√¥ng ƒë·ªß</li>
                            <li>C·∫ßn xem to√†n b·ªô flow: latency t·ª´ng service, bottleneck ·ªü ƒë√¢u</li>
                            <li>Correlate errors across services</li>
                        </ul>

                        <h4>OpenTelemetry Approach:</h4>
                        <p><strong>Trace Context:</strong> TraceID + SpanID ƒë∆∞·ª£c propagate qua headers (HTTP) ho·∫∑c message headers (Kafka)</p>
                        <p><strong>Spans:</strong> M·ªói operation t·∫°o span v·ªõi start time, end time, attributes</p>
                        <p><strong>Visualization:</strong> Jaeger/Zipkin hi·ªÉn th·ªã waterfall diagram</p>

                        <h4>Debug Example - Payment ch·∫≠m:</h4>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Service</th>
                                    <th>Th·ªù gian</th>
                                    <th>Ghi ch√∫</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>API Gateway</td>
                                    <td>5ms</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>‚îú‚îÄ Auth</td>
                                    <td>50ms</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>‚îú‚îÄ Payment</td>
                                    <td><strong>3500ms</strong></td>
                                    <td>üî¥ BOTTLENECK</td>
                                </tr>
                                <tr>
                                    <td>‚îÇ  ‚îú‚îÄ Validate</td>
                                    <td>5ms</td>
                                    <td>-</td>
                                </tr>
                                <tr>
                                    <td>‚îÇ  ‚îú‚îÄ Gateway Call</td>
                                    <td><strong>3000ms</strong></td>
                                    <td>üî¥ V·∫•n ƒë·ªÅ ch√≠nh</td>
                                </tr>
                                <tr>
                                    <td>‚îÇ  ‚îî‚îÄ Save DB</td>
                                    <td>450ms</td>
                                    <td>üü° C≈©ng ch·∫≠m</td>
                                </tr>
                                <tr>
                                    <td>‚îî‚îÄ Notification</td>
                                    <td>20ms</td>
                                    <td>-</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <p><strong>T·ªïng: 3575ms</strong></p>
                        
                        <p><strong>üî¥ Ph√°t hi·ªán:</strong> Gateway call chi·∫øm 3000ms (85% th·ªù gian) ‚Üí Connection pool exhausted</p>

                        <p><strong>Investigation:</strong></p>
                        <ul>
                            <li>Gateway call 3s ‚Üí Check: Connection pool exhausted ‚Üí Fix: TƒÉng pool + timeout</li>
                            <li>DB save 450ms ‚Üí Check: Missing index ‚Üí Fix: CREATE INDEX</li>
                            <li>Result: 3500ms ‚Üí 150ms (23x faster)</li>
                        </ul>

                        <h4>Key Metrics:</h4>
                        <ul>
                            <li><strong>Latency:</strong> P50, P95, P99 per service</li>
                            <li><strong>Error rate:</strong> % failed requests</li>
                            <li><strong>Throughput:</strong> Requests/second</li>
                            <li><strong>Dependencies:</strong> Service map</li>
                        </ul>

                        <span class="tag">OpenTelemetry</span>
                        <span class="tag">Jaeger</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q4</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Graceful Shutdown - tr√°nh data loss khi K8s terminate pod?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>The Problem:</h4>
                        <p>K8s sends SIGTERM ‚Üí 30s default grace period ‚Üí SIGKILL. N·∫øu ƒëang x·ª≠ l√Ω Kafka message 5 ph√∫t ho·∫∑c HTTP request 2 ph√∫t ‚Üí b·ªã kill ‚Üí DATA LOSS!</p>

                        <h4>Strategy:</h4>
                        <p><strong>1. Stop accepting new requests:</strong></p>
                        <ul>
                            <li>Health check return 503 ‚Üí K8s/LB stop routing traffic</li>
                            <li>Wait 5-10s ƒë·ªÉ LB update</li>
                        </ul>

                        <p><strong>2. Complete in-flight work:</strong></p>
                        <ul>
                            <li>Track s·ªë requests ƒëang x·ª≠ l√Ω</li>
                            <li>Kafka: pause consumer, wait for messages, commit offsets</li>
                            <li>HTTP: wait for responses</li>
                        </ul>

                        <p><strong>3. Close connections:</strong></p>
                        <ul>
                            <li>Database connections</li>
                            <li>Kafka producers/consumers</li>
                            <li>Redis connections</li>
                        </ul>

                        <p><strong>4. Kubernetes Config:</strong></p>
                        <div class="code-block">terminationGracePeriodSeconds: 60
preStop:
  exec:
    command: ["sh", "-c", "sleep 5"]
readinessProbe:
  httpGet:
    path: /health</div>

                        <h4>Testing:</h4>
                        <p>G·ª≠i long request ‚Üí SIGTERM while processing ‚Üí Request ph·∫£i complete, kh√¥ng 502</p>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Common Issue:</strong> Qu√™n pause Kafka consumer ‚Üí v·∫´n nh·∫≠n messages m·ªõi trong shutdown ‚Üí incomplete processing
                        </div>

                        <span class="tag">Zero Downtime</span>
                        <span class="tag">Kubernetes</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q5</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        API Gateway responsibilities - n√™n l√†m g√¨, kh√¥ng n√™n l√†m g√¨?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>N√™n l√†m:</h4>
                        <ul>
                            <li><strong>Routing:</strong> Map /api/users ‚Üí user-service, /api/payments ‚Üí payment-service</li>
                            <li><strong>Authentication:</strong> JWT validation, API key check</li>
                            <li><strong>Rate Limiting:</strong> Per user/IP throttling</li>
                            <li><strong>Request/Response transformation:</strong> Legacy API ‚Üí new format</li>
                            <li><strong>Aggregation:</strong> Combine multiple service calls into one response</li>
                            <li><strong>CORS, SSL termination</strong></li>
                        </ul>

                        <h4>Kh√¥ng n√™n l√†m:</h4>
                        <ul>
                            <li>‚ùå Business logic - thu·ªôc v·ªÅ services</li>
                            <li>‚ùå Database calls tr·ª±c ti·∫øp</li>
                            <li>‚ùå Heavy computation</li>
                            <li>‚ùå Session storage (stateless gateway t·ªët h∆°n)</li>
                        </ul>

                        <h4>Performance Patterns:</h4>
                        <p><strong>Caching:</strong> Cache GET responses (Redis) - 5-15 ph√∫t TTL</p>
                        <p><strong>Circuit Breaker:</strong> N·∫øu service down ‚Üí fallback/cached value</p>
                        <p><strong>Timeout:</strong> Set aggressive timeout (3-5s), don't wait forever</p>

                        <h4>Tools:</h4>
                        <ul>
                            <li><strong>Kong:</strong> Feature-rich, plugin ecosystem</li>
                            <li><strong>NGINX:</strong> Lightweight, high performance</li>
                            <li><strong>AWS ALB/API Gateway:</strong> Managed, scalable</li>
                        </ul>

                        <span class="tag">Rate Limiting</span>
                        <span class="tag">Circuit Breaker</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payment & Transactions -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üí≥</span>
                <h2 class="category-title">Payment & Distributed Transactions</h2>
                <span class="category-count">4</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q6</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Idempotency trong payment - t·∫°i sao c·∫ßn v√† implement concept th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>T·∫°i sao c·∫ßn:</h4>
                        <ul>
                            <li>Network timeout ‚Üí client retry ‚Üí duplicate charge!</li>
                            <li>User double-click "Pay" button</li>
                            <li>Webhook ƒë∆∞·ª£c g·ª≠i l·∫°i nhi·ªÅu l·∫ßn</li>
                        </ul>

                        <h4>Strategy:</h4>
                        <p><strong>1. Idempotency Key:</strong> Client/gateway generate unique key per operation</p>
                        <p><strong>2. Check cache first:</strong> Redis v·ªõi key = idempotencyKey, 24h TTL</p>
                        <p><strong>3. Distributed lock:</strong> Prevent concurrent processing c·ªßa c√πng key</p>
                        <p><strong>4. Database unique constraint:</strong> Last line of defense</p>
                        <p><strong>5. Cache result:</strong> Return same response n·∫øu retry</p>

                        <h4>Levels of Protection:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Level</th>
                                    <th>Protection</th>
                                    <th>Trade-off</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Application</td>
                                    <td>Cache check</td>
                                    <td>Fast, race condition possible</td>
                                </tr>
                                <tr>
                                    <td>Distributed Lock</td>
                                    <td>Redis lock</td>
                                    <td>Slower, prevents races</td>
                                </tr>
                                <tr>
                                    <td>Database</td>
                                    <td>UNIQUE constraint</td>
                                    <td>Absolute safety</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Pitfall:</strong> Idempotency key kh√¥ng ƒë∆∞·ª£c reuse cho different operations. Key = hash(userId + timestamp + operation) l√† kh√¥ng ƒë·ªß!
                        </div>

                        <span class="tag">Idempotency</span>
                        <span class="tag">Distributed Lock</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q7</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        2PC vs Saga Pattern - khi n√†o d√πng g√¨? Trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>üéØ V·∫•n ƒë·ªÅ: Distributed Transaction</h4>
                        <p>Khi 1 operation c·∫ßn thay ƒë·ªïi data ·ªü <strong>nhi·ªÅu database kh√°c nhau</strong> (v√≠ d·ª•: tr·ª´ ti·ªÅn ·ªü bank A + c·ªông ti·ªÅn ·ªü bank B). L√†m sao ƒë·∫£m b·∫£o c·∫£ 2 ƒë·ªÅu th√†nh c√¥ng ho·∫∑c c·∫£ 2 ƒë·ªÅu h·ªßy?</p>

                        <h4>1Ô∏è‚É£ Two-Phase Commit (2PC)</h4>
                        <p><strong>V√≠ d·ª•:</strong> Chuy·ªÉn ti·ªÅn gi·ªØa 2 t√†i kho·∫£n trong c√πng ng√¢n h√†ng</p>
                        
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li><strong>Phase 1 (Prepare):</strong> Coordinator h·ªèi t·∫•t c·∫£ "S·∫µn s√†ng ch∆∞a?"</li>
                            <li><strong>Phase 2 (Commit):</strong> N·∫øu t·∫•t c·∫£ OK ‚Üí commit; N·∫øu 1 b√™n fail ‚Üí rollback t·∫•t c·∫£</li>
                        </ul>

                        <table>
                            <thead>
                                <tr>
                                    <th>∆Øu ƒëi·ªÉm</th>
                                    <th>Nh∆∞·ª£c ƒëi·ªÉm</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>‚úÖ Data lu√¥n consistent</td>
                                    <td>‚ùå Ch·∫≠m (ph·∫£i ƒë·ª£i t·∫•t c·∫£)</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ T·ª± ƒë·ªông rollback</td>
                                    <td>‚ùå D·ªØ li·ªáu b·ªã lock trong qu√° tr√¨nh</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ D·ªÖ hi·ªÉu</td>
                                    <td>‚ùå Coordinator ch·∫øt = h·ªá th·ªëng ƒë·ª©ng</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>2Ô∏è‚É£ Saga Pattern</h4>
                        <p><strong>V√≠ d·ª•:</strong> ƒê·∫∑t h√†ng online (thanh to√°n ‚Üí tr·ª´ kho ‚Üí giao h√†ng)</p>
                        
                        <p><strong>C√°ch ho·∫°t ƒë·ªông:</strong></p>
                        <ul>
                            <li>Chia th√†nh <strong>chu·ªói c√°c b∆∞·ªõc nh·ªè</strong>, m·ªói b∆∞·ªõc l√† 1 transaction ri√™ng</li>
                            <li>N·∫øu b∆∞·ªõc 3 fail ‚Üí ch·∫°y <strong>compensating</strong> ƒë·ªÉ "undo" b∆∞·ªõc 1 v√† 2</li>
                        </ul>

                        <p><strong>Compensating transaction l√† g√¨?</strong></p>
                        <div class="info-box">
                            L√† h√†nh ƒë·ªông "ho√†n t√°c" business operation. V√≠ d·ª•:<br>
                            ‚Ä¢ Thanh to√°n th√†nh c√¥ng ‚Üí Compensate = Refund<br>
                            ‚Ä¢ Tr·ª´ kho th√†nh c√¥ng ‚Üí Compensate = C·ªông l·∫°i kho
                        </div>

                        <table>
                            <thead>
                                <tr>
                                    <th>∆Øu ƒëi·ªÉm</th>
                                    <th>Nh∆∞·ª£c ƒëi·ªÉm</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>‚úÖ Nhanh, kh√¥ng lock data</td>
                                    <td>‚ùå Ph·∫£i vi·∫øt code compensate</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ D·ªÖ scale</td>
                                    <td>‚ùå C√≥ th·ªÉ th·∫•y data "d·ªü dang"</td>
                                </tr>
                                <tr>
                                    <td>‚úÖ Kh√¥ng c·∫ßn coordinator</td>
                                    <td>‚ùå Complex ƒë·ªÉ debug</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>3Ô∏è‚É£ So s√°nh tr·ª±c quan</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Ti√™u ch√≠</th>
                                    <th>2PC</th>
                                    <th>Saga</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>T·ªëc ƒë·ªô</td>
                                    <td>Ch·∫≠m</td>
                                    <td>Nhanh</td>
                                </tr>
                                <tr>
                                    <td>Consistency</td>
                                    <td>Strong (ngay l·∫≠p t·ª©c)</td>
                                    <td>Eventual (cu·ªëi c√πng)</td>
                                </tr>
                                <tr>
                                    <td>Lock data</td>
                                    <td>C√≥</td>
                                    <td>Kh√¥ng</td>
                                </tr>
                                <tr>
                                    <td>Complexity</td>
                                    <td>Th·∫•p</td>
                                    <td>Cao</td>
                                </tr>
                                <tr>
                                    <td>Use case</td>
                                    <td>Financial (bank)</td>
                                    <td>E-commerce, booking</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>4Ô∏è‚É£ Khi n√†o d√πng g√¨?</h4>
                        <ul>
                            <li><strong>2PC:</strong> Banking core, n∆°i <strong>kh√¥ng th·ªÉ ch·∫•p nh·∫≠n</strong> data t·∫°m th·ªù kh√¥ng nh·∫•t qu√°n</li>
                            <li><strong>Saga:</strong> Order flow, booking, n∆°i <strong>ch·∫•p nh·∫≠n</strong> eventual consistency ƒë·ªÉ ƒë·ªïi l·∫•y performance</li>
                            <li><strong>Tr√°nh c·∫£ hai:</strong> Payment processing n√™n design ƒë·ªÉ 1 service x·ª≠ l√Ω (kh√¥ng distributed)</li>
                        </ul>

                        <div class="warning-box">
                            <strong>üí° Reality:</strong> 90% tr∆∞·ªùng h·ª£p kh√¥ng c·∫ßn distributed transaction. H√£y redesign service boundaries tr∆∞·ªõc khi d√πng 2PC ho·∫∑c Saga!
                        </div>

                        <span class="tag">2PC</span>
                        <span class="tag">Saga</span>
                        <span class="tag">Compensating Transactions</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q8</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        PCI DSS compliance - principles ƒë·ªÉ handle card data an to√†n?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Rule #1: DON'T Store Card Data!</h4>
                        <p><strong>Tokenization Flow:</strong></p>
                        <ul>
                            <li>Frontend collect card data ‚Üí send TR·ª∞C TI·∫æP ƒë·∫øn gateway (not your server!)</li>
                            <li>Gateway return token (tok_abc123)</li>
                            <li>Frontend g·ª≠i token ƒë·∫øn backend</li>
                            <li>Backend d√πng token ƒë·ªÉ charge ‚Üí NEVER see actual card data</li>
                        </ul>

                        <h4>What Can Store:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Data</th>
                                    <th>Can Store?</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Full card number</td>
                                    <td>‚ùå NO</td>
                                </tr>
                                <tr>
                                    <td>CVV/CVC</td>
                                    <td>‚ùå NEVER</td>
                                </tr>
                                <tr>
                                    <td>Last 4 digits</td>
                                    <td>‚úÖ Yes</td>
                                </tr>
                                <tr>
                                    <td>Expiry date</td>
                                    <td>‚úÖ Yes</td>
                                </tr>
                                <tr>
                                    <td>Gateway token</td>
                                    <td>‚úÖ Yes</td>
                                </tr>
                            </tbody>
                        </table>

                        <h4>Security Requirements:</h4>
                        <ul>
                            <li><strong>Network:</strong> TLS 1.2+, strong ciphers</li>
                            <li><strong>Access:</strong> Least privilege, MFA for admin</li>
                            <li><strong>Data:</strong> Encryption at rest, secure backups</li>
                            <li><strong>Logging:</strong> NEVER log card data - sanitize before log</li>
                            <li><strong>Audit:</strong> All payment operations logged</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Logging Danger:</strong> Check logs kh√¥ng ch·ª©a sensitive data. M·ªôt d√≤ng log c√≥ card number = PCI violation!
                        </div>

                        <span class="tag">PCI DSS</span>
                        <span class="tag">Tokenization</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q9</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Payment reconciliation - ƒë·ªëi chi·∫øu v·ªõi gateway nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>T·∫°i sao c·∫ßn:</h4>
                        <ul>
                            <li>Webhook c√≥ th·ªÉ miss ‚Üí payment successful nh∆∞ng DB kh√¥ng update</li>
                            <li>Network issue ‚Üí gateway charge nh∆∞ng ta kh√¥ng bi·∫øt</li>
                            <li>Data integrity - ƒë·∫£m b·∫£o money match</li>
                        </ul>

                        <h4>Daily Reconciliation Process:</h4>
                        <p><strong>1. Fetch data (2 AM daily):</strong></p>
                        <ul>
                            <li>Our payments (yesterday): t·ª´ DB</li>
                            <li>Gateway transactions: t·ª´ API</li>
                        </ul>

                        <p><strong>2. Compare:</strong></p>
                        <ul>
                            <li>Match by gateway reference ID</li>
                            <li>Check amount, status, timestamp</li>
                        </ul>

                        <p><strong>3. Discrepancy Types:</strong></p>
                        <table>
                            <thead>
                                <tr>
                                    <th>Issue</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Missing in gateway</td>
                                    <td>Query status API, webhook missed?</td>
                                </tr>
                                <tr>
                                    <td>Extra in gateway</td>
                                    <td>Create missing record, investigate</td>
                                </tr>
                                <tr>
                                    <td>Amount mismatch</td>
                                    <td>Manual review, alert finance team</td>
                                </tr>
                                <tr>
                                    <td>Status mismatch</td>
                                    <td>Update status, check reason</td>
                                </tr>
                            </tbody>
                        </table>

                        <p><strong>4. Generate report:</strong> Email to finance team with summary + discrepancies</p>

                        <h4>Real-time Validation:</h4>
                        <p>Khi query payment status ‚Üí so s√°nh v·ªõi gateway lu√¥n ‚Üí auto-fix simple mismatches</p>

                        <span class="tag">Reconciliation</span>
                        <span class="tag">Data Integrity</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Database & Performance -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üóÑÔ∏è</span>
                <h2 class="category-title">Database & Performance</h2>
                <span class="category-count">5</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q10</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        N+1 Query Problem - nh·∫≠n bi·∫øt v√† gi·∫£i quy·∫øt th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>The Problem:</h4>
                        <p>1 query ƒë·ªÉ l·∫•y users + N queries ƒë·ªÉ l·∫•y orders c·ªßa t·ª´ng user = 1 + N queries (N c√≥ th·ªÉ l√† 1000+)</p>

                        <h4>Solutions:</h4>
                        <p><strong>1. Eager Loading (JOIN):</strong></p>
                        <ul>
                            <li>Single query v·ªõi LEFT JOIN</li>
                            <li>TypeORM: relations: ['orders'] ho·∫∑c leftJoinAndSelect</li>
                            <li>Cons: C√≥ th·ªÉ fetch qu√° nhi·ªÅu data kh√¥ng c·∫ßn</li>
                        </ul>

                        <p><strong>2. Batch Loading:</strong></p>
                        <ul>
                            <li>Query users ‚Üí extract userIds ‚Üí IN (userIds) ƒë·ªÉ l·∫•y orders</li>
                            <li>2 queries thay v√¨ N+1</li>
                            <li>GraphQL: DataLoader pattern</li>
                        </ul>

                        <p><strong>3. Pagination + Limit:</strong></p>
                        <ul>
                            <li>Kh√¥ng load all users m·ªôt l√∫c</li>
                            <li>Take 20 users at a time</li>
                        </ul>

                        <h4>Detection:</h4>
                        <ul>
                            <li>Enable query logging (maxQueryExecutionTime)</li>
                            <li>Count queries per request (n·∫øu >10 l√† warning)</li>
                            <li>APM tools (New Relic, DataDog) highlight N+1</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° Rule of thumb:</strong> N·∫øu loop qua array v√† query trong loop = N+1 problem
                        </div>

                        <span class="tag">Query Optimization</span>
                        <span class="tag">TypeORM</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q11</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Database Indexing - khi n√†o c·∫ßn composite index? Strategy?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Khi n√†o c·∫ßn Composite Index:</h4>
                        <ul>
                            <li><strong>Multi-column WHERE:</strong> WHERE userId = ? AND createdAt > ?</li>
                            <li><strong>ORDER BY multiple columns:</strong> ORDER BY userId, createdAt DESC</li>
                            <li><strong>Covering Index:</strong> Index ch·ª©a t·∫•t c·∫£ columns trong SELECT</li>
                        </ul>

                        <h4>Column Order quan tr·ªçng:</h4>
                        <p>Index (userId, createdAt) ‚â† Index (createdAt, userId)</p>
                        <p><strong>Rule:</strong> Column c√≥ selectivity cao nh·∫•t first (√≠t duplicates)</p>

                        <h4>Index Strategy:</h4>
                        <ul>
                            <li><strong>Single column:</strong> Foreign keys, status, email (frequently queried)</li>
                            <li><strong>Composite:</strong> Frequent WHERE clauses v·ªõi 2+ columns</li>
                            <li><strong>Partial:</strong> WHERE status = 'pending' (ch·ªâ index subset)</li>
                        </ul>

                        <h4>Don't Over-Index:</h4>
                        <ul>
                            <li>M·ªói index l√†m ch·∫≠m INSERT/UPDATE/DELETE</li>
                            <li>Index t·ªën disk space</li>
                            <li>Monitor unused indexes: pg_stat_user_indexes</li>
                        </ul>

                        <h4>Example:</h4>
                        <div class="code-block">-- Good: High selectivity first
CREATE INDEX idx_user_date ON payments(user_id, created_at);

-- Supports:
WHERE user_id = 123 AND created_at > '2024-01-01'
WHERE user_id = 123  (partial match OK)

-- Does NOT support:
WHERE created_at > '2024-01-01'  (need separate index)</div>

                        <span class="tag">Database Indexing</span>
                        <span class="tag">PostgreSQL</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q12</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Sharding vs Replication - khi n√†o d√πng g√¨? Trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Replication (Primary-Replica):</h4>
                        <p><strong>How:</strong> Copy to√†n b·ªô data sang multiple servers</p>
                        <p><strong>Use case:</strong> Read-heavy workload, high availability</p>
                        <p><strong>Pros:</strong> Simple, automatic failover, scale reads</p>
                        <p><strong>Cons:</strong> Kh√¥ng scale writes, m·ªói server ph·∫£i ch·ª©a full dataset</p>

                        <h4>Sharding (Horizontal Partitioning):</h4>
                        <p><strong>How:</strong> Split data across multiple databases (shard by userId, region, etc)</p>
                        <p><strong>Use case:</strong> Data qu√° l·ªõn cho 1 server, write-heavy</p>
                        <p><strong>Pros:</strong> Scale both reads & writes, m·ªói shard nh·ªè h∆°n</p>
                        <p><strong>Cons:</strong> Complex queries (cross-shard JOIN), rebalancing kh√≥</p>

                        <h4>Sharding Strategy:</h4>
                        <p><strong>Hash-based:</strong> hash(userId) % shardCount ‚Üí even distribution</p>
                        <p><strong>Range-based:</strong> userId 1-1M ‚Üí shard1, 1M-2M ‚Üí shard2 ‚Üí easy rebalance nh∆∞ng uneven</p>
                        <p><strong>Geo-based:</strong> VN users ‚Üí Asia shard, US users ‚Üí US shard ‚Üí lower latency</p>

                        <h4>Real Decision:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Scale Need</th>
                                    <th>Solution</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Read scaling</td>
                                    <td>Replication (read replicas)</td>
                                </tr>
                                <tr>
                                    <td>Write scaling</td>
                                    <td>Sharding</td>
                                </tr>
                                <tr>
                                    <td>High availability</td>
                                    <td>Replication</td>
                                </tr>
                                <tr>
                                    <td>Data > 1 server capacity</td>
                                    <td>Sharding</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Avoid premature sharding:</strong> Start with replication. Only shard when single DB cannot handle (usually at millions of rows, high writes).
                        </div>

                        <span class="tag">Sharding</span>
                        <span class="tag">Replication</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q13</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Connection Pool sizing - l√†m sao t√≠nh ƒë√∫ng?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Formula:</h4>
                        <p><strong>connections = ((cores √ó 2) + effective_spindle_count)</strong></p>
                        <p>4-core CPU + 1 disk = (4 √ó 2) + 1 = 9 ‚Üí round to 10</p>

                        <h4>Why kh√¥ng ph·∫£i c√†ng nhi·ªÅu c√†ng t·ªët:</h4>
                        <ul>
                            <li>M·ªói connection = memory overhead (~10MB)</li>
                            <li>Context switching n·∫øu qu√° nhi·ªÅu</li>
                            <li>Database c√≥ max_connections limit</li>
                        </ul>

                        <h4>Multiple Instances:</h4>
                        <p>5 app instances √ó 10 connections = 50 total ‚Üí check DB max_connections (default PostgreSQL = 100)</p>

                        <h4>Settings:</h4>
                        <ul>
                            <li><strong>min:</strong> 5 (always ready)</li>
                            <li><strong>max:</strong> 10-20 per instance</li>
                            <li><strong>idleTimeout:</strong> 30s (close idle)</li>
                            <li><strong>connectionTimeout:</strong> 2s (fail fast)</li>
                        </ul>

                        <h4>Monitoring:</h4>
                        <div class="code-block">-- Check active connections
SELECT count(*) FROM pg_stat_activity;

-- Check connection pool exhaustion
-- If waiting > 100ms = need more connections</div>

                        <h4>Alternative: PgBouncer</h4>
                        <p>Connection pooler between app and DB ‚Üí hundreds of app connections ‚Üí reuse few DB connections</p>

                        <span class="tag">Connection Pool</span>
                        <span class="tag">PgBouncer</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q14</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        PostgreSQL vs MongoDB - khi n√†o d√πng g√¨?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>PostgreSQL (Relational):</h4>
                        <p><strong>Khi n√†o:</strong></p>
                        <ul>
                            <li>Structured data v·ªõi relationships (users ‚Üí orders ‚Üí payments)</li>
                            <li>ACID transactions critical (financial data)</li>
                            <li>Complex queries, JOINs, aggregations</li>
                            <li>Strong consistency required</li>
                        </ul>
                        <p><strong>Examples:</strong> Payments, user accounts, inventory, audit logs</p>

                        <h4>MongoDB (Document):</h4>
                        <p><strong>Khi n√†o:</strong></p>
                        <ul>
                            <li>Flexible schema (product catalog v·ªõi nhi·ªÅu variants)</li>
                            <li>High write throughput (logs, events, analytics)</li>
                            <li>Denormalized data OK (duplicate ƒë·ªÉ fast reads)</li>
                            <li>Horizontal scaling c·∫ßn thi·∫øt</li>
                        </ul>
                        <p><strong>Examples:</strong> Logs, sessions, product catalog, CMS content</p>

                        <h4>Hybrid Approach:</h4>
                        <p>D√πng c·∫£ hai! PostgreSQL cho transactional data, MongoDB cho analytics/logs</p>

                        <h4>Decision Criteria:</h4>
                        <ul>
                            <li><strong>Data structure:</strong> Fixed schema ‚Üí Postgres | Flexible ‚Üí Mongo</li>
                            <li><strong>Consistency:</strong> ACID ‚Üí Postgres | Eventual OK ‚Üí Mongo</li>
                            <li><strong>Queries:</strong> Complex JOINs ‚Üí Postgres | Simple lookups ‚Üí Mongo</li>
                            <li><strong>Scale:</strong> Vertical ‚Üí Postgres | Horizontal ‚Üí Mongo</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° T·∫°i UrBox:</strong> Payments/Users/Loyalty = PostgreSQL. Logs/Sessions/Product variants = MongoDB.
                        </div>

                        <span class="tag">PostgreSQL</span>
                        <span class="tag">MongoDB</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Kafka & Messaging -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üì®</span>
                <h2 class="category-title">Kafka & Message Queue</h2>
                <span class="category-count">4</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q15</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Kafka Consumer Group - rebalancing issues v√† c√°ch fix?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Consumer Group Concept:</h4>
                        <p>Multiple consumers c√πng group ‚Üí m·ªói partition ch·ªâ assigned cho 1 consumer ‚Üí parallel processing</p>

                        <h4>Rebalancing Hell Problem:</h4>
                        <p><strong>Symptom:</strong> Consumer li√™n t·ª•c rebalance ‚Üí kh√¥ng process ƒë∆∞·ª£c messages</p>
                        <p><strong>Cause:</strong> Processing time > session.timeout ‚Üí broker thinks consumer dead ‚Üí rebalance</p>
                        <p><strong>Fix:</strong></p>
                        <ul>
                            <li>TƒÉng session.timeout (default 10s ‚Üí 5 ph√∫t)</li>
                            <li>TƒÉng max.poll.interval (default 5 ph√∫t ‚Üí 10 ph√∫t)</li>
                            <li>Gi·∫£m processing time (batch nh·ªè h∆°n, optimize logic)</li>
                        </ul>

                        <h4>Duplicate Processing:</h4>
                        <p><strong>Cause:</strong> Consumer process message nh∆∞ng ch∆∞a commit offset ‚Üí crash ‚Üí reprocess</p>
                        <p><strong>Solution:</strong> Idempotent consumer (check messageId before process)</p>

                        <h4>Consumer Lag:</h4>
                        <p><strong>Monitor:</strong> Offset lag = latest offset - consumer offset</p>
                        <p><strong>Fix lag:</strong></p>
                        <ul>
                            <li>Add more consumers (max = s·ªë partitions)</li>
                            <li>Optimize processing time</li>
                            <li>Increase partition count (n·∫øu c·∫ßn scale h∆°n n·ªØa)</li>
                        </ul>

                        <h4>Best Practices:</h4>
                        <ul>
                            <li>Consumers ‚â§ partitions (th·ª´a consumer = idle)</li>
                            <li>Enable auto-commit = false ‚Üí manual commit sau khi process xong</li>
                            <li>Handle exceptions gracefully (DLQ cho poison messages)</li>
                        </ul>

                        <span class="tag">Consumer Groups</span>
                        <span class="tag">Rebalancing</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q16</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Partition Strategy - ƒë·∫£m b·∫£o message ordering?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Ordering Guarantee:</h4>
                        <p><strong>‚úÖ Per partition:</strong> Messages trong c√πng partition ordered</p>
                        <p><strong>‚ùå Cross partition:</strong> Kh√¥ng c√≥ ordering guarantee</p>

                        <h4>Partition Key Strategy:</h4>
                        <p><strong>Use case:</strong> C·∫ßn order per userId ‚Üí partition key = userId</p>
                        <p>Same userId ‚Üí same partition ‚Üí ordered messages</p>

                        <h4>Partition Count Decision:</h4>
                        <p><strong>Formula:</strong> max(expected_consumers, throughput_target / consumer_throughput)</p>
                        <p><strong>Example:</strong></p>
                        <ul>
                            <li>Target: 10,000 msg/sec</li>
                            <li>Consumer speed: 1,000 msg/sec</li>
                            <li>Partitions needed: 10</li>
                        </ul>

                        <h4>Trade-offs:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Partitions</th>
                                    <th>Pros</th>
                                    <th>Cons</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Too few (1-5)</td>
                                    <td>Simple, strong ordering</td>
                                    <td>Limited parallelism, bottleneck</td>
                                </tr>
                                <tr>
                                    <td>Right amount</td>
                                    <td>Good parallelism, manageable</td>
                                    <td>Need to calculate properly</td>
                                </tr>
                                <tr>
                                    <td>Too many (100+)</td>
                                    <td>Max parallelism</td>
                                    <td>Rebalancing slow, overhead</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="info-box">
                            <strong>üí° Tip:</strong> Start with 10-20 partitions. Monitor lag. Scale n·∫øu c·∫ßn.
                        </div>

                        <span class="tag">Partitioning</span>
                        <span class="tag">Message Ordering</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q17</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Exactly-Once Semantics - c√≥ th·∫≠t s·ª± ƒë·∫°t ƒë∆∞·ª£c kh√¥ng?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>3 Levels of Guarantees:</h4>
                        <p><strong>At-most-once:</strong> Message c√≥ th·ªÉ m·∫•t (kh√¥ng retry)</p>
                        <p><strong>At-least-once:</strong> Message kh√¥ng m·∫•t nh∆∞ng c√≥ th·ªÉ duplicate (default)</p>
                        <p><strong>Exactly-once:</strong> Message process ƒë√∫ng 1 l·∫ßn (hard!)</p>

                        <h4>Kafka Exactly-Once:</h4>
                        <p><strong>Producer side:</strong> enable.idempotence = true</p>
                        <p><strong>Consumer side:</strong> Idempotent processing + transactional offset commits</p>
                        <p><strong>Reality:</strong> Kafka c√≥ exactly-once nh∆∞ng trong Kafka ecosystem only (producer ‚Üí broker ‚Üí consumer)</p>

                        <h4>Real Exactly-Once = Idempotent Consumer:</h4>
                        <p>Kh√¥ng th·ªÉ ƒë·∫£m b·∫£o exactly-once end-to-end (Kafka ‚Üí DB ‚Üí external API)</p>
                        <p><strong>Solution:</strong> Make consumer idempotent:</p>
                        <ul>
                            <li>Check messageId tr∆∞·ªõc khi process</li>
                            <li>DB unique constraints</li>
                            <li>Distributed locks</li>
                        </ul>

                        <h4>Example:</h4>
                        <p><strong>Scenario:</strong> Payment message processed 2 l·∫ßn</p>
                        <p><strong>Protection:</strong></p>
                        <ul>
                            <li>messageId = unique key trong DB</li>
                            <li>Check Redis cache tr∆∞·ªõc</li>
                            <li>Idempotency key g·ª≠i gateway</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Truth:</strong> True exactly-once trong distributed system l√† impossible (network failures, partial failures). Focus on idempotent operations instead!
                        </div>

                        <span class="tag">Exactly-Once</span>
                        <span class="tag">Idempotency</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q18</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Dead Letter Queue pattern - khi n√†o c·∫ßn?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Khi n√†o c·∫ßn DLQ:</h4>
                        <ul>
                            <li>Message processing fail sau max retries</li>
                            <li>Poison messages (malformed data)</li>
                            <li>Business validation failures</li>
                            <li>Kh√¥ng mu·ªën block queue v√¨ bad messages</li>
                        </ul>

                        <h4>Pattern:</h4>
                        <p><strong>1. Process message</strong></p>
                        <p><strong>2. If fail:</strong> Retry v·ªõi backoff (3 l·∫ßn)</p>
                        <p><strong>3. Still fail:</strong> Send to DLQ topic</p>
                        <p><strong>4. Alert team</strong></p>
                        <p><strong>5. Manual review & retry</strong></p>

                        <h4>DLQ Message Format:</h4>
                        <div class="code-block">{
  originalMessage: {...},
  error: {
    message: "...",
    stack: "..."
  },
  metadata: {
    topic: "payment.process",
    partition: 5,
    offset: 12345,
    retryCount: 3
  },
  timestamp: "2024-01-15T10:30:00Z"
}</div>

                        <h4>DLQ Operations:</h4>
                        <ul>
                            <li><strong>Monitor:</strong> Alert n·∫øu DLQ > threshold</li>
                            <li><strong>Review:</strong> Admin dashboard ƒë·ªÉ xem DLQ messages</li>
                            <li><strong>Retry:</strong> Fix issue ‚Üí replay message t·ª´ DLQ</li>
                            <li><strong>Discard:</strong> N·∫øu message truly invalid</li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° Best Practice:</strong> C√≥ separate DLQ per topic (payment.dlq, notification.dlq) ƒë·ªÉ d·ªÖ manage
                        </div>

                        <span class="tag">DLQ</span>
                        <span class="tag">Error Handling</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- System Design -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üéØ</span>
                <h2 class="category-title">System Design</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q19</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Scale ƒë·∫øn 10,000 TPS - approach nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Requirements Breakdown:</h4>
                        <ul>
                            <li><strong>Throughput:</strong> 10,000 TPS = 600,000 requests/ph√∫t</li>
                            <li><strong>Latency:</strong> P99 < 500ms</li>
                            <li><strong>Availability:</strong> 99.99% (52 ph√∫t downtime/nƒÉm)</li>
                        </ul>

                        <h4>Horizontal Scaling:</h4>
                        <p><strong>Application Layer:</strong></p>
                        <ul>
                            <li>M·ªói pod handle ~300-500 RPS</li>
                            <li>10,000 / 350 = ~30 pods minimum</li>
                            <li>Add 20% buffer = 35-40 pods</li>
                            <li>Auto-scaling based on CPU (70%) & RPS metrics</li>
                        </ul>

                        <h4>Database Layer:</h4>
                        <ul>
                            <li><strong>Reads:</strong> Primary + 3-5 read replicas</li>
                            <li><strong>Writes:</strong> Shard n·∫øu single primary kh√¥ng handle (th∆∞·ªùng ·ªïn ƒë·∫øn 5K TPS)</li>
                            <li><strong>Connection pool:</strong> PgBouncer ƒë·ªÉ reuse connections</li>
                        </ul>

                        <h4>Caching Strategy:</h4>
                        <ul>
                            <li><strong>Redis Cluster:</strong> User sessions, frequent queries</li>
                            <li><strong>Cache hit ratio:</strong> Target 80%+ ‚Üí gi·∫£m DB load significantly</li>
                            <li><strong>TTL:</strong> 5-15 ph√∫t cho dynamic data</li>
                        </ul>

                        <h4>Async Processing:</h4>
                        <ul>
                            <li><strong>Kafka:</strong> Offload long tasks (20+ partitions)</li>
                            <li><strong>Workers:</strong> Separate t·ª´ API pods</li>
                            <li><strong>Priority queues:</strong> Critical vs normal tasks</li>
                        </ul>

                        <h4>Monitoring:</h4>
                        <ul>
                            <li>Metrics: Latency (P50/P95/P99), error rate, saturation</li>
                            <li>Alerts: P99 > 500ms, error rate > 1%, CPU > 80%</li>
                            <li>Distributed tracing: Identify bottlenecks</li>
                        </ul>

                        <span class="tag">Horizontal Scaling</span>
                        <span class="tag">High Availability</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q20</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        CAP Theorem - real examples v√† trade-offs?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>CAP Basics:</h4>
                        <ul>
                            <li><strong>C (Consistency):</strong> M·ªçi read th·∫•y latest write</li>
                            <li><strong>A (Availability):</strong> M·ªçi request nh·∫≠n response</li>
                            <li><strong>P (Partition Tolerance):</strong> Ho·∫°t ƒë·ªông khi network b·ªã chia c·∫Øt</li>
                        </ul>
                        <p><strong>Reality:</strong> Ch·ªâ ch·ªçn ƒë∆∞·ª£c 2/3. Trong distributed system, P l√† b·∫Øt bu·ªôc ‚Üí ch·ªçn CP ho·∫∑c AP</p>

                        <h4>CP Systems (Consistency + Partition Tolerance):</h4>
                        <p><strong>Behavior:</strong> Reject writes khi partition ƒë·ªÉ maintain consistency</p>
                        <p><strong>Examples:</strong> MongoDB (default), HBase, etcd, ZooKeeper</p>
                        <p><strong>Use when:</strong> Financial transactions, inventory management (kh√¥ng th·ªÉ oversell)</p>

                        <h4>AP Systems (Availability + Partition Tolerance):</h4>
                        <p><strong>Behavior:</strong> Accept writes tr√™n c·∫£ 2 sides c·ªßa partition ‚Üí resolve conflicts sau</p>
                        <p><strong>Examples:</strong> Cassandra, DynamoDB, Riak</p>
                        <p><strong>Use when:</strong> Social features, analytics, logs (eventual consistency OK)</p>

                        <h4>Real Scenarios:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Use Case</th>
                                    <th>Choice</th>
                                    <th>Why</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Payment processing</td>
                                    <td>CP</td>
                                    <td>Cannot charge twice!</td>
                                </tr>
                                <tr>
                                    <td>Loyalty points</td>
                                    <td>AP</td>
                                    <td>Temporary inconsistency OK</td>
                                </tr>
                                <tr>
                                    <td>Inventory</td>
                                    <td>CP</td>
                                    <td>Prevent overselling</td>
                                </tr>
                                <tr>
                                    <td>User preferences</td>
                                    <td>AP</td>
                                    <td>Availability > exact sync</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Reality:</strong> CAP l√† simplified model. Real systems c√≥ gradations (tunable consistency levels).
                        </div>

                        <span class="tag">CAP Theorem</span>
                        <span class="tag">Distributed Systems</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q21</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Caching strategies - when v√† how?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Cache Patterns:</h4>
                        
                        <p><strong>1. Cache-Aside (Lazy Loading):</strong></p>
                        <ul>
                            <li>Check cache ‚Üí hit: return | miss: query DB ‚Üí cache it ‚Üí return</li>
                            <li>Pros: Only cache what's needed</li>
                            <li>Cons: Cache miss penalty, stale data</li>
                        </ul>

                        <p><strong>2. Write-Through:</strong></p>
                        <ul>
                            <li>Write DB + cache simultaneously</li>
                            <li>Pros: Cache always fresh</li>
                            <li>Cons: Write latency higher, unnecessary caching</li>
                        </ul>

                        <p><strong>3. Write-Behind:</strong></p>
                        <ul>
                            <li>Write cache ‚Üí async flush to DB</li>
                            <li>Pros: Fast writes</li>
                            <li>Cons: Data loss risk if cache crashes</li>
                        </ul>

                        <h4>What to Cache:</h4>
                        <ul>
                            <li><strong>User sessions:</strong> Redis, TTL = session length</li>
                            <li><strong>API responses:</strong> Frequent queries, TTL = 5-15 min</li>
                            <li><strong>Database queries:</strong> Expensive joins, TTL = 5-60 min</li>
                            <li><strong>Static content:</strong> CDN, long TTL</li>
                        </ul>

                        <h4>Cache Invalidation:</h4>
                        <p><strong>Hardest problem in CS!</strong></p>
                        <ul>
                            <li><strong>TTL-based:</strong> Simple, c√≥ th·ªÉ serve stale data</li>
                            <li><strong>Event-based:</strong> Invalidate khi data change (complex)</li>
                            <li><strong>Version-based:</strong> Key includes version (cache:user:123:v5)</li>
                        </ul>

                        <h4>Anti-patterns:</h4>
                        <ul>
                            <li>‚ùå Cache everything ‚Üí memory waste</li>
                            <li>‚ùå No TTL ‚Üí stale forever</li>
                            <li>‚ùå Cache frequently changing data</li>
                            <li>‚ùå No cache size limit ‚Üí OOM</li>
                        </ul>

                        <span class="tag">Redis</span>
                        <span class="tag">Caching</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- DevOps -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üöÄ</span>
                <h2 class="category-title">DevOps & Deployment</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q22</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        GitHub Actions optimization - 3+ ph√∫t xu·ªëng <1 ph√∫t?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Optimization Strategies:</h4>
                        
                        <p><strong>1. Parallel Jobs:</strong></p>
                        <p>Lint, test, build ch·∫°y parallel thay v√¨ sequential ‚Üí save 50%+ time</p>

                        <p><strong>2. Dependency Caching:</strong></p>
                        <ul>
                            <li>Cache node_modules (key: package-lock.json hash)</li>
                            <li>Save 30-40s m·ªói run</li>
                            <li>Hit rate >90% n·∫øu dependencies √≠t thay ƒë·ªïi</li>
                        </ul>

                        <p><strong>3. Docker Layer Caching:</strong></p>
                        <ul>
                            <li>BuildKit cache (cache-from/cache-to type=gha)</li>
                            <li>Optimize Dockerfile layer order (dependencies tr∆∞·ªõc source)</li>
                            <li>Save 1-2 ph√∫t build time</li>
                        </ul>

                        <p><strong>4. Selective Testing:</strong></p>
                        <ul>
                            <li>Only run tests for changed files</li>
                            <li>Skip E2E n·∫øu ch·ªâ update README</li>
                        </ul>

                        <p><strong>5. Matrix Strategy:</strong></p>
                        <p>Build multiple services simultaneously trong monorepo</p>

                        <h4>Results:</h4>
                        <ul>
                            <li>npm install: 2 min ‚Üí 20s (caching)</li>
                            <li>Tests: 1 min ‚Üí 15s (parallel + selective)</li>
                            <li>Docker build: 1.5 min ‚Üí 30s (layer caching)</li>
                            <li><strong>Total: 3+ min ‚Üí ~50s</strong></li>
                        </ul>

                        <div class="info-box">
                            <strong>üí° Measure first:</strong> Enable timing logs ƒë·ªÉ bi·∫øt bottleneck ·ªü ƒë√¢u tr∆∞·ªõc khi optimize
                        </div>

                        <span class="tag">CI/CD</span>
                        <span class="tag">GitHub Actions</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q23</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        K8s deployment strategies - Blue-Green vs Rolling vs Canary?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Rolling Update (Default):</h4>
                        <p><strong>How:</strong> Gradually replace old pods with new (maxSurge=1, maxUnavailable=1)</p>
                        <p><strong>Pros:</strong> Zero downtime, simple, auto rollback</p>
                        <p><strong>Cons:</strong> C·∫£ 2 versions ch·∫°y ƒë·ªìng th·ªùi, rollback ch·∫≠m</p>
                        <p><strong>Use:</strong> Most deployments</p>

                        <h4>Blue-Green:</h4>
                        <p><strong>How:</strong> Deploy full new version (green) ‚Üí test ‚Üí switch traffic ‚Üí kill old (blue)</p>
                        <p><strong>Pros:</strong> Instant rollback (switch back), full testing tr∆∞·ªõc khi switch</p>
                        <p><strong>Cons:</strong> 2x resources, to√†n b·ªô traffic chuy·ªÉn m·ªôt l√∫c</p>
                        <p><strong>Use:</strong> Critical updates, database migrations</p>

                        <h4>Canary:</h4>
                        <p><strong>How:</strong> 10% traffic ‚Üí new version ‚Üí monitor ‚Üí 50% ‚Üí 100%</p>
                        <p><strong>Pros:</strong> Test v·ªõi real traffic nh·ªè, ph√°t hi·ªán issues s·ªõm, gradual rollout</p>
                        <p><strong>Cons:</strong> Complex setup (Istio/Flagger), longer deploy time</p>
                        <p><strong>Use:</strong> High-risk changes, user-facing features</p>

                        <h4>Comparison:</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Strategy</th>
                                    <th>Downtime</th>
                                    <th>Resources</th>
                                    <th>Rollback Speed</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Rolling</td>
                                    <td>Zero</td>
                                    <td>+1 pod</td>
                                    <td>Minutes</td>
                                </tr>
                                <tr>
                                    <td>Blue-Green</td>
                                    <td>Zero</td>
                                    <td>2x</td>
                                    <td>Instant</td>
                                </tr>
                                <tr>
                                    <td>Canary</td>
                                    <td>Zero</td>
                                    <td>~1.2x</td>
                                    <td>Fast</td>
                                </tr>
                            </tbody>
                        </table>

                        <span class="tag">Kubernetes</span>
                        <span class="tag">Deployment</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q24</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Zero-downtime deployment - ƒë·∫£m b·∫£o nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Key Requirements:</h4>
                        
                        <p><strong>1. Health Checks:</strong></p>
                        <ul>
                            <li>Readiness probe: K8s ch·ªâ route khi pod ready</li>
                            <li>Liveness probe: Kill pod n·∫øu unhealthy</li>
                            <li>Startup probe: Give time to start (DB connections, cache warming)</li>
                        </ul>

                        <p><strong>2. Graceful Shutdown:</strong></p>
                        <ul>
                            <li>Stop health check ‚Üí wait 5-10s ‚Üí stop accepting requests ‚Üí finish in-flight ‚Üí shutdown</li>
                            <li>terminationGracePeriodSeconds: 60s minimum</li>
                        </ul>

                        <p><strong>3. Rolling Update Settings:</strong></p>
                        <ul>
                            <li>maxSurge: 1 (c√≥ th·ªÉ tƒÉng n·∫øu resources cho ph√©p)</li>
                            <li>maxUnavailable: 0 (never below desired replicas)</li>
                        </ul>

                        <p><strong>4. Database Migrations:</strong></p>
                        <ul>
                            <li>Backward compatible migrations (add column v·ªõi default)</li>
                            <li>Run migration tr∆∞·ªõc deploy (separate job)</li>
                            <li>Two-phase deploy n·∫øu breaking change</li>
                        </ul>

                        <h4>Testing:</h4>
                        <ul>
                            <li>Load test during deploy ‚Üí no 502s, no dropped requests</li>
                            <li>Monitor error rate spike</li>
                            <li>Chaos engineering (kill random pods)</li>
                        </ul>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è Common Issue:</strong> Kh√¥ng wait cho load balancer update ‚Üí new pod nh·∫≠n traffic tr∆∞·ªõc khi ready
                        </div>

                        <span class="tag">Zero Downtime</span>
                        <span class="tag">Health Checks</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Debugging & Monitoring -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üîç</span>
                <h2 class="category-title">Debugging & Monitoring</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q25</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        API ch·∫≠m ƒë·ªôt ng·ªôt - debug approach nh∆∞ th·∫ø n√†o?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Systematic Approach:</h4>
                        
                        <p><strong>1. Define "ch·∫≠m":</strong></p>
                        <ul>
                            <li>Normal: P99 = 200ms ‚Üí Now: P99 = 3000ms</li>
                            <li>When started: T·ª´ 10 AM h√¥m nay</li>
                            <li>Affected endpoints: All ho·∫∑c specific?</li>
                        </ul>

                        <p><strong>2. Check Recent Changes:</strong></p>
                        <ul>
                            <li>Deploy m·ªõi? (git log, CI/CD history)</li>
                            <li>Config change? (feature flags, environment variables)</li>
                            <li>Traffic spike? (monitoring dashboard)</li>
                        </ul>

                        <p><strong>3. Layer-by-Layer:</strong></p>
                        <p><strong>Application:</strong></p>
                        <ul>
                            <li>Check logs: Exceptions? Warnings?</li>
                            <li>APM traces: Which function slow?</li>
                            <li>CPU/Memory: Maxed out?</li>
                        </ul>

                        <p><strong>Database:</strong></p>
                        <ul>
                            <li>Slow query log: Missing indexes?</li>
                            <li>Connection pool: Exhausted?</li>
                            <li>Lock contention: pg_stat_activity</li>
                        </ul>

                        <p><strong>External Services:</strong></p>
                        <ul>
                            <li>Gateway timeout? Check circuit breaker</li>
                            <li>Rate limited? Check API quotas</li>
                        </ul>

                        <p><strong>Infrastructure:</strong></p>
                        <ul>
                            <li>Network latency spike?</li>
                            <li>Disk I/O bottleneck?</li>
                        </ul>

                        <h4>Common Culprits:</h4>
                        <ul>
                            <li>Missing database index (query plan changed)</li>
                            <li>Connection pool exhausted</li>
                            <li>Memory leak ‚Üí GC thrashing</li>
                            <li>External service degradation</li>
                            <li>N+1 query introduced</li>
                        </ul>

                        <span class="tag">Debugging</span>
                        <span class="tag">Performance</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q26</span>
                        <span class="difficulty difficulty-hard">Hard</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Distributed system debugging - trace request qua nhi·ªÅu services?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Challenges:</h4>
                        <ul>
                            <li>Request touch 5-10 services</li>
                            <li>Logs scattered across services</li>
                            <li>No single source of truth</li>
                            <li>Async processing (Kafka)</li>
                        </ul>

                        <h4>Solution Stack:</h4>
                        <p><strong>1. Correlation ID:</strong></p>
                        <ul>
                            <li>Generate UUID at API Gateway</li>
                            <li>Pass via X-Correlation-ID header (HTTP) ho·∫∑c message header (Kafka)</li>
                            <li>Log m·ªçi operation v·ªõi correlationId</li>
                            <li>Search logs: grep correlationId ‚Üí see full flow</li>
                        </ul>

                        <p><strong>2. Distributed Tracing:</strong></p>
                        <ul>
                            <li>OpenTelemetry auto-instrumentation</li>
                            <li>Visualize v·ªõi Jaeger/Zipkin</li>
                            <li>See latency per service, dependencies</li>
                        </ul>

                        <p><strong>3. Centralized Logging:</strong></p>
                        <ul>
                            <li>ELK stack (Elasticsearch, Logstash, Kibana)</li>
                            <li>Query all services at once</li>
                            <li>Filter by correlationId, userId, error level</li>
                        </ul>

                        <h4>Debug Flow Example:</h4>
                        <p><strong>Issue:</strong> Payment failed, user says "charged but no confirmation"</p>
                        <ul>
                            <li>Get correlationId t·ª´ user request</li>
                            <li>Search Jaeger: API ‚Üí Payment ‚Üí Gateway ‚Üí DB</li>
                            <li>See: Gateway returned 200, DB save failed</li>
                            <li>Check logs: Unique constraint violation</li>
                            <li>Root cause: Duplicate request, idempotency check missed</li>
                        </ul>

                        <span class="tag">Distributed Tracing</span>
                        <span class="tag">Correlation ID</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q27</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Production monitoring - metrics quan tr·ªçng c·∫ßn track?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Golden Signals (Google SRE):</h4>
                        
                        <p><strong>1. Latency:</strong></p>
                        <ul>
                            <li>P50, P95, P99 response time</li>
                            <li>Alert: P99 > 500ms</li>
                        </ul>

                        <p><strong>2. Traffic:</strong></p>
                        <ul>
                            <li>Requests per second</li>
                            <li>Alert: 50% drop ho·∫∑c sudden spike</li>
                        </ul>

                        <p><strong>3. Errors:</strong></p>
                        <ul>
                            <li>Error rate (%)</li>
                            <li>Alert: > 1% error rate</li>
                        </ul>

                        <p><strong>4. Saturation:</strong></p>
                        <ul>
                            <li>CPU, memory, disk, connection pool</li>
                            <li>Alert: > 80% usage</li>
                        </ul>

                        <h4>Application Metrics:</h4>
                        <ul>
                            <li><strong>Business metrics:</strong> Payments/hour, conversion rate</li>
                            <li><strong>Database:</strong> Query time, connection pool usage, deadlocks</li>
                            <li><strong>Cache:</strong> Hit ratio, eviction rate</li>
                            <li><strong>Queue:</strong> Message lag, processing time, DLQ size</li>
                        </ul>

                        <h4>Alerting Strategy:</h4>
                        <ul>
                            <li><strong>P0 (wake up):</strong> Complete outage, payment processing down</li>
                            <li><strong>P1 (urgent):</strong> Degraded performance, error rate spike</li>
                            <li><strong>P2 (business hours):</strong> High lag, cache misses</li>
                        </ul>

                        <h4>Dashboard Essentials:</h4>
                        <ul>
                            <li>Real-time: RPS, latency, errors</li>
                            <li>Resources: CPU, memory per service</li>
                            <li>Dependencies: External API status</li>
                            <li>Business: Revenue/hour, active users</li>
                        </ul>

                        <span class="tag">Monitoring</span>
                        <span class="tag">Metrics</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Behavioral -->
        <div class="category">
            <div class="category-header">
                <span class="category-icon">üí¨</span>
                <h2 class="category-title">Behavioral Questions</h2>
                <span class="category-count">3</span>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q28</span>
                        <span class="difficulty difficulty-easy">Easy</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Challenging technical problem - STAR method
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Situation:</h4>
                        <p>Kafka consumer group conflicts causing duplicate payment processing. Kh√°ch h√†ng b·ªã charge 2 l·∫ßn.</p>

                        <h4>Task:</h4>
                        <p>Fix duplicate processing, ensure message delivery guarantees, maintain performance d∆∞·ªõi high load.</p>

                        <h4>Action:</h4>
                        <ul>
                            <li>Analyzed logs ‚Üí discovered rebalancing causing partition re-assignment</li>
                            <li>Implemented idempotency keys v·ªõi Redis distributed locks</li>
                            <li>Added DB unique constraint tr√™n (idempotency_key)</li>
                            <li>Fixed Kafka settings (session.timeout, heartbeat.interval)</li>
                            <li>Graceful shutdown hooks ƒë·ªÉ commit offsets properly</li>
                            <li>Monitoring & alerts cho duplicate attempts</li>
                        </ul>

                        <h4>Result:</h4>
                        <ul>
                            <li>Zero duplicate payments (3+ months)</li>
                            <li>Reliability: 99.5% ‚Üí 99.95%</li>
                            <li>Customer complaints gi·∫£m 80%</li>
                            <li>Documentation cho team v·ªÅ best practices</li>
                        </ul>

                        <span class="tag">STAR Method</span>
                        <span class="tag">Problem Solving</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q29</span>
                        <span class="difficulty difficulty-medium">Medium</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        Speed vs Quality trade-off - example?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Situation:</h4>
                        <p>Banking integration c√≥ tight deadline - 2 tu·∫ßn cho marketing campaign. Testing ƒë·∫ßy ƒë·ªß c·∫ßn 3+ tu·∫ßn.</p>

                        <h4>Decision:</h4>
                        <p><strong>Phase 1 (Week 1-2):</strong></p>
                        <ul>
                            <li>Core payment flow v·ªõi thorough testing</li>
                            <li>Basic monitoring & error handling</li>
                            <li>Feature flags cho quick disable</li>
                            <li>Beta launch v·ªõi 100 users</li>
                        </ul>

                        <p><strong>Deferred to v2:</strong></p>
                        <ul>
                            <li>Advanced loyalty features</li>
                            <li>Performance optimizations</li>
                            <li>Edge case handling</li>
                        </ul>

                        <h4>Risk Mitigation:</h4>
                        <ul>
                            <li>Comprehensive monitoring t·ª´ day 1</li>
                            <li>Manual approval cho transactions > 10M</li>
                            <li>24/7 on-call rotation</li>
                            <li>Rollback plan ready (feature flag)</li>
                        </ul>

                        <h4>Outcome:</h4>
                        <ul>
                            <li>Met deadline, campaign launched th√†nh c√¥ng</li>
                            <li>Zero critical issues trong beta</li>
                            <li>Gradual rollout ƒë·∫øn 100% users (2 weeks)</li>
                            <li>v2 delivered sau 1 th√°ng</li>
                        </ul>

                        <h4>Lesson:</h4>
                        <p>Speed vs Quality kh√¥ng ph·∫£i all-or-nothing. V·ªõi proper risk management, feature flags, monitoring ‚Üí ship faster while maintaining acceptable quality. Key l√† bi·∫øt corners n√†o cut ƒë∆∞·ª£c (nice-to-have) vs kh√¥ng ƒë∆∞·ª£c (security, data integrity).</p>

                        <span class="tag">Trade-offs</span>
                        <span class="tag">Risk Management</span>
                    </div>
                </div>
            </div>

            <div class="question-card" onclick="toggleCard(this)">
                <div class="question-header">
                    <div class="question-meta">
                        <span class="question-number">Q30</span>
                        <span class="difficulty difficulty-easy">Easy</span>
                        <span class="expand-icon">‚ñº</span>
                    </div>
                    <div class="question-text">
                        How do you stay updated v·ªõi tech trends?
                    </div>
                </div>
                <div class="answer">
                    <div class="answer-content">
                        <h4>Daily Learning:</h4>
                        <ul>
                            <li><strong>Reading:</strong> Dev.to, Medium, Hacker News</li>
                            <li><strong>Documentation:</strong> NestJS, PostgreSQL, Kafka official docs</li>
                            <li><strong>Tech Twitter:</strong> Follow industry leaders</li>
                        </ul>

                        <h4>Hands-on Experimentation:</h4>
                        <ul>
                            <li>Tested AI tools (GitHub Copilot, Claude, Cursor)</li>
                            <li>Researched Playwright Test Agents cho automated testing</li>
                            <li>Explored MCP servers cho AI integration</li>
                            <li>Evaluated PostgreSQL 17 upgrade benefits</li>
                        </ul>

                        <h4>Knowledge Sharing:</h4>
                        <ul>
                            <li>Internal wiki documentation</li>
                            <li>Tech talks v·ªõi team</li>
                            <li>Mentor junior developers</li>
                            <li>Detailed Jira tasks v·ªõi context</li>
                        </ul>

                        <h4>Recent Focus:</h4>
                        <ul>
                            <li>AI-powered development tools</li>
                            <li>Platform engineering trends</li>
                            <li>DevSecOps practices</li>
                            <li>Database optimization techniques</li>
                        </ul>

                        <span class="tag">Continuous Learning</span>
                        <span class="tag">Knowledge Sharing</span>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="footer">
        <p>üíº Ch√∫c b·∫°n ph·ªèng v·∫•n th√†nh c√¥ng!</p>
        <p>üìß dongtranthienio@gmail.com | üì± +84 767 692 595</p>
        <p style="margin-top: 1rem; opacity: 0.8; font-size: 0.85rem;">
            Focus on concepts, trade-offs, and real-world decision making!
        </p>
    </div>

    <script>
        function toggleCard(card) {
            card.classList.toggle('active');
        }

        function toggleAll(show) {
            const cards = document.querySelectorAll('.question-card');
            cards.forEach(card => {
                if (show) {
                    card.classList.add('active');
                } else {
                    card.classList.remove('active');
                }
            });
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'o' && (e.ctrlKey || e.metaKey)) {
                e.preventDefault();
                toggleAll(true);
            }
            if (e.key === 'c' && (e.ctrlKey || e.metaKey)) {
                e.preventDefault();
                toggleAll(false);
            }
        });
    </script>
</body>
</html>